<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Cesium 开发文档 | aoaYaoa</title><meta name="author" content="aoaYaoa"><meta name="copyright" content="aoaYaoa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Cesium 完整离线开发指南📋 目录 离线环境配置 Viewer 详细配置 坐标系统详解 实体系统完整属性 影像系统详解 地形系统详解 相机系统完整属性 事件系统详解 材质系统详解 动画系统详解 几何体系统详解 场景控制详解 数据源详解 时间系统详解 绘制功能详解 性能优化详解  离线环境配置完整离线包下载123456789101112131415161718# 1. 下载Cesium完整包w">
<meta property="og:type" content="article">
<meta property="og:title" content="Cesium 开发文档">
<meta property="og:url" content="https://aoayaoa.github.io/2025/07/31/cesium/index.html">
<meta property="og:site_name" content="aoaYaoa">
<meta property="og:description" content="Cesium 完整离线开发指南📋 目录 离线环境配置 Viewer 详细配置 坐标系统详解 实体系统完整属性 影像系统详解 地形系统详解 相机系统完整属性 事件系统详解 材质系统详解 动画系统详解 几何体系统详解 场景控制详解 数据源详解 时间系统详解 绘制功能详解 性能优化详解  离线环境配置完整离线包下载123456789101112131415161718# 1. 下载Cesium完整包w">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://aoayaoa.github.io/img/cesium.jpg">
<meta property="article:published_time" content="2025-07-30T16:00:00.000Z">
<meta property="article:modified_time" content="2025-08-08T02:51:24.572Z">
<meta property="article:author" content="aoaYaoa">
<meta property="article:tag" content="Cesium">
<meta property="article:tag" content="三维GIS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://aoayaoa.github.io/img/cesium.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Cesium 开发文档",
  "url": "https://aoayaoa.github.io/2025/07/31/cesium/",
  "image": "https://aoayaoa.github.io/img/cesium.jpg",
  "datePublished": "2025-07-30T16:00:00.000Z",
  "dateModified": "2025-08-08T02:51:24.572Z",
  "author": [
    {
      "@type": "Person",
      "name": "aoaYaoa",
      "url": "https://aoayaoa.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://aoayaoa.github.io/2025/07/31/cesium/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: aoaYaoa","link":"链接: ","source":"来源: aoaYaoa","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Cesium 开发文档',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/base.css"><script src="/js/resources.js"></script><link rel="alternate" href="/atom.xml" title="aoaYaoa" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-book-open"></i><span> 文章</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-calendar-alt"></i><span> 日常</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comment-dots"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fas fa-compass"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/cesium.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/avatar.jpg" alt="Logo"><span class="site-name">aoaYaoa</span></a><a class="nav-page-title" href="/"><span class="site-name">Cesium 开发文档</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-book-open"></i><span> 文章</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-calendar-alt"></i><span> 日常</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comment-dots"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fas fa-compass"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Cesium 开发文档</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-30T16:00:00.000Z" title="发表于 2025-07-31 00:00:00">2025-07-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-08T02:51:24.572Z" title="更新于 2025-08-08 10:51:24">2025-08-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">29.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>140分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Cesium-完整离线开发指南"><a href="#Cesium-完整离线开发指南" class="headerlink" title="Cesium 完整离线开发指南"></a>Cesium 完整离线开发指南</h1><h2 id="📋-目录"><a href="#📋-目录" class="headerlink" title="📋 目录"></a>📋 目录</h2><ul>
<li><a href="#%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">离线环境配置</a></li>
<li><a href="#viewer-%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE">Viewer 详细配置</a></li>
<li><a href="#%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">坐标系统详解</a></li>
<li><a href="#%E5%AE%9E%E4%BD%93%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E5%B1%9E%E6%80%A7">实体系统完整属性</a></li>
<li><a href="#%E5%BD%B1%E5%83%8F%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">影像系统详解</a></li>
<li><a href="#%E5%9C%B0%E5%BD%A2%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">地形系统详解</a></li>
<li><a href="#%E7%9B%B8%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E5%B1%9E%E6%80%A7">相机系统完整属性</a></li>
<li><a href="#%E4%BA%8B%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">事件系统详解</a></li>
<li><a href="#%E6%9D%90%E8%B4%A8%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">材质系统详解</a></li>
<li><a href="#%E5%8A%A8%E7%94%BB%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">动画系统详解</a></li>
<li><a href="#%E5%87%A0%E4%BD%95%E4%BD%93%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">几何体系统详解</a></li>
<li><a href="#%E5%9C%BA%E6%99%AF%E6%8E%A7%E5%88%B6%E8%AF%A6%E8%A7%A3">场景控制详解</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E8%AF%A6%E8%A7%A3">数据源详解</a></li>
<li><a href="#%E6%97%B6%E9%97%B4%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3">时间系统详解</a></li>
<li><a href="#%E7%BB%98%E5%88%B6%E5%8A%9F%E8%83%BD%E8%AF%A6%E8%A7%A3">绘制功能详解</a></li>
<li><a href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%AF%A6%E8%A7%A3">性能优化详解</a></li>
</ul>
<h2 id="离线环境配置"><a href="#离线环境配置" class="headerlink" title="离线环境配置"></a>离线环境配置</h2><h3 id="完整离线包下载"><a href="#完整离线包下载" class="headerlink" title="完整离线包下载"></a>完整离线包下载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 下载Cesium完整包</span></span><br><span class="line">wget https://github.com/CesiumGS/cesium/releases/download/1.110/Cesium-1.110.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 解压到静态资源目录</span></span><br><span class="line">unzip Cesium-1.110.zip -d public/cesium/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 项目结构</span></span><br><span class="line">public/</span><br><span class="line">├── cesium/</span><br><span class="line">│   ├── Build/</span><br><span class="line">│   │   └── Cesium/</span><br><span class="line">│   │       ├── Cesium.js          <span class="comment"># 主库文件</span></span><br><span class="line">│   │       ├── Widgets/</span><br><span class="line">│   │       │   └── widgets.css    <span class="comment"># 样式文件</span></span><br><span class="line">│   │       ├── Workers/           <span class="comment"># WebWorker文件</span></span><br><span class="line">│   │       ├── ThirdParty/        <span class="comment"># 第三方库</span></span><br><span class="line">│   │       └── Assets/            <span class="comment"># 静态资源</span></span><br><span class="line">│   └── Apps/                      <span class="comment"># 示例应用</span></span><br></pre></td></tr></table></figure>

<h3 id="Vite离线配置"><a href="#Vite离线配置" class="headerlink" title="Vite离线配置"></a>Vite离线配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vite.config.js - 离线开发配置</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">define</span>: &#123;</span><br><span class="line">    <span class="comment">// 定义全局常量，避免Ion依赖</span></span><br><span class="line">    <span class="attr">CESIUM_BASE_URL</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="string">&#x27;/cesium/&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态资源处理</span></span><br><span class="line">  <span class="attr">publicDir</span>: <span class="string">&#x27;public&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 构建配置</span></span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="comment">// 排除不需要的依赖</span></span><br><span class="line">      <span class="attr">external</span>: [<span class="string">&#x27;@cesium/engine&#x27;</span>],</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 复制Cesium静态资源</span></span><br><span class="line">      <span class="attr">input</span>: &#123;</span><br><span class="line">        <span class="attr">main</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;index.html&#x27;</span>),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 开发服务器配置</span></span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="comment">// 静态文件服务</span></span><br><span class="line">    <span class="attr">fs</span>: &#123;</span><br><span class="line">      <span class="attr">allow</span>: [<span class="string">&#x27;..&#x27;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 优化配置</span></span><br><span class="line">  <span class="attr">optimizeDeps</span>: &#123;</span><br><span class="line">    <span class="comment">// 预构建Cesium</span></span><br><span class="line">    <span class="attr">include</span>: [<span class="string">&#x27;cesium&#x27;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="离线初始化"><a href="#离线初始化" class="headerlink" title="离线初始化"></a>离线初始化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js - 离线初始化配置</span></span><br><span class="line"><span class="comment">// 设置Cesium基础路径</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">CESIUM_BASE_URL</span> = <span class="string">&#x27;/cesium/Build/Cesium/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁用Ion服务（离线环境）</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">Cesium</span> <span class="keyword">from</span> <span class="string">&#x27;cesium&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 覆盖Ion默认设置</span></span><br><span class="line"><span class="title class_">Cesium</span>.<span class="property">Ion</span>.<span class="property">defaultAccessToken</span> = <span class="literal">undefined</span></span><br><span class="line"><span class="title class_">Cesium</span>.<span class="property">Ion</span>.<span class="property">defaultServer</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 离线Viewer配置</span></span><br><span class="line"><span class="keyword">const</span> viewer = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Viewer</span>(<span class="string">&#x27;cesiumContainer&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">// 关闭所有在线服务</span></span><br><span class="line">  <span class="attr">baseLayerPicker</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">geocoder</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 使用离线影像</span></span><br><span class="line">  <span class="attr">imageryProvider</span>: <span class="literal">false</span>, <span class="comment">// 不加载默认影像</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 使用本地地形</span></span><br><span class="line">  <span class="attr">terrainProvider</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">EllipsoidTerrainProvider</span>(),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Viewer-详细配置"><a href="#Viewer-详细配置" class="headerlink" title="Viewer 详细配置"></a>Viewer 详细配置</h2><h3 id="构造函数完整参数"><a href="#构造函数完整参数" class="headerlink" title="构造函数完整参数"></a>构造函数完整参数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> viewer = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Viewer</span>(container, &#123;</span><br><span class="line">  <span class="comment">// === 基础渲染选项 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// animation: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制时间动画控件的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 离线建议: false（减少UI复杂度）</span></span><br><span class="line">  <span class="attr">animation</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// baseLayerPicker: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制图层选择器的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 离线建议: false（避免在线图层依赖）</span></span><br><span class="line">  <span class="attr">baseLayerPicker</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fullscreenButton: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制全屏按钮的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 允许用户全屏查看地图</span></span><br><span class="line">  <span class="attr">fullscreenButton</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// geocoder: boolean | GeocoderService[]</span></span><br><span class="line">  <span class="comment">// 作用: 控制地址搜索框的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 离线建议: false（需要在线服务）</span></span><br><span class="line">  <span class="attr">geocoder</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// homeButton: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制主页按钮的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 重置到初始视角</span></span><br><span class="line">  <span class="attr">homeButton</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// infoBox: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制信息框的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 显示实体详细信息</span></span><br><span class="line">  <span class="attr">infoBox</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// sceneModePicker: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制场景模式选择器（3D/2D/Columbus）</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 切换不同的查看模式</span></span><br><span class="line">  <span class="attr">sceneModePicker</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// selectionIndicator: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制选择指示器（绿色框）</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 显示选中实体的边界框</span></span><br><span class="line">  <span class="attr">selectionIndicator</span>: <span class="literal">false</span>, <span class="comment">// 通常关闭以获得更好的视觉效果</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// timeline: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制时间轴的显示</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 控制时间相关的动画</span></span><br><span class="line">  <span class="attr">timeline</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// navigationHelpButton: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制导航帮助按钮</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 显示鼠标/触摸操作说明</span></span><br><span class="line">  <span class="attr">navigationHelpButton</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// navigationInstructionsInitiallyVisible: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 控制导航说明的初始可见性</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 页面加载时是否显示操作说明</span></span><br><span class="line">  <span class="attr">navigationInstructionsInitiallyVisible</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 场景渲染选项 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// scene3DOnly: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否只支持3D模式</span></span><br><span class="line">  <span class="comment">// 默认: false</span></span><br><span class="line">  <span class="comment">// 用途: 禁用2D和Columbus模式以提升性能</span></span><br><span class="line">  <span class="attr">scene3DOnly</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// shouldAnimate: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否启用动画</span></span><br><span class="line">  <span class="comment">// 默认: false</span></span><br><span class="line">  <span class="comment">// 用途: 控制时间动画的播放</span></span><br><span class="line">  <span class="attr">shouldAnimate</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// clockViewModel: ClockViewModel</span></span><br><span class="line">  <span class="comment">// 作用: 时钟视图模型</span></span><br><span class="line">  <span class="comment">// 默认: new ClockViewModel(clock)</span></span><br><span class="line">  <span class="comment">// 用途: 控制时间和动画</span></span><br><span class="line">  <span class="attr">clockViewModel</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ClockViewModel</span>(<span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Clock</span>()),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// selectedImageryProviderViewModel: ProviderViewModel</span></span><br><span class="line">  <span class="comment">// 作用: 默认选中的影像提供者</span></span><br><span class="line">  <span class="comment">// 默认: undefined</span></span><br><span class="line">  <span class="comment">// 用途: 设置初始影像图层</span></span><br><span class="line">  <span class="attr">selectedImageryProviderViewModel</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// imageryProviderViewModels: ProviderViewModel[]</span></span><br><span class="line">  <span class="comment">// 作用: 可用的影像提供者列表</span></span><br><span class="line">  <span class="comment">// 默认: createDefaultImageryProviderViewModels()</span></span><br><span class="line">  <span class="comment">// 用途: 图层选择器中的选项</span></span><br><span class="line">  <span class="attr">imageryProviderViewModels</span>: [],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// selectedTerrainProviderViewModel: ProviderViewModel</span></span><br><span class="line">  <span class="comment">// 作用: 默认选中的地形提供者</span></span><br><span class="line">  <span class="comment">// 默认: undefined</span></span><br><span class="line">  <span class="comment">// 用途: 设置初始地形</span></span><br><span class="line">  <span class="attr">selectedTerrainProviderViewModel</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// terrainProviderViewModels: ProviderViewModel[]</span></span><br><span class="line">  <span class="comment">// 作用: 可用的地形提供者列表</span></span><br><span class="line">  <span class="comment">// 默认: createDefaultTerrainProviderViewModels()</span></span><br><span class="line">  <span class="comment">// 用途: 地形选择器中的选项</span></span><br><span class="line">  <span class="attr">terrainProviderViewModels</span>: [],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 渲染器选项 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// imageryProvider: ImageryProvider | false</span></span><br><span class="line">  <span class="comment">// 作用: 影像提供者</span></span><br><span class="line">  <span class="comment">// 默认: createWorldImagery()</span></span><br><span class="line">  <span class="comment">// 离线设置: 自定义离线影像或false</span></span><br><span class="line">  <span class="attr">imageryProvider</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">OpenStreetMapImageryProvider</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://tile.openstreetmap.org/&#x27;</span>, <span class="comment">// 或本地瓦片服务</span></span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// terrainProvider: TerrainProvider</span></span><br><span class="line">  <span class="comment">// 作用: 地形提供者</span></span><br><span class="line">  <span class="comment">// 默认: new EllipsoidTerrainProvider()</span></span><br><span class="line">  <span class="comment">// 离线设置: EllipsoidTerrainProvider（椭球地形）</span></span><br><span class="line">  <span class="attr">terrainProvider</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">EllipsoidTerrainProvider</span>(),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// skyBox: SkyBox | false</span></span><br><span class="line">  <span class="comment">// 作用: 天空盒</span></span><br><span class="line">  <span class="comment">// 默认: undefined（使用默认天空）</span></span><br><span class="line">  <span class="comment">// 用途: 自定义天空背景</span></span><br><span class="line">  <span class="attr">skyBox</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SkyBox</span>(&#123;</span><br><span class="line">    <span class="attr">sources</span>: &#123;</span><br><span class="line">      <span class="attr">positiveX</span>: <span class="string">&#x27;path/to/skybox_px.jpg&#x27;</span>,</span><br><span class="line">      <span class="attr">negativeX</span>: <span class="string">&#x27;path/to/skybox_nx.jpg&#x27;</span>,</span><br><span class="line">      <span class="attr">positiveY</span>: <span class="string">&#x27;path/to/skybox_py.jpg&#x27;</span>,</span><br><span class="line">      <span class="attr">negativeY</span>: <span class="string">&#x27;path/to/skybox_ny.jpg&#x27;</span>,</span><br><span class="line">      <span class="attr">positiveZ</span>: <span class="string">&#x27;path/to/skybox_pz.jpg&#x27;</span>,</span><br><span class="line">      <span class="attr">negativeZ</span>: <span class="string">&#x27;path/to/skybox_nz.jpg&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// skyAtmosphere: SkyAtmosphere | false</span></span><br><span class="line">  <span class="comment">// 作用: 天空大气效果</span></span><br><span class="line">  <span class="comment">// 默认: undefined（使用默认大气）</span></span><br><span class="line">  <span class="comment">// 用途: 控制大气散射效果</span></span><br><span class="line">  <span class="attr">skyAtmosphere</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SkyAtmosphere</span>(),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 高级渲染选项 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// shadows: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否启用阴影</span></span><br><span class="line">  <span class="comment">// 默认: false</span></span><br><span class="line">  <span class="comment">// 性能影响: 较大</span></span><br><span class="line">  <span class="attr">shadows</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// terrainShadows: ShadowMode</span></span><br><span class="line">  <span class="comment">// 作用: 地形阴影模式</span></span><br><span class="line">  <span class="comment">// 默认: ShadowMode.RECEIVE_ONLY</span></span><br><span class="line">  <span class="comment">// 选项: DISABLED, ENABLED, CAST_ONLY, RECEIVE_ONLY</span></span><br><span class="line">  <span class="attr">terrainShadows</span>: <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">ENABLED</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// mapMode2D: MapMode2D</span></span><br><span class="line">  <span class="comment">// 作用: 2D地图模式</span></span><br><span class="line">  <span class="comment">// 默认: MapMode2D.INFINITE_SCROLL</span></span><br><span class="line">  <span class="comment">// 选项: INFINITE_SCROLL, ROTATE</span></span><br><span class="line">  <span class="attr">mapMode2D</span>: <span class="title class_">Cesium</span>.<span class="property">MapMode2D</span>.<span class="property">INFINITE_SCROLL</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// projectionPicker: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 投影选择器</span></span><br><span class="line">  <span class="comment">// 默认: false</span></span><br><span class="line">  <span class="comment">// 用途: 在2D模式下选择投影方式</span></span><br><span class="line">  <span class="attr">projectionPicker</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// requestRenderMode: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 按需渲染模式</span></span><br><span class="line">  <span class="comment">// 默认: false</span></span><br><span class="line">  <span class="comment">// 性能优化: 只在需要时渲染</span></span><br><span class="line">  <span class="attr">requestRenderMode</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// maximumRenderTimeChange: number</span></span><br><span class="line">  <span class="comment">// 作用: 最大渲染时间变化（毫秒）</span></span><br><span class="line">  <span class="comment">// 默认: 0.0</span></span><br><span class="line">  <span class="comment">// 用途: 控制按需渲染的触发阈值</span></span><br><span class="line">  <span class="attr">maximumRenderTimeChange</span>: <span class="number">0.0</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === WebGL选项 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// contextOptions: Object</span></span><br><span class="line">  <span class="comment">// 作用: WebGL上下文选项</span></span><br><span class="line">  <span class="comment">// 默认: undefined</span></span><br><span class="line">  <span class="comment">// 用途: 控制WebGL上下文创建</span></span><br><span class="line">  <span class="attr">contextOptions</span>: &#123;</span><br><span class="line">    <span class="attr">webgl</span>: &#123;</span><br><span class="line">      <span class="attr">alpha</span>: <span class="literal">false</span>, <span class="comment">// 透明度通道</span></span><br><span class="line">      <span class="attr">depth</span>: <span class="literal">true</span>, <span class="comment">// 深度缓冲</span></span><br><span class="line">      <span class="attr">stencil</span>: <span class="literal">false</span>, <span class="comment">// 模板缓冲</span></span><br><span class="line">      <span class="attr">antialias</span>: <span class="literal">true</span>, <span class="comment">// 抗锯齿</span></span><br><span class="line">      <span class="attr">premultipliedAlpha</span>: <span class="literal">true</span>, <span class="comment">// 预乘alpha</span></span><br><span class="line">      <span class="attr">preserveDrawingBuffer</span>: <span class="literal">false</span>, <span class="comment">// 保留绘图缓冲</span></span><br><span class="line">      <span class="attr">powerPreference</span>: <span class="string">&#x27;high-performance&#x27;</span>, <span class="comment">// 性能偏好</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// useDefaultRenderLoop: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否使用默认渲染循环</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 高级用途: 自定义渲染循环</span></span><br><span class="line">  <span class="attr">useDefaultRenderLoop</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// targetFrameRate: number</span></span><br><span class="line">  <span class="comment">// 作用: 目标帧率</span></span><br><span class="line">  <span class="comment">// 默认: undefined</span></span><br><span class="line">  <span class="comment">// 性能控制: 限制渲染帧率</span></span><br><span class="line">  <span class="attr">targetFrameRate</span>: <span class="number">60</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// showRenderLoopErrors: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否显示渲染循环错误</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 调试用途: 错误信息显示</span></span><br><span class="line">  <span class="attr">showRenderLoopErrors</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// automaticallyTrackDataSourceClocks: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否自动跟踪数据源时钟</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 时间控制: 数据源时间同步</span></span><br><span class="line">  <span class="attr">automaticallyTrackDataSourceClocks</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 输入控制选项 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// enableCollisionDetection: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否启用碰撞检测</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 用途: 相机与地形的碰撞检测</span></span><br><span class="line">  <span class="attr">enableCollisionDetection</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// useBrowserRecommendedResolution: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否使用浏览器推荐分辨率</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 性能影响: 高分辨率显示器的性能</span></span><br><span class="line">  <span class="attr">useBrowserRecommendedResolution</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// orderIndependentTranslucency: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 顺序无关透明度</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// 渲染质量: 透明物体的渲染质量</span></span><br><span class="line">  <span class="attr">orderIndependentTranslucency</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// creditContainer: Element | string</span></span><br><span class="line">  <span class="comment">// 作用: 版权信息容器</span></span><br><span class="line">  <span class="comment">// 默认: undefined</span></span><br><span class="line">  <span class="comment">// 用途: 自定义版权信息显示位置</span></span><br><span class="line">  <span class="attr">creditContainer</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// creditViewport: Element | string</span></span><br><span class="line">  <span class="comment">// 作用: 版权信息视口</span></span><br><span class="line">  <span class="comment">// 默认: undefined</span></span><br><span class="line">  <span class="comment">// 用途: 版权信息的显示区域</span></span><br><span class="line">  <span class="attr">creditViewport</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// dataSources: DataSourceCollection</span></span><br><span class="line">  <span class="comment">// 作用: 数据源集合</span></span><br><span class="line">  <span class="comment">// 默认: new DataSourceCollection()</span></span><br><span class="line">  <span class="comment">// 用途: 预设的数据源</span></span><br><span class="line">  <span class="attr">dataSources</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">DataSourceCollection</span>(),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// clock: Clock</span></span><br><span class="line">  <span class="comment">// 作用: 时钟对象</span></span><br><span class="line">  <span class="comment">// 默认: new Clock()</span></span><br><span class="line">  <span class="comment">// 时间控制: 场景时间管理</span></span><br><span class="line">  <span class="attr">clock</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Clock</span>(),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// blurActiveElementOnCanvasFocus: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 画布获得焦点时是否模糊活动元素</span></span><br><span class="line">  <span class="comment">// 默认: true</span></span><br><span class="line">  <span class="comment">// UI控制: 焦点管理</span></span><br><span class="line">  <span class="attr">blurActiveElementOnCanvasFocus</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// msaaSamples: number</span></span><br><span class="line">  <span class="comment">// 作用: MSAA采样数量</span></span><br><span class="line">  <span class="comment">// 默认: 1</span></span><br><span class="line">  <span class="comment">// 抗锯齿: 多重采样抗锯齿</span></span><br><span class="line">  <span class="attr">msaaSamples</span>: <span class="number">4</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="坐标系统详解"><a href="#坐标系统详解" class="headerlink" title="坐标系统详解"></a>坐标系统详解</h2><h3 id="Cartesian3-笛卡尔坐标系"><a href="#Cartesian3-笛卡尔坐标系" class="headerlink" title="Cartesian3 笛卡尔坐标系"></a>Cartesian3 笛卡尔坐标系</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cartesian3 - 3D笛卡尔坐标</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cartesian3</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">x = <span class="number">0.0</span>, y = <span class="number">0.0</span>, z = <span class="number">0.0</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = x <span class="comment">// X轴坐标（米）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = y <span class="comment">// Y轴坐标（米）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">z</span> = z <span class="comment">// Z轴坐标（米）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromDegrees - 从经纬度创建</span></span><br><span class="line">  <span class="comment">// longitude: 经度（度）</span></span><br><span class="line">  <span class="comment">// latitude: 纬度（度）</span></span><br><span class="line">  <span class="comment">// height: 高度（米，可选，默认0）</span></span><br><span class="line">  <span class="comment">// ellipsoid: 椭球体（可选，默认WGS84）</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromDegrees</span>(<span class="params">longitude, latitude, height = <span class="number">0</span>, ellipsoid = Cesium.Ellipsoid.WGS84</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(longitude, latitude, height, ellipsoid)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromRadians - 从弧度创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromRadians</span>(<span class="params">longitude, latitude, height = <span class="number">0</span>, ellipsoid = Cesium.Ellipsoid.WGS84</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromRadians</span>(longitude, latitude, height, ellipsoid)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromDegreesArray - 从经纬度数组创建</span></span><br><span class="line">  <span class="comment">// coordinates: [lon1, lat1, lon2, lat2, ...]</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromDegreesArray</span>(<span class="params">coordinates, ellipsoid = Cesium.Ellipsoid.WGS84</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>(coordinates, ellipsoid)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromDegreesArrayHeights - 从经纬度高度数组创建</span></span><br><span class="line">  <span class="comment">// coordinates: [lon1, lat1, height1, lon2, lat2, height2, ...]</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromDegreesArrayHeights</span>(<span class="params">coordinates, ellipsoid = Cesium.Ellipsoid.WGS84</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArrayHeights</span>(coordinates, ellipsoid)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 实例方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// clone - 克隆</span></span><br><span class="line">  <span class="title function_">clone</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">clone</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// equals - 比较相等</span></span><br><span class="line">  <span class="title function_">equals</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">equals</span>(<span class="variable language_">this</span>, other)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// distance - 计算距离</span></span><br><span class="line">  <span class="title function_">distanceTo</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">distance</span>(<span class="variable language_">this</span>, other)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// normalize - 标准化</span></span><br><span class="line">  <span class="title function_">normalize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">normalize</span>(<span class="variable language_">this</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// magnitude - 计算向量长度</span></span><br><span class="line">  <span class="title function_">magnitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">magnitude</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// add - 向量加法</span></span><br><span class="line">  <span class="title function_">add</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">add</span>(<span class="variable language_">this</span>, other, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// subtract - 向量减法</span></span><br><span class="line">  <span class="title function_">subtract</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">subtract</span>(<span class="variable language_">this</span>, other, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// multiplyByScalar - 标量乘法</span></span><br><span class="line">  <span class="title function_">multiplyByScalar</span>(<span class="params">scalar</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">multiplyByScalar</span>(<span class="variable language_">this</span>, scalar, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// dot - 点积</span></span><br><span class="line">  <span class="title function_">dot</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">dot</span>(<span class="variable language_">this</span>, other)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// cross - 叉积</span></span><br><span class="line">  <span class="title function_">cross</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">cross</span>(<span class="variable language_">this</span>, other, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> position = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">1000000</span>, <span class="number">2000000</span>, <span class="number">3000000</span>)</span><br><span class="line"><span class="keyword">const</span> beijingPosition = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">const</span> positions = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>([</span><br><span class="line">  <span class="number">116.4074</span>,</span><br><span class="line">  <span class="number">39.9042</span>, <span class="comment">// 北京</span></span><br><span class="line">  <span class="number">121.4737</span>,</span><br><span class="line">  <span class="number">31.2304</span>, <span class="comment">// 上海</span></span><br><span class="line">  <span class="number">113.2644</span>,</span><br><span class="line">  <span class="number">23.1291</span>, <span class="comment">// 广州</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<h3 id="Cartographic-地理坐标系"><a href="#Cartographic-地理坐标系" class="headerlink" title="Cartographic 地理坐标系"></a>Cartographic 地理坐标系</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cartographic - 地理坐标（经纬度）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cartographic</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">longitude = <span class="number">0.0</span>, latitude = <span class="number">0.0</span>, height = <span class="number">0.0</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">longitude</span> = longitude <span class="comment">// 经度（弧度）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">latitude</span> = latitude <span class="comment">// 纬度（弧度）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = height <span class="comment">// 高度（米）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromDegrees - 从度数创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromDegrees</span>(<span class="params">longitude, latitude, height = <span class="number">0.0</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartographic</span>(</span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(longitude),</span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(latitude),</span><br><span class="line">      height,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromRadians - 从弧度创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromRadians</span>(<span class="params">longitude, latitude, height = <span class="number">0.0</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartographic</span>(longitude, latitude, height)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromCartesian - 从笛卡尔坐标创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromCartesian</span>(<span class="params">cartesian, ellipsoid = Cesium.Ellipsoid.WGS84</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(cartesian, ellipsoid)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 实例方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// toLongitudeLatitude - 转换为经纬度（度）</span></span><br><span class="line">  <span class="title function_">toLongitudeLatitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">longitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(<span class="variable language_">this</span>.<span class="property">longitude</span>),</span><br><span class="line">      <span class="attr">latitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(<span class="variable language_">this</span>.<span class="property">latitude</span>),</span><br><span class="line">      <span class="attr">height</span>: <span class="variable language_">this</span>.<span class="property">height</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// clone - 克隆</span></span><br><span class="line">  <span class="title function_">clone</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">clone</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// equals - 比较相等</span></span><br><span class="line">  <span class="title function_">equals</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">equals</span>(<span class="variable language_">this</span>, other)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> cartographic = <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">const</span> cartesian = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">const</span> backToCartographic = <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(cartesian)</span><br></pre></td></tr></table></figure>

<h3 id="Matrix4-变换矩阵"><a href="#Matrix4-变换矩阵" class="headerlink" title="Matrix4 变换矩阵"></a>Matrix4 变换矩阵</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Matrix4 - 4x4变换矩阵</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Matrix4</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 16个元素的数组，按列优先存储</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">elements</span> = [</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="comment">// 第一列</span></span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="comment">// 第二列</span></span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="comment">// 第三列</span></span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="comment">// 第四列</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态创建方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// IDENTITY - 单位矩阵</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">IDENTITY</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromTranslation - 从平移创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromTranslation</span>(<span class="params">translation</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">fromTranslation</span>(translation)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromScale - 从缩放创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromScale</span>(<span class="params">scale</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">fromScale</span>(scale)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromRotationTranslation - 从旋转和平移创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromRotationTranslation</span>(<span class="params">rotation, translation</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">fromRotationTranslation</span>(rotation, translation)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 变换方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// multiplyByPoint - 乘以点</span></span><br><span class="line">  <span class="title function_">multiplyByPoint</span>(<span class="params">point</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByPoint</span>(<span class="variable language_">this</span>, point, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// multiplyByVector - 乘以向量</span></span><br><span class="line">  <span class="title function_">multiplyByVector</span>(<span class="params">vector</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByVector</span>(<span class="variable language_">this</span>, vector, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian4</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// multiply - 矩阵乘法</span></span><br><span class="line">  <span class="title function_">multiply</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiply</span>(<span class="variable language_">this</span>, other, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// inverse - 求逆矩阵</span></span><br><span class="line">  <span class="title function_">inverse</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">inverse</span>(<span class="variable language_">this</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// transpose - 转置</span></span><br><span class="line">  <span class="title function_">transpose</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">transpose</span>(<span class="variable language_">this</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> translation = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>)</span><br><span class="line"><span class="keyword">const</span> translationMatrix = <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">fromTranslation</span>(translation)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> scale = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">const</span> scaleMatrix = <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">fromScale</span>(scale)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rotation = <span class="title class_">Cesium</span>.<span class="property">Matrix3</span>.<span class="title function_">fromRotationZ</span>(<span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(<span class="number">45</span>))</span><br><span class="line"><span class="keyword">const</span> rotationMatrix = <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">fromRotation</span>(rotation)</span><br></pre></td></tr></table></figure>

<h2 id="实体系统完整属性"><a href="#实体系统完整属性" class="headerlink" title="实体系统完整属性"></a>实体系统完整属性</h2><h3 id="Entity-基础实体"><a href="#Entity-基础实体" class="headerlink" title="Entity 基础实体"></a>Entity 基础实体</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Entity - 基础实体类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Entity</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// === 基础属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// id: string</span></span><br><span class="line">    <span class="comment">// 作用: 实体的唯一标识符</span></span><br><span class="line">    <span class="comment">// 默认: 自动生成UUID</span></span><br><span class="line">    <span class="comment">// 用途: 查找、更新、删除实体</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = options.<span class="property">id</span> || <span class="title class_">Cesium</span>.<span class="title function_">createGuid</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// name: string</span></span><br><span class="line">    <span class="comment">// 作用: 实体的显示名称</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: InfoBox标题、标签文本</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = options.<span class="property">name</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// availability: TimeIntervalCollection</span></span><br><span class="line">    <span class="comment">// 作用: 实体的可用时间间隔</span></span><br><span class="line">    <span class="comment">// 默认: undefined（始终可用）</span></span><br><span class="line">    <span class="comment">// 用途: 时间动画中的显示控制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">availability</span> = options.<span class="property">availability</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制实体的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="comment">// 用途: 显示/隐藏实体</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// description: string | Property</span></span><br><span class="line">    <span class="comment">// 作用: 实体的描述信息</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: InfoBox的内容</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">description</span> = options.<span class="property">description</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// position: PositionProperty</span></span><br><span class="line">    <span class="comment">// 作用: 实体的位置</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 类型: Cartesian3 | PositionProperty</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">position</span> = options.<span class="property">position</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// orientation: Property</span></span><br><span class="line">    <span class="comment">// 作用: 实体的方向（四元数）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 类型: Quaternion | Property</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">orientation</span> = options.<span class="property">orientation</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// viewFrom: Property</span></span><br><span class="line">    <span class="comment">// 作用: 相机观察实体时的相对位置</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 类型: Cartesian3 | Property</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">viewFrom</span> = options.<span class="property">viewFrom</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// parent: Entity</span></span><br><span class="line">    <span class="comment">// 作用: 父实体（用于层次结构）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 实体的父子关系</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">parent</span> = options.<span class="property">parent</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 图形属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// billboard: BillboardGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 广告牌图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">billboard</span> = options.<span class="property">billboard</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// box: BoxGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 盒子图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">box</span> = options.<span class="property">box</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// corridor: CorridorGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 走廊图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">corridor</span> = options.<span class="property">corridor</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// cylinder: CylinderGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 圆柱体图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cylinder</span> = options.<span class="property">cylinder</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ellipse: EllipseGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 椭圆图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ellipse</span> = options.<span class="property">ellipse</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ellipsoid: EllipsoidGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 椭球体图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ellipsoid</span> = options.<span class="property">ellipsoid</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// label: LabelGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 标签图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">label</span> = options.<span class="property">label</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// model: ModelGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 3D模型图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">model</span> = options.<span class="property">model</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// tileset: Cesium3DTilesetGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 3D瓦片集图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tileset</span> = options.<span class="property">tileset</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// path: PathGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 路径图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">path</span> = options.<span class="property">path</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// plane: PlaneGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 平面图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">plane</span> = options.<span class="property">plane</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// point: PointGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 点图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">point</span> = options.<span class="property">point</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// polygon: PolygonGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 多边形图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">polygon</span> = options.<span class="property">polygon</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// polyline: PolylineGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 多段线图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">polyline</span> = options.<span class="property">polyline</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// polylineVolume: PolylineVolumeGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 多段线体积图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">polylineVolume</span> = options.<span class="property">polylineVolume</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// rectangle: RectangleGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 矩形图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rectangle</span> = options.<span class="property">rectangle</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// wall: WallGraphics</span></span><br><span class="line">    <span class="comment">// 作用: 墙体图形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">wall</span> = options.<span class="property">wall</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// computeModelMatrix - 计算模型矩阵</span></span><br><span class="line">  <span class="comment">// time: JulianDate - 时间</span></span><br><span class="line">  <span class="comment">// result: Matrix4 - 结果矩阵</span></span><br><span class="line">  <span class="title function_">computeModelMatrix</span>(<span class="params">time, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Entity</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">computeModelMatrix</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, time, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// isShowing - 是否正在显示</span></span><br><span class="line">  <span class="comment">// time: JulianDate - 时间</span></span><br><span class="line">  <span class="title function_">isShowing</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">show</span> &amp;&amp; (!<span class="variable language_">this</span>.<span class="property">availability</span> || <span class="variable language_">this</span>.<span class="property">availability</span>.<span class="title function_">contains</span>(time))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// isAvailable - 是否可用</span></span><br><span class="line">  <span class="comment">// time: JulianDate - 时间</span></span><br><span class="line">  <span class="title function_">isAvailable</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="variable language_">this</span>.<span class="property">availability</span> || <span class="variable language_">this</span>.<span class="property">availability</span>.<span class="title function_">contains</span>(time)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建实体示例</span></span><br><span class="line"><span class="keyword">const</span> entity = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Entity</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;beijing-marker&#x27;</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;北京标记&#x27;</span>,</span><br><span class="line">  <span class="attr">description</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div style=&quot;padding: 10px;&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;h3&gt;北京市&lt;/h3&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;中华人民共和国首都&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;人口: 2154万&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;面积: 16410.54平方公里&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">availability</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeIntervalCollection</span>([</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">      <span class="attr">start</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2023-01-01&#x27;</span>)),</span><br><span class="line">      <span class="attr">stop</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2024-12-31&#x27;</span>)),</span><br><span class="line">    &#125;),</span><br><span class="line">  ]),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="BillboardGraphics-广告牌图形"><a href="#BillboardGraphics-广告牌图形" class="headerlink" title="BillboardGraphics 广告牌图形"></a>BillboardGraphics 广告牌图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BillboardGraphics - 广告牌图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BillboardGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制广告牌的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// image: string | HTMLCanvasElement | HTMLVideoElement | Property</span></span><br><span class="line">    <span class="comment">// 作用: 广告牌的图像</span></span><br><span class="line">    <span class="comment">// 支持: URL、Canvas、Video、Data URL</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">image</span> = options.<span class="property">image</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// scale: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 广告牌的缩放比例</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="comment">// 范围: 0.0 - 任意正数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scale</span> = options.<span class="property">scale</span> !== <span class="literal">undefined</span> ? options.<span class="property">scale</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pixelOffset: Cartesian2 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 像素偏移量</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian2.ZERO</span></span><br><span class="line">    <span class="comment">// 用途: 微调广告牌位置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pixelOffset</span> = options.<span class="property">pixelOffset</span> || <span class="title class_">Cesium</span>.<span class="property">Cartesian2</span>.<span class="property">ZERO</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// eyeOffset: Cartesian3 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 眼部偏移量（相机空间）</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian3.ZERO</span></span><br><span class="line">    <span class="comment">// 用途: 深度控制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">eyeOffset</span> = options.<span class="property">eyeOffset</span> || <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="property">ZERO</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// horizontalOrigin: HorizontalOrigin | Property</span></span><br><span class="line">    <span class="comment">// 作用: 水平对齐方式</span></span><br><span class="line">    <span class="comment">// 默认: HorizontalOrigin.CENTER</span></span><br><span class="line">    <span class="comment">// 选项: LEFT, CENTER, RIGHT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">horizontalOrigin</span> = options.<span class="property">horizontalOrigin</span> || <span class="title class_">Cesium</span>.<span class="property">HorizontalOrigin</span>.<span class="property">CENTER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// verticalOrigin: VerticalOrigin | Property</span></span><br><span class="line">    <span class="comment">// 作用: 垂直对齐方式</span></span><br><span class="line">    <span class="comment">// 默认: VerticalOrigin.CENTER</span></span><br><span class="line">    <span class="comment">// 选项: BOTTOM, BASELINE, CENTER, TOP</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">verticalOrigin</span> = options.<span class="property">verticalOrigin</span> || <span class="title class_">Cesium</span>.<span class="property">VerticalOrigin</span>.<span class="property">CENTER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="comment">// 选项: NONE, CLAMP_TO_GROUND, RELATIVE_TO_GROUND</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// color: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 广告牌颜色（与图像混合）</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = options.<span class="property">color</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// rotation: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 旋转角度（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="comment">// 正值: 逆时针旋转</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rotation</span> = options.<span class="property">rotation</span> !== <span class="literal">undefined</span> ? options.<span class="property">rotation</span> : <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// alignedAxis: Cartesian3 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 对齐轴</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian3.ZERO（自动对齐到屏幕）</span></span><br><span class="line">    <span class="comment">// 用途: 固定广告牌的旋转轴</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">alignedAxis</span> = options.<span class="property">alignedAxis</span> || <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="property">ZERO</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// sizeInMeters: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否以米为单位计算尺寸</span></span><br><span class="line">    <span class="comment">// 默认: false（以像素为单位）</span></span><br><span class="line">    <span class="comment">// true: 广告牌大小不随距离变化</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sizeInMeters</span> = options.<span class="property">sizeInMeters</span> !== <span class="literal">undefined</span> ? options.<span class="property">sizeInMeters</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// width: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 广告牌宽度</span></span><br><span class="line">    <span class="comment">// 默认: undefined（使用图像宽度）</span></span><br><span class="line">    <span class="comment">// 单位: 像素或米（取决于sizeInMeters）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = options.<span class="property">width</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// height: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 广告牌高度</span></span><br><span class="line">    <span class="comment">// 默认: undefined（使用图像高度）</span></span><br><span class="line">    <span class="comment">// 单位: 像素或米（取决于sizeInMeters）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = options.<span class="property">height</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// scaleByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的缩放</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: LOD效果</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scaleByDistance</span> = options.<span class="property">scaleByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// translucencyByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的透明度</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 渐隐效果</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">translucencyByDistance</span> = options.<span class="property">translucencyByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pixelOffsetScaleByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的像素偏移缩放</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pixelOffsetScaleByDistance</span> = options.<span class="property">pixelOffsetScaleByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// imageSubRegion: BoundingRectangle | Property</span></span><br><span class="line">    <span class="comment">// 作用: 图像子区域</span></span><br><span class="line">    <span class="comment">// 默认: undefined（使用整个图像）</span></span><br><span class="line">    <span class="comment">// 用途: 纹理图集</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">imageSubRegion</span> = options.<span class="property">imageSubRegion</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 基于距离的显示/隐藏</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// disableDepthTestDistance: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 禁用深度测试的距离</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="comment">// 用途: 防止广告牌被地形遮挡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">disableDepthTestDistance</span> =</span><br><span class="line">      options.<span class="property">disableDepthTestDistance</span> !== <span class="literal">undefined</span> ? options.<span class="property">disableDepthTestDistance</span> : <span class="number">0.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> billboardEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>),</span><br><span class="line">  <span class="attr">billboard</span>: &#123;</span><br><span class="line">    <span class="attr">image</span>:</span><br><span class="line">      <span class="string">&#x27;data:image/svg+xml;base64,&#x27;</span> +</span><br><span class="line">      <span class="title function_">btoa</span>(<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;svg width=&quot;32&quot; height=&quot;40&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;path d=&quot;M16 0C7.2 0 0 7.2 0 16c0 8.8 16 24 16 24s16-15.2 16-24C32 7.2 24.8 0 16 0z&quot; fill=&quot;#E53E3E&quot;/&gt;</span></span><br><span class="line"><span class="string">        &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;8&quot; fill=&quot;#FFF&quot;/&gt;</span></span><br><span class="line"><span class="string">        &lt;text x=&quot;16&quot; y=&quot;20&quot; text-anchor=&quot;middle&quot; fill=&quot;#E53E3E&quot; font-size=&quot;8&quot;&gt;1&lt;/text&gt;</span></span><br><span class="line"><span class="string">      &lt;/svg&gt;</span></span><br><span class="line"><span class="string">    `</span>),</span><br><span class="line">    <span class="attr">scale</span>: <span class="number">1.5</span>,</span><br><span class="line">    <span class="attr">verticalOrigin</span>: <span class="title class_">Cesium</span>.<span class="property">VerticalOrigin</span>.<span class="property">BOTTOM</span>,</span><br><span class="line">    <span class="attr">heightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">CLAMP_TO_GROUND</span>,</span><br><span class="line">    <span class="attr">scaleByDistance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">NearFarScalar</span>(<span class="number">1.5e2</span>, <span class="number">2.0</span>, <span class="number">1.5e7</span>, <span class="number">0.5</span>),</span><br><span class="line">    <span class="attr">distanceDisplayCondition</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">DistanceDisplayCondition</span>(<span class="number">0</span>, <span class="number">1.5e7</span>),</span><br><span class="line">    <span class="attr">disableDepthTestDistance</span>: <span class="title class_">Number</span>.<span class="property">POSITIVE_INFINITY</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="PointGraphics-点图形"><a href="#PointGraphics-点图形" class="headerlink" title="PointGraphics 点图形"></a>PointGraphics 点图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PointGraphics - 点图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PointGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制点的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pixelSize: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 点的像素大小</span></span><br><span class="line">    <span class="comment">// 默认: 1</span></span><br><span class="line">    <span class="comment">// 范围: 1 - 硬件限制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pixelSize</span> = options.<span class="property">pixelSize</span> !== <span class="literal">undefined</span> ? options.<span class="property">pixelSize</span> : <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="comment">// 选项: NONE, CLAMP_TO_GROUND, RELATIVE_TO_GROUND</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// color: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 点的颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = options.<span class="property">color</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 点的轮廓颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineColor</span> = options.<span class="property">outlineColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineWidth: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓宽度</span></span><br><span class="line">    <span class="comment">// 默认: 0</span></span><br><span class="line">    <span class="comment">// 范围: 0 - 硬件限制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineWidth</span> = options.<span class="property">outlineWidth</span> !== <span class="literal">undefined</span> ? options.<span class="property">outlineWidth</span> : <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// scaleByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的缩放</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scaleByDistance</span> = options.<span class="property">scaleByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// translucencyByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的透明度</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">translucencyByDistance</span> = options.<span class="property">translucencyByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// disableDepthTestDistance: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 禁用深度测试的距离</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">disableDepthTestDistance</span> =</span><br><span class="line">      options.<span class="property">disableDepthTestDistance</span> !== <span class="literal">undefined</span> ? options.<span class="property">disableDepthTestDistance</span> : <span class="number">0.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> pointEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>),</span><br><span class="line">  <span class="attr">point</span>: &#123;</span><br><span class="line">    <span class="attr">pixelSize</span>: <span class="number">15</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">    <span class="attr">outlineWidth</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">heightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">CLAMP_TO_GROUND</span>,</span><br><span class="line">    <span class="attr">scaleByDistance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">NearFarScalar</span>(<span class="number">1.5e2</span>, <span class="number">3.0</span>, <span class="number">1.5e7</span>, <span class="number">0.5</span>),</span><br><span class="line">    <span class="attr">distanceDisplayCondition</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">DistanceDisplayCondition</span>(<span class="number">0</span>, <span class="number">2.0e6</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="LabelGraphics-标签图形"><a href="#LabelGraphics-标签图形" class="headerlink" title="LabelGraphics 标签图形"></a>LabelGraphics 标签图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// LabelGraphics - 标签图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LabelGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制标签的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// text: string | Property</span></span><br><span class="line">    <span class="comment">// 作用: 标签文本</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 支持: 普通文本、HTML实体</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">text</span> = options.<span class="property">text</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// font: string | Property</span></span><br><span class="line">    <span class="comment">// 作用: 字体样式</span></span><br><span class="line">    <span class="comment">// 默认: &#x27;30px sans-serif&#x27;</span></span><br><span class="line">    <span class="comment">// 格式: CSS字体格式</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">font</span> = options.<span class="property">font</span> || <span class="string">&#x27;30px sans-serif&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// style: LabelStyle | Property</span></span><br><span class="line">    <span class="comment">// 作用: 标签样式</span></span><br><span class="line">    <span class="comment">// 默认: LabelStyle.FILL</span></span><br><span class="line">    <span class="comment">// 选项: FILL, OUTLINE, FILL_AND_OUTLINE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span> = options.<span class="property">style</span> || <span class="title class_">Cesium</span>.<span class="property">LabelStyle</span>.<span class="property">FILL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// scale: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 标签缩放比例</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scale</span> = options.<span class="property">scale</span> !== <span class="literal">undefined</span> ? options.<span class="property">scale</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// showBackground: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示背景</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">showBackground</span> = options.<span class="property">showBackground</span> !== <span class="literal">undefined</span> ? options.<span class="property">showBackground</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// backgroundColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 背景颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color(0.165, 0.165, 0.165, 0.8)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">backgroundColor</span> = options.<span class="property">backgroundColor</span> || <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Color</span>(<span class="number">0.165</span>, <span class="number">0.165</span>, <span class="number">0.165</span>, <span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// backgroundPadding: Cartesian2 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 背景内边距（像素）</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian2(7, 5)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">backgroundPadding</span> = options.<span class="property">backgroundPadding</span> || <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">7</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// pixelOffset: Cartesian2 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 像素偏移量</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian2.ZERO</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pixelOffset</span> = options.<span class="property">pixelOffset</span> || <span class="title class_">Cesium</span>.<span class="property">Cartesian2</span>.<span class="property">ZERO</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// eyeOffset: Cartesian3 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 眼部偏移量</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian3.ZERO</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">eyeOffset</span> = options.<span class="property">eyeOffset</span> || <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="property">ZERO</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// horizontalOrigin: HorizontalOrigin | Property</span></span><br><span class="line">    <span class="comment">// 作用: 水平对齐方式</span></span><br><span class="line">    <span class="comment">// 默认: HorizontalOrigin.CENTER</span></span><br><span class="line">    <span class="comment">// 选项: LEFT, CENTER, RIGHT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">horizontalOrigin</span> = options.<span class="property">horizontalOrigin</span> || <span class="title class_">Cesium</span>.<span class="property">HorizontalOrigin</span>.<span class="property">CENTER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// verticalOrigin: VerticalOrigin | Property</span></span><br><span class="line">    <span class="comment">// 作用: 垂直对齐方式</span></span><br><span class="line">    <span class="comment">// 默认: VerticalOrigin.CENTER</span></span><br><span class="line">    <span class="comment">// 选项: BOTTOM, BASELINE, CENTER, TOP</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">verticalOrigin</span> = options.<span class="property">verticalOrigin</span> || <span class="title class_">Cesium</span>.<span class="property">VerticalOrigin</span>.<span class="property">CENTER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fillColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 填充颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fillColor</span> = options.<span class="property">fillColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineColor</span> = options.<span class="property">outlineColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineWidth: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓宽度</span></span><br><span class="line">    <span class="comment">// 默认: 1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineWidth</span> = options.<span class="property">outlineWidth</span> !== <span class="literal">undefined</span> ? options.<span class="property">outlineWidth</span> : <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// translucencyByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的透明度</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">translucencyByDistance</span> = options.<span class="property">translucencyByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pixelOffsetScaleByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的像素偏移缩放</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pixelOffsetScaleByDistance</span> = options.<span class="property">pixelOffsetScaleByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// scaleByDistance: NearFarScalar | Property</span></span><br><span class="line">    <span class="comment">// 作用: 基于距离的缩放</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scaleByDistance</span> = options.<span class="property">scaleByDistance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// disableDepthTestDistance: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 禁用深度测试的距离</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">disableDepthTestDistance</span> =</span><br><span class="line">      options.<span class="property">disableDepthTestDistance</span> !== <span class="literal">undefined</span> ? options.<span class="property">disableDepthTestDistance</span> : <span class="number">0.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> labelEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>),</span><br><span class="line">  <span class="attr">label</span>: &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;北京市&#x27;</span>,</span><br><span class="line">    <span class="attr">font</span>: <span class="string">&#x27;24pt Microsoft YaHei&#x27;</span>,</span><br><span class="line">    <span class="attr">style</span>: <span class="title class_">Cesium</span>.<span class="property">LabelStyle</span>.<span class="property">FILL_AND_OUTLINE</span>,</span><br><span class="line">    <span class="attr">fillColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">    <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">showBackground</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>.<span class="title function_">withAlpha</span>(<span class="number">0.7</span>),</span><br><span class="line">    <span class="attr">backgroundPadding</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">10</span>, <span class="number">8</span>),</span><br><span class="line">    <span class="attr">verticalOrigin</span>: <span class="title class_">Cesium</span>.<span class="property">VerticalOrigin</span>.<span class="property">BOTTOM</span>,</span><br><span class="line">    <span class="attr">pixelOffset</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">0</span>, -<span class="number">50</span>),</span><br><span class="line">    <span class="attr">heightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">CLAMP_TO_GROUND</span>,</span><br><span class="line">    <span class="attr">scaleByDistance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">NearFarScalar</span>(<span class="number">1.5e2</span>, <span class="number">1.5</span>, <span class="number">1.5e7</span>, <span class="number">0.5</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="PolylineGraphics-多段线图形"><a href="#PolylineGraphics-多段线图形" class="headerlink" title="PolylineGraphics 多段线图形"></a>PolylineGraphics 多段线图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PolylineGraphics - 多段线图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PolylineGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制多段线的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// positions: Array&lt;Cartesian3&gt; | Property</span></span><br><span class="line">    <span class="comment">// 作用: 多段线的顶点位置数组</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 格式: [Cartesian3, Cartesian3, ...]</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">positions</span> = options.<span class="property">positions</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// width: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 线条宽度（像素）</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="comment">// 范围: 1.0 - 硬件限制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = options.<span class="property">width</span> !== <span class="literal">undefined</span> ? options.<span class="property">width</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// granularity: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 线条细分粒度（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: Math.PI / 180（1度）</span></span><br><span class="line">    <span class="comment">// 用途: 控制曲线的平滑度</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">granularity</span> = options.<span class="property">granularity</span> !== <span class="literal">undefined</span> ? options.<span class="property">granularity</span> : <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">180</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// material: MaterialProperty | Color</span></span><br><span class="line">    <span class="comment">// 作用: 线条材质</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="comment">// 类型: Color、ImageMaterialProperty、PolylineDashMaterialProperty等</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">material</span> = options.<span class="property">material</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// depthFailMaterial: MaterialProperty | Color</span></span><br><span class="line">    <span class="comment">// 作用: 深度测试失败时的材质</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 被遮挡部分的显示</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">depthFailMaterial</span> = options.<span class="property">depthFailMaterial</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// followSurface: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否跟随地表</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="comment">// true: 线条贴合地球表面曲率</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">followSurface</span> = options.<span class="property">followSurface</span> !== <span class="literal">undefined</span> ? options.<span class="property">followSurface</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clampToGround: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否贴地</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="comment">// true: 线条贴合地形表面</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clampToGround</span> = options.<span class="property">clampToGround</span> !== <span class="literal">undefined</span> ? options.<span class="property">clampToGround</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode | Property</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.DISABLED</span></span><br><span class="line">    <span class="comment">// 选项: DISABLED, ENABLED, CAST_ONLY, RECEIVE_ONLY</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = options.<span class="property">shadows</span> || <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// classificationType: ClassificationType | Property</span></span><br><span class="line">    <span class="comment">// 作用: 分类类型（用于贴地）</span></span><br><span class="line">    <span class="comment">// 默认: ClassificationType.BOTH</span></span><br><span class="line">    <span class="comment">// 选项: TERRAIN, CESIUM_3D_TILE, BOTH</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">classificationType</span> = options.<span class="property">classificationType</span> || <span class="title class_">Cesium</span>.<span class="property">ClassificationType</span>.<span class="property">BOTH</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// zIndex: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: Z轴索引（贴地时的层次）</span></span><br><span class="line">    <span class="comment">// 默认: 0</span></span><br><span class="line">    <span class="comment">// 用途: 控制重叠线条的显示顺序</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">zIndex</span> = options.<span class="property">zIndex</span> !== <span class="literal">undefined</span> ? options.<span class="property">zIndex</span> : <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> polylineEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">polyline</span>: &#123;</span><br><span class="line">    <span class="attr">positions</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>([</span><br><span class="line">      <span class="number">116.4074</span>,</span><br><span class="line">      <span class="number">39.9042</span>, <span class="comment">// 北京</span></span><br><span class="line">      <span class="number">121.4737</span>,</span><br><span class="line">      <span class="number">31.2304</span>, <span class="comment">// 上海</span></span><br><span class="line">      <span class="number">113.2644</span>,</span><br><span class="line">      <span class="number">23.1291</span>, <span class="comment">// 广州</span></span><br><span class="line">    ]),</span><br><span class="line">    <span class="attr">width</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">CYAN</span>,</span><br><span class="line">    <span class="attr">clampToGround</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 虚线材质</span></span><br><span class="line">    <span class="attr">material</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineDashMaterialProperty</span>(&#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line">      <span class="attr">dashLength</span>: <span class="number">16.0</span>, <span class="comment">// 虚线长度</span></span><br><span class="line">      <span class="attr">dashPattern</span>: <span class="number">255</span>, <span class="comment">// 虚线模式</span></span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 箭头材质</span></span><br><span class="line">    <span class="attr">material</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineArrowMaterialProperty</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发光材质</span></span><br><span class="line">    <span class="attr">material</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineGlowMaterialProperty</span>(&#123;</span><br><span class="line">      <span class="attr">glowPower</span>: <span class="number">0.2</span>, <span class="comment">// 发光强度</span></span><br><span class="line">      <span class="attr">taperPower</span>: <span class="number">0.5</span>, <span class="comment">// 锥形功率</span></span><br><span class="line">      <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="PolygonGraphics-多边形图形"><a href="#PolygonGraphics-多边形图形" class="headerlink" title="PolygonGraphics 多边形图形"></a>PolygonGraphics 多边形图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PolygonGraphics - 多边形图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PolygonGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制多边形的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// hierarchy: PolygonHierarchy | Property</span></span><br><span class="line">    <span class="comment">// 作用: 多边形层次结构（外环和内环）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 格式: 顶点数组或PolygonHierarchy对象</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hierarchy</span> = options.<span class="property">hierarchy</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// height: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 多边形高度（米）</span></span><br><span class="line">    <span class="comment">// 默认: 0</span></span><br><span class="line">    <span class="comment">// 用途: 抬高多边形</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = options.<span class="property">height</span> !== <span class="literal">undefined</span> ? options.<span class="property">height</span> : <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// extrudedHeight: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 拉伸高度（米）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 创建3D立体效果</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">extrudedHeight</span> = options.<span class="property">extrudedHeight</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// extrudedHeightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 拉伸高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">extrudedHeightReference</span> = options.<span class="property">extrudedHeightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// stRotation: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 纹理旋转角度（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="comment">// 用途: 旋转材质纹理</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stRotation</span> = options.<span class="property">stRotation</span> !== <span class="literal">undefined</span> ? options.<span class="property">stRotation</span> : <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// granularity: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 细分粒度（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: Math.PI / 180</span></span><br><span class="line">    <span class="comment">// 用途: 控制曲线边的平滑度</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">granularity</span> = options.<span class="property">granularity</span> !== <span class="literal">undefined</span> ? options.<span class="property">granularity</span> : <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">180</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fill: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否填充</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fill</span> = options.<span class="property">fill</span> !== <span class="literal">undefined</span> ? options.<span class="property">fill</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// material: MaterialProperty | Color</span></span><br><span class="line">    <span class="comment">// 作用: 填充材质</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">material</span> = options.<span class="property">material</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outline: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示轮廓</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outline</span> = options.<span class="property">outline</span> !== <span class="literal">undefined</span> ? options.<span class="property">outline</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineColor</span> = options.<span class="property">outlineColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineWidth: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓宽度（像素）</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="comment">// 注意: 在某些硬件上可能不支持</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineWidth</span> = options.<span class="property">outlineWidth</span> !== <span class="literal">undefined</span> ? options.<span class="property">outlineWidth</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// perPositionHeight: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否使用每个顶点的高度</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="comment">// true: 每个顶点可以有不同的高度</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">perPositionHeight</span> =</span><br><span class="line">      options.<span class="property">perPositionHeight</span> !== <span class="literal">undefined</span> ? options.<span class="property">perPositionHeight</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// closeTop: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否封闭顶部（拉伸时）</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">closeTop</span> = options.<span class="property">closeTop</span> !== <span class="literal">undefined</span> ? options.<span class="property">closeTop</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// closeBottom: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否封闭底部（拉伸时）</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">closeBottom</span> = options.<span class="property">closeBottom</span> !== <span class="literal">undefined</span> ? options.<span class="property">closeBottom</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// arcType: ArcType | Property</span></span><br><span class="line">    <span class="comment">// 作用: 弧线类型</span></span><br><span class="line">    <span class="comment">// 默认: ArcType.GEODESIC</span></span><br><span class="line">    <span class="comment">// 选项: NONE, GEODESIC, RHUMB</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">arcType</span> = options.<span class="property">arcType</span> || <span class="title class_">Cesium</span>.<span class="property">ArcType</span>.<span class="property">GEODESIC</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode | Property</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.DISABLED</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = options.<span class="property">shadows</span> || <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// classificationType: ClassificationType | Property</span></span><br><span class="line">    <span class="comment">// 作用: 分类类型</span></span><br><span class="line">    <span class="comment">// 默认: ClassificationType.BOTH</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">classificationType</span> = options.<span class="property">classificationType</span> || <span class="title class_">Cesium</span>.<span class="property">ClassificationType</span>.<span class="property">BOTH</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// zIndex: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: Z轴索引</span></span><br><span class="line">    <span class="comment">// 默认: 0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">zIndex</span> = options.<span class="property">zIndex</span> !== <span class="literal">undefined</span> ? options.<span class="property">zIndex</span> : <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> polygonEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">polygon</span>: &#123;</span><br><span class="line">    <span class="attr">hierarchy</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>([</span><br><span class="line">      <span class="number">116.3</span>,</span><br><span class="line">      <span class="number">39.8</span>, <span class="comment">// 西南角</span></span><br><span class="line">      <span class="number">116.5</span>,</span><br><span class="line">      <span class="number">39.8</span>, <span class="comment">// 东南角</span></span><br><span class="line">      <span class="number">116.5</span>,</span><br><span class="line">      <span class="number">40.0</span>, <span class="comment">// 东北角</span></span><br><span class="line">      <span class="number">116.3</span>,</span><br><span class="line">      <span class="number">40.0</span>, <span class="comment">// 西北角</span></span><br><span class="line">    ]),</span><br><span class="line">    <span class="attr">height</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">extrudedHeight</span>: <span class="number">300</span>, <span class="comment">// 拉伸300米</span></span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>.<span class="title function_">withAlpha</span>(<span class="number">0.7</span>),</span><br><span class="line">    <span class="attr">outline</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>,</span><br><span class="line">    <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 带洞的多边形</span></span><br><span class="line">    <span class="attr">hierarchy</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolygonHierarchy</span>(</span><br><span class="line">      <span class="comment">// 外环</span></span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>([<span class="number">116.3</span>, <span class="number">39.8</span>, <span class="number">116.5</span>, <span class="number">39.8</span>, <span class="number">116.5</span>, <span class="number">40.0</span>, <span class="number">116.3</span>, <span class="number">40.0</span>]),</span><br><span class="line">      <span class="comment">// 内环（洞）</span></span><br><span class="line">      [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolygonHierarchy</span>(</span><br><span class="line">          <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>([</span><br><span class="line">            <span class="number">116.35</span>, <span class="number">39.85</span>, <span class="number">116.45</span>, <span class="number">39.85</span>, <span class="number">116.45</span>, <span class="number">39.95</span>, <span class="number">116.35</span>, <span class="number">39.95</span>,</span><br><span class="line">          ]),</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 图片材质</span></span><br><span class="line">    <span class="attr">material</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ImageMaterialProperty</span>(&#123;</span><br><span class="line">      <span class="attr">image</span>: <span class="string">&#x27;path/to/texture.png&#x27;</span>,</span><br><span class="line">      <span class="attr">repeat</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">4.0</span>, <span class="number">4.0</span>),</span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 棋盘材质</span></span><br><span class="line">    <span class="attr">material</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CheckerboardMaterialProperty</span>(&#123;</span><br><span class="line">      <span class="attr">evenColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>,</span><br><span class="line">      <span class="attr">oddColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">      <span class="attr">repeat</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">4.0</span>, <span class="number">4.0</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="ModelGraphics-3D模型图形"><a href="#ModelGraphics-3D模型图形" class="headerlink" title="ModelGraphics 3D模型图形"></a>ModelGraphics 3D模型图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ModelGraphics - 3D模型图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制模型的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// uri: string | Resource | Property</span></span><br><span class="line">    <span class="comment">// 作用: 模型文件路径</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 支持: glTF(.gltf, .glb)、COLLADA(.dae)等</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">uri</span> = options.<span class="property">uri</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// scale: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 模型缩放比例</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scale</span> = options.<span class="property">scale</span> !== <span class="literal">undefined</span> ? options.<span class="property">scale</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// minimumPixelSize: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 最小像素大小</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="comment">// 用途: 防止模型在远距离时变得过小</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">minimumPixelSize</span> = options.<span class="property">minimumPixelSize</span> !== <span class="literal">undefined</span> ? options.<span class="property">minimumPixelSize</span> : <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumScale: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 最大缩放比例</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 限制模型的最大显示尺寸</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maximumScale</span> = options.<span class="property">maximumScale</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// incrementallyLoadTextures: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否增量加载纹理</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="comment">// 性能优化: 渐进式纹理加载</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">incrementallyLoadTextures</span> =</span><br><span class="line">      options.<span class="property">incrementallyLoadTextures</span> !== <span class="literal">undefined</span> ? options.<span class="property">incrementallyLoadTextures</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// runAnimations: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否运行动画</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="comment">// 用途: 控制模型内置动画的播放</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">runAnimations</span> = options.<span class="property">runAnimations</span> !== <span class="literal">undefined</span> ? options.<span class="property">runAnimations</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clampAnimations: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否限制动画</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="comment">// 用途: 将动画限制在定义的时间范围内</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clampAnimations</span> = options.<span class="property">clampAnimations</span> !== <span class="literal">undefined</span> ? options.<span class="property">clampAnimations</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode | Property</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.ENABLED</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = options.<span class="property">shadows</span> || <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">ENABLED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// silhouetteColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.RED</span></span><br><span class="line">    <span class="comment">// 用途: 模型被选中时的轮廓颜色</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">silhouetteColor</span> = options.<span class="property">silhouetteColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// silhouetteSize: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓大小</span></span><br><span class="line">    <span class="comment">// 默认: 0.0（不显示轮廓）</span></span><br><span class="line">    <span class="comment">// 用途: 模型被选中时的轮廓宽度</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">silhouetteSize</span> = options.<span class="property">silhouetteSize</span> !== <span class="literal">undefined</span> ? options.<span class="property">silhouetteSize</span> : <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// color: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 模型颜色（混合）</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="comment">// 用途: 与模型纹理混合的颜色</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = options.<span class="property">color</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// colorBlendMode: ColorBlendMode | Property</span></span><br><span class="line">    <span class="comment">// 作用: 颜色混合模式</span></span><br><span class="line">    <span class="comment">// 默认: ColorBlendMode.HIGHLIGHT</span></span><br><span class="line">    <span class="comment">// 选项: HIGHLIGHT, REPLACE, MIX</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colorBlendMode</span> = options.<span class="property">colorBlendMode</span> || <span class="title class_">Cesium</span>.<span class="property">ColorBlendMode</span>.<span class="property">HIGHLIGHT</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// colorBlendAmount: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 颜色混合强度</span></span><br><span class="line">    <span class="comment">// 默认: 0.5</span></span><br><span class="line">    <span class="comment">// 范围: 0.0 - 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colorBlendAmount</span> = options.<span class="property">colorBlendAmount</span> !== <span class="literal">undefined</span> ? options.<span class="property">colorBlendAmount</span> : <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// nodeTransformations: PropertyBag | Property</span></span><br><span class="line">    <span class="comment">// 作用: 节点变换</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 控制模型中特定节点的变换</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">nodeTransformations</span> = options.<span class="property">nodeTransformations</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// articulations: PropertyBag | Property</span></span><br><span class="line">    <span class="comment">// 作用: 关节动画</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 控制模型的关节动画</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">articulations</span> = options.<span class="property">articulations</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clippingPlanes: ClippingPlaneCollection | Property</span></span><br><span class="line">    <span class="comment">// 作用: 裁剪平面</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 用途: 裁剪模型的某些部分</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clippingPlanes</span> = options.<span class="property">clippingPlanes</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> modelEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">uri</span>: <span class="string">&#x27;./models/airplane.gltf&#x27;</span>,</span><br><span class="line">    <span class="attr">scale</span>: <span class="number">2.0</span>,</span><br><span class="line">    <span class="attr">minimumPixelSize</span>: <span class="number">128</span>,</span><br><span class="line">    <span class="attr">maximumScale</span>: <span class="number">20000</span>,</span><br><span class="line">    <span class="attr">heightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">CLAMP_TO_GROUND</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 高亮显示</span></span><br><span class="line">    <span class="attr">silhouetteColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">LIME</span>,</span><br><span class="line">    <span class="attr">silhouetteSize</span>: <span class="number">2.0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 颜色调整</span></span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>,</span><br><span class="line">    <span class="attr">colorBlendMode</span>: <span class="title class_">Cesium</span>.<span class="property">ColorBlendMode</span>.<span class="property">MIX</span>,</span><br><span class="line">    <span class="attr">colorBlendAmount</span>: <span class="number">0.3</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 节点变换（旋转螺旋桨）</span></span><br><span class="line">    <span class="attr">nodeTransformations</span>: &#123;</span><br><span class="line">      <span class="title class_">Propeller</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">NodeTransformationProperty</span>(&#123;</span><br><span class="line">        <span class="attr">rotation</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CallbackProperty</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Quaternion</span>.<span class="title function_">fromAxisAngle</span>(</span><br><span class="line">            <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="property">UNIT_Z</span>,</span><br><span class="line">            (<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span>) * <span class="number">10</span>, <span class="comment">// 每秒10弧度</span></span><br><span class="line">          )</span><br><span class="line">        &#125;, <span class="literal">false</span>),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 裁剪平面</span></span><br><span class="line">    <span class="attr">clippingPlanes</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ClippingPlaneCollection</span>(&#123;</span><br><span class="line">      <span class="attr">planes</span>: [<span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ClippingPlane</span>(<span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>), <span class="number">0.0</span>)],</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="BoxGraphics-盒子图形"><a href="#BoxGraphics-盒子图形" class="headerlink" title="BoxGraphics 盒子图形"></a>BoxGraphics 盒子图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BoxGraphics - 盒子图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BoxGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制盒子的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// dimensions: Cartesian3 | Property</span></span><br><span class="line">    <span class="comment">// 作用: 盒子的尺寸（长、宽、高）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 单位: 米</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dimensions</span> = options.<span class="property">dimensions</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fill: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否填充</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fill</span> = options.<span class="property">fill</span> !== <span class="literal">undefined</span> ? options.<span class="property">fill</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// material: MaterialProperty | Color</span></span><br><span class="line">    <span class="comment">// 作用: 填充材质</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">material</span> = options.<span class="property">material</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outline: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示轮廓</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outline</span> = options.<span class="property">outline</span> !== <span class="literal">undefined</span> ? options.<span class="property">outline</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineColor</span> = options.<span class="property">outlineColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineWidth: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓宽度</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineWidth</span> = options.<span class="property">outlineWidth</span> !== <span class="literal">undefined</span> ? options.<span class="property">outlineWidth</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode | Property</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.DISABLED</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = options.<span class="property">shadows</span> || <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> boxEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">100</span>),</span><br><span class="line">  <span class="attr">box</span>: &#123;</span><br><span class="line">    <span class="attr">dimensions</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">200</span>, <span class="number">200</span>, <span class="number">100</span>), <span class="comment">// 长200m，宽200m，高100m</span></span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>.<span class="title function_">withAlpha</span>(<span class="number">0.7</span>),</span><br><span class="line">    <span class="attr">outline</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>,</span><br><span class="line">    <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">heightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">RELATIVE_TO_GROUND</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="CylinderGraphics-圆柱体图形"><a href="#CylinderGraphics-圆柱体图形" class="headerlink" title="CylinderGraphics 圆柱体图形"></a>CylinderGraphics 圆柱体图形</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CylinderGraphics - 圆柱体图形</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CylinderGraphics</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// show: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 控制圆柱体的可见性</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// length: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 圆柱体长度（高度）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 单位: 米</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">length</span> = options.<span class="property">length</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// topRadius: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 顶部半径</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 单位: 米</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">topRadius</span> = options.<span class="property">topRadius</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// bottomRadius: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 底部半径</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="comment">// 单位: 米</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bottomRadius</span> = options.<span class="property">bottomRadius</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightReference: HeightReference | Property</span></span><br><span class="line">    <span class="comment">// 作用: 高度参考</span></span><br><span class="line">    <span class="comment">// 默认: HeightReference.NONE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightReference</span> = options.<span class="property">heightReference</span> || <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fill: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否填充</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fill</span> = options.<span class="property">fill</span> !== <span class="literal">undefined</span> ? options.<span class="property">fill</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// material: MaterialProperty | Color</span></span><br><span class="line">    <span class="comment">// 作用: 填充材质</span></span><br><span class="line">    <span class="comment">// 默认: Color.WHITE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">material</span> = options.<span class="property">material</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outline: boolean | Property</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示轮廓</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outline</span> = options.<span class="property">outline</span> !== <span class="literal">undefined</span> ? options.<span class="property">outline</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineColor: Color | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineColor</span> = options.<span class="property">outlineColor</span> || <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// outlineWidth: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 轮廓宽度</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">outlineWidth</span> = options.<span class="property">outlineWidth</span> !== <span class="literal">undefined</span> ? options.<span class="property">outlineWidth</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// numberOfVerticalLines: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 垂直线条数量</span></span><br><span class="line">    <span class="comment">// 默认: 16</span></span><br><span class="line">    <span class="comment">// 用途: 控制圆柱体的细分精度</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">numberOfVerticalLines</span> =</span><br><span class="line">      options.<span class="property">numberOfVerticalLines</span> !== <span class="literal">undefined</span> ? options.<span class="property">numberOfVerticalLines</span> : <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// slices: number | Property</span></span><br><span class="line">    <span class="comment">// 作用: 切片数量</span></span><br><span class="line">    <span class="comment">// 默认: 128</span></span><br><span class="line">    <span class="comment">// 用途: 控制圆周方向的精度</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">slices</span> = options.<span class="property">slices</span> !== <span class="literal">undefined</span> ? options.<span class="property">slices</span> : <span class="number">128</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode | Property</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.DISABLED</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = options.<span class="property">shadows</span> || <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distanceDisplayCondition: DistanceDisplayCondition | Property</span></span><br><span class="line">    <span class="comment">// 作用: 距离显示条件</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">distanceDisplayCondition</span> = options.<span class="property">distanceDisplayCondition</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> cylinderEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">50</span>),</span><br><span class="line">  <span class="attr">cylinder</span>: &#123;</span><br><span class="line">    <span class="attr">length</span>: <span class="number">100</span>, <span class="comment">// 高度100米</span></span><br><span class="line">    <span class="attr">topRadius</span>: <span class="number">30</span>, <span class="comment">// 顶部半径30米</span></span><br><span class="line">    <span class="attr">bottomRadius</span>: <span class="number">50</span>, <span class="comment">// 底部半径50米（锥形）</span></span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">GREEN</span>.<span class="title function_">withAlpha</span>(<span class="number">0.8</span>),</span><br><span class="line">    <span class="attr">outline</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">DARKGREEN</span>,</span><br><span class="line">    <span class="attr">heightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">RELATIVE_TO_GROUND</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="地形系统详解"><a href="#地形系统详解" class="headerlink" title="地形系统详解"></a>地形系统详解</h2><h3 id="TerrainProvider-地形提供者"><a href="#TerrainProvider-地形提供者" class="headerlink" title="TerrainProvider 地形提供者"></a>TerrainProvider 地形提供者</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// EllipsoidTerrainProvider - 椭球地形（离线推荐）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EllipsoidTerrainProvider</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// ellipsoid: Ellipsoid</span></span><br><span class="line">    <span class="comment">// 作用: 椭球体参数</span></span><br><span class="line">    <span class="comment">// 默认: Ellipsoid.WGS84</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ellipsoid</span> = options.<span class="property">ellipsoid</span> || <span class="title class_">Cesium</span>.<span class="property">Ellipsoid</span>.<span class="property">WGS84</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// credit: Credit | string</span></span><br><span class="line">    <span class="comment">// 作用: 版权信息</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">credit</span> = options.<span class="property">credit</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 属性</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">ready</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125; <span class="comment">// 是否就绪</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">readyPromise</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="literal">true</span>)</span><br><span class="line">  &#125; <span class="comment">// 就绪Promise</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">errorEvent</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line">  &#125; <span class="comment">// 错误事件</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">hasWaterMask</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125; <span class="comment">// 是否有水体遮罩</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">hasVertexNormals</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125; <span class="comment">// 是否有顶点法线</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">availability</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span></span><br><span class="line">  &#125; <span class="comment">// 可用性</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CesiumTerrainProvider - Cesium地形服务</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CesiumTerrainProvider</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// url: string | Resource</span></span><br><span class="line">    <span class="comment">// 作用: 地形服务URL</span></span><br><span class="line">    <span class="comment">// 必需: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">url</span> = options.<span class="property">url</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// requestWaterMask: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否请求水体遮罩</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">requestWaterMask</span> =</span><br><span class="line">      options.<span class="property">requestWaterMask</span> !== <span class="literal">undefined</span> ? options.<span class="property">requestWaterMask</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// requestVertexNormals: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否请求顶点法线</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">requestVertexNormals</span> =</span><br><span class="line">      options.<span class="property">requestVertexNormals</span> !== <span class="literal">undefined</span> ? options.<span class="property">requestVertexNormals</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ellipsoid: Ellipsoid</span></span><br><span class="line">    <span class="comment">// 作用: 椭球体</span></span><br><span class="line">    <span class="comment">// 默认: Ellipsoid.WGS84</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ellipsoid</span> = options.<span class="property">ellipsoid</span> || <span class="title class_">Cesium</span>.<span class="property">Ellipsoid</span>.<span class="property">WGS84</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// credit: Credit | string</span></span><br><span class="line">    <span class="comment">// 作用: 版权信息</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">credit</span> = options.<span class="property">credit</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// requestTileGeometry - 请求瓦片几何</span></span><br><span class="line">  <span class="comment">// x: number - X坐标</span></span><br><span class="line">  <span class="comment">// y: number - Y坐标</span></span><br><span class="line">  <span class="comment">// level: number - 级别</span></span><br><span class="line">  <span class="title function_">requestTileGeometry</span>(<span class="params">x, y, level</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回Promise&lt;TerrainData&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getLevelMaximumGeometricError - 获取级别最大几何误差</span></span><br><span class="line">  <span class="comment">// level: number - 级别</span></span><br><span class="line">  <span class="title function_">getLevelMaximumGeometricError</span>(<span class="params">level</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回几何误差值</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getTileDataAvailable - 获取瓦片数据可用性</span></span><br><span class="line">  <span class="comment">// x: number - X坐标</span></span><br><span class="line">  <span class="comment">// y: number - Y坐标</span></span><br><span class="line">  <span class="comment">// level: number - 级别</span></span><br><span class="line">  <span class="title function_">getTileDataAvailable</span>(<span class="params">x, y, level</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回boolean</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 地形采样</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sampleTerrain</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> positions = [</span><br><span class="line">    <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>),</span><br><span class="line">    <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromDegrees</span>(<span class="number">121.4737</span>, <span class="number">31.2304</span>),</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 采样地形高度</span></span><br><span class="line">  <span class="keyword">const</span> sampledPositions = <span class="keyword">await</span> <span class="title class_">Cesium</span>.<span class="title function_">sampleTerrainMostDetailed</span>(viewer.<span class="property">terrainProvider</span>, positions)</span><br><span class="line"></span><br><span class="line">  sampledPositions.<span class="title function_">forEach</span>(<span class="function">(<span class="params">position, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`位置 <span class="subst">$&#123;index&#125;</span>: 高度 <span class="subst">$&#123;position.height&#125;</span> 米`</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 地形配置示例</span></span><br><span class="line"><span class="comment">// 离线椭球地形</span></span><br><span class="line">viewer.<span class="property">terrainProvider</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">EllipsoidTerrainProvider</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cesium World Terrain（需要网络）</span></span><br><span class="line"><span class="keyword">const</span> worldTerrain = <span class="title class_">Cesium</span>.<span class="title function_">createWorldTerrain</span>(&#123;</span><br><span class="line">  <span class="attr">requestWaterMask</span>: <span class="literal">true</span>, <span class="comment">// 请求水体遮罩</span></span><br><span class="line">  <span class="attr">requestVertexNormals</span>: <span class="literal">true</span>, <span class="comment">// 请求顶点法线</span></span><br><span class="line">&#125;)</span><br><span class="line">viewer.<span class="property">terrainProvider</span> = worldTerrain</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义地形服务</span></span><br><span class="line"><span class="keyword">const</span> customTerrain = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CesiumTerrainProvider</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;http://localhost:8080/terrain/&#x27;</span>,</span><br><span class="line">  <span class="attr">requestWaterMask</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">requestVertexNormals</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;)</span><br><span class="line">viewer.<span class="property">terrainProvider</span> = customTerrain</span><br></pre></td></tr></table></figure>

<h2 id="相机系统完整属性"><a href="#相机系统完整属性" class="headerlink" title="相机系统完整属性"></a>相机系统完整属性</h2><h3 id="Camera-相机类"><a href="#Camera-相机类" class="headerlink" title="Camera 相机类"></a>Camera 相机类</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Camera - 相机类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Camera</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// position: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 相机在世界坐标系中的位置</span></span><br><span class="line">    <span class="comment">// 只读: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">position</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// direction: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 相机朝向（单位向量）</span></span><br><span class="line">    <span class="comment">// 只读: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">direction</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// up: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 相机上方向（单位向量）</span></span><br><span class="line">    <span class="comment">// 只读: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">up</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// right: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 相机右方向（单位向量）</span></span><br><span class="line">    <span class="comment">// 只读: true（由direction和up计算）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">right</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// frustum: Frustum</span></span><br><span class="line">    <span class="comment">// 作用: 视锥体（透视或正交投影）</span></span><br><span class="line">    <span class="comment">// 类型: PerspectiveFrustum | OrthographicFrustum</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">frustum</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerspectiveFrustum</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// defaultMoveAmount: number</span></span><br><span class="line">    <span class="comment">// 作用: 默认移动距离</span></span><br><span class="line">    <span class="comment">// 默认: 100000.0（米）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">defaultMoveAmount</span> = <span class="number">100000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// defaultLookAmount: number</span></span><br><span class="line">    <span class="comment">// 作用: 默认旋转角度</span></span><br><span class="line">    <span class="comment">// 默认: Math.PI / 60（弧度）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">defaultLookAmount</span> = <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">60</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// defaultRotateAmount: number</span></span><br><span class="line">    <span class="comment">// 作用: 默认旋转角度</span></span><br><span class="line">    <span class="comment">// 默认: Math.PI / 3600（弧度）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">defaultRotateAmount</span> = <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">3600</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// defaultZoomAmount: number</span></span><br><span class="line">    <span class="comment">// 作用: 默认缩放距离</span></span><br><span class="line">    <span class="comment">// 默认: 100000.0（米）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">defaultZoomAmount</span> = <span class="number">100000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// constrainedAxis: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 约束轴（限制相机旋转）</span></span><br><span class="line">    <span class="comment">// 默认: undefined（无约束）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">constrainedAxis</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumZoomFactor: number</span></span><br><span class="line">    <span class="comment">// 作用: 最大缩放因子</span></span><br><span class="line">    <span class="comment">// 默认: 1.5</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maximumZoomFactor</span> = <span class="number">1.5</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 事件 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveStart: Event</span></span><br><span class="line">  <span class="comment">// 作用: 相机开始移动事件</span></span><br><span class="line">  <span class="comment">// 触发: 相机开始移动时</span></span><br><span class="line">  moveStart = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveEnd: Event</span></span><br><span class="line">  <span class="comment">// 作用: 相机停止移动事件</span></span><br><span class="line">  <span class="comment">// 触发: 相机停止移动时</span></span><br><span class="line">  moveEnd = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// changed: Event</span></span><br><span class="line">  <span class="comment">// 作用: 相机变化事件</span></span><br><span class="line">  <span class="comment">// 触发: 相机位置、方向或视锥体变化时</span></span><br><span class="line">  changed = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 位置设置方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// setView - 设置视图</span></span><br><span class="line">  <span class="title function_">setView</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// destination: Cartesian3 | Rectangle</span></span><br><span class="line">    <span class="comment">// 作用: 目标位置或区域</span></span><br><span class="line">    <span class="keyword">const</span> destination = options.<span class="property">destination</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// orientation: Object</span></span><br><span class="line">    <span class="comment">// 作用: 相机方向</span></span><br><span class="line">    <span class="comment">// heading: number - 航向角（弧度）</span></span><br><span class="line">    <span class="comment">// pitch: number - 俯仰角（弧度）</span></span><br><span class="line">    <span class="comment">// roll: number - 翻滚角（弧度）</span></span><br><span class="line">    <span class="keyword">const</span> orientation = options.<span class="property">orientation</span> || &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endTransform: Matrix4</span></span><br><span class="line">    <span class="comment">// 作用: 结束变换矩阵</span></span><br><span class="line">    <span class="keyword">const</span> endTransform = options.<span class="property">endTransform</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// flyTo - 飞行到目标</span></span><br><span class="line">  <span class="title function_">flyTo</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// destination: Cartesian3 | Rectangle</span></span><br><span class="line">    <span class="comment">// 作用: 目标位置</span></span><br><span class="line">    <span class="keyword">const</span> destination = options.<span class="property">destination</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// orientation: Object</span></span><br><span class="line">    <span class="comment">// 作用: 目标方向</span></span><br><span class="line">    <span class="keyword">const</span> orientation = options.<span class="property">orientation</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// duration: number</span></span><br><span class="line">    <span class="comment">// 作用: 飞行时间（秒）</span></span><br><span class="line">    <span class="comment">// 默认: 自动计算</span></span><br><span class="line">    <span class="keyword">const</span> duration = options.<span class="property">duration</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// complete: function</span></span><br><span class="line">    <span class="comment">// 作用: 完成回调</span></span><br><span class="line">    <span class="keyword">const</span> complete = options.<span class="property">complete</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// cancel: function</span></span><br><span class="line">    <span class="comment">// 作用: 取消回调</span></span><br><span class="line">    <span class="keyword">const</span> cancel = options.<span class="property">cancel</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// endTransform: Matrix4</span></span><br><span class="line">    <span class="comment">// 作用: 结束变换矩阵</span></span><br><span class="line">    <span class="keyword">const</span> endTransform = options.<span class="property">endTransform</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumHeight: number</span></span><br><span class="line">    <span class="comment">// 作用: 飞行最大高度</span></span><br><span class="line">    <span class="keyword">const</span> maximumHeight = options.<span class="property">maximumHeight</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pitchAdjustHeight: number</span></span><br><span class="line">    <span class="comment">// 作用: 俯仰角调整高度</span></span><br><span class="line">    <span class="keyword">const</span> pitchAdjustHeight = options.<span class="property">pitchAdjustHeight</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// flyOverLongitude: number</span></span><br><span class="line">    <span class="comment">// 作用: 飞越经度</span></span><br><span class="line">    <span class="keyword">const</span> flyOverLongitude = options.<span class="property">flyOverLongitude</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// flyOverLongitudeWeight: number</span></span><br><span class="line">    <span class="comment">// 作用: 飞越经度权重</span></span><br><span class="line">    <span class="keyword">const</span> flyOverLongitudeWeight = options.<span class="property">flyOverLongitudeWeight</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// convert: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否转换坐标</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="keyword">const</span> convert = options.<span class="property">convert</span> !== <span class="literal">undefined</span> ? options.<span class="property">convert</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// easingFunction: EasingFunction</span></span><br><span class="line">    <span class="comment">// 作用: 缓动函数</span></span><br><span class="line">    <span class="keyword">const</span> easingFunction = options.<span class="property">easingFunction</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// lookAt - 看向目标</span></span><br><span class="line">  <span class="title function_">lookAt</span>(<span class="params">target, offset</span>) &#123;</span><br><span class="line">    <span class="comment">// target: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 目标位置</span></span><br><span class="line">    <span class="comment">// offset: Cartesian3 | HeadingPitchRange</span></span><br><span class="line">    <span class="comment">// 作用: 偏移量或方向距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// lookAtTransform - 应用变换后看向目标</span></span><br><span class="line">  <span class="title function_">lookAtTransform</span>(<span class="params">transform, offset</span>) &#123;</span><br><span class="line">    <span class="comment">// transform: Matrix4</span></span><br><span class="line">    <span class="comment">// 作用: 变换矩阵</span></span><br><span class="line">    <span class="comment">// offset: Cartesian3 | HeadingPitchRange</span></span><br><span class="line">    <span class="comment">// 作用: 偏移量</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 移动方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// move - 移动相机</span></span><br><span class="line">  <span class="title function_">move</span>(<span class="params">direction, amount</span>) &#123;</span><br><span class="line">    <span class="comment">// direction: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 移动方向（单位向量）</span></span><br><span class="line">    <span class="comment">// amount: number</span></span><br><span class="line">    <span class="comment">// 作用: 移动距离（米）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveForward - 向前移动</span></span><br><span class="line">  <span class="title function_">moveForward</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultMoveAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 移动距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveBackward - 向后移动</span></span><br><span class="line">  <span class="title function_">moveBackward</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultMoveAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 移动距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveUp - 向上移动</span></span><br><span class="line">  <span class="title function_">moveUp</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultMoveAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 移动距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveDown - 向下移动</span></span><br><span class="line">  <span class="title function_">moveDown</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultMoveAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 移动距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveLeft - 向左移动</span></span><br><span class="line">  <span class="title function_">moveLeft</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultMoveAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 移动距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// moveRight - 向右移动</span></span><br><span class="line">  <span class="title function_">moveRight</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultMoveAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 移动距离</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 旋转方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// look - 旋转相机</span></span><br><span class="line">  <span class="title function_">look</span>(<span class="params">axis, angle</span>) &#123;</span><br><span class="line">    <span class="comment">// axis: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 旋转轴</span></span><br><span class="line">    <span class="comment">// angle: number</span></span><br><span class="line">    <span class="comment">// 作用: 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// lookLeft - 向左看</span></span><br><span class="line">  <span class="title function_">lookLeft</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultLookAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// lookRight - 向右看</span></span><br><span class="line">  <span class="title function_">lookRight</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultLookAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// lookUp - 向上看</span></span><br><span class="line">  <span class="title function_">lookUp</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultLookAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// lookDown - 向下看</span></span><br><span class="line">  <span class="title function_">lookDown</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultLookAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rotate - 绕点旋转</span></span><br><span class="line">  <span class="title function_">rotate</span>(<span class="params">axis, angle</span>) &#123;</span><br><span class="line">    <span class="comment">// axis: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 旋转轴</span></span><br><span class="line">    <span class="comment">// angle: number</span></span><br><span class="line">    <span class="comment">// 作用: 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rotateLeft - 向左旋转</span></span><br><span class="line">  <span class="title function_">rotateLeft</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultRotateAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rotateRight - 向右旋转</span></span><br><span class="line">  <span class="title function_">rotateRight</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultRotateAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rotateUp - 向上旋转</span></span><br><span class="line">  <span class="title function_">rotateUp</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultRotateAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rotateDown - 向下旋转</span></span><br><span class="line">  <span class="title function_">rotateDown</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultRotateAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 旋转角度（弧度）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 缩放方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// zoomIn - 放大</span></span><br><span class="line">  <span class="title function_">zoomIn</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultZoomAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 缩放距离（米）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// zoomOut - 缩小</span></span><br><span class="line">  <span class="title function_">zoomOut</span>(<span class="params">amount = <span class="variable language_">this</span>.defaultZoomAmount</span>) &#123;</span><br><span class="line">    <span class="comment">// amount: number - 缩放距离（米）</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 坐标转换方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// pickEllipsoid - 拾取椭球面</span></span><br><span class="line">  <span class="title function_">pickEllipsoid</span>(<span class="params">windowPosition, ellipsoid = Cesium.Ellipsoid.WGS84</span>) &#123;</span><br><span class="line">    <span class="comment">// windowPosition: Cartesian2</span></span><br><span class="line">    <span class="comment">// 作用: 屏幕坐标</span></span><br><span class="line">    <span class="comment">// ellipsoid: Ellipsoid</span></span><br><span class="line">    <span class="comment">// 作用: 椭球体</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian3 | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getPickRay - 获取拾取射线</span></span><br><span class="line">  <span class="title function_">getPickRay</span>(<span class="params">windowPosition</span>) &#123;</span><br><span class="line">    <span class="comment">// windowPosition: Cartesian2</span></span><br><span class="line">    <span class="comment">// 作用: 屏幕坐标</span></span><br><span class="line">    <span class="comment">// 返回: Ray</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// worldToCameraCoordinates - 世界坐标转相机坐标</span></span><br><span class="line">  <span class="title function_">worldToCameraCoordinates</span>(<span class="params">cartesian, result</span>) &#123;</span><br><span class="line">    <span class="comment">// cartesian: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 世界坐标</span></span><br><span class="line">    <span class="comment">// result: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// cameraToWorldCoordinates - 相机坐标转世界坐标</span></span><br><span class="line">  <span class="title function_">cameraToWorldCoordinates</span>(<span class="params">cartesian, result</span>) &#123;</span><br><span class="line">    <span class="comment">// cartesian: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 相机坐标</span></span><br><span class="line">    <span class="comment">// result: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 计算属性 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// heading: number</span></span><br><span class="line">  <span class="comment">// 作用: 航向角（弧度）</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">heading</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="property">TWO_PI</span> - <span class="title class_">Math</span>.<span class="title function_">atan2</span>(<span class="variable language_">this</span>.<span class="property">right</span>.<span class="property">y</span>, <span class="variable language_">this</span>.<span class="property">right</span>.<span class="property">x</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// pitch: number</span></span><br><span class="line">  <span class="comment">// 作用: 俯仰角（弧度）</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">pitch</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">asin</span>(<span class="variable language_">this</span>.<span class="property">direction</span>.<span class="property">z</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// roll: number</span></span><br><span class="line">  <span class="comment">// 作用: 翻滚角（弧度）</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">roll</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">atan2</span>(-<span class="variable language_">this</span>.<span class="property">up</span>.<span class="property">x</span>, <span class="variable language_">this</span>.<span class="property">up</span>.<span class="property">z</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// positionCartographic: Cartographic</span></span><br><span class="line">  <span class="comment">// 作用: 地理坐标位置</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">positionCartographic</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(<span class="variable language_">this</span>.<span class="property">position</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相机使用示例</span></span><br><span class="line"><span class="keyword">const</span> camera = viewer.<span class="property">camera</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置相机位置</span></span><br><span class="line">camera.<span class="title function_">setView</span>(&#123;</span><br><span class="line">  <span class="attr">destination</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">1000</span>),</span><br><span class="line">  <span class="attr">orientation</span>: &#123;</span><br><span class="line">    <span class="attr">heading</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(<span class="number">0</span>), <span class="comment">// 正北方向</span></span><br><span class="line">    <span class="attr">pitch</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(-<span class="number">45</span>), <span class="comment">// 向下45度</span></span><br><span class="line">    <span class="attr">roll</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toRadians</span>(<span class="number">0</span>), <span class="comment">// 无翻滚</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 飞行到位置</span></span><br><span class="line">camera.<span class="title function_">flyTo</span>(&#123;</span><br><span class="line">  <span class="attr">destination</span>: <span class="title class_">Cesium</span>.<span class="property">Rectangle</span>.<span class="title function_">fromDegrees</span>(<span class="number">115</span>, <span class="number">39</span>, <span class="number">117</span>, <span class="number">41</span>),</span><br><span class="line">  <span class="attr">duration</span>: <span class="number">3.0</span>,</span><br><span class="line">  <span class="attr">complete</span>: <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;飞行完成&#x27;</span>),</span><br><span class="line">  <span class="attr">cancel</span>: <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;飞行取消&#x27;</span>),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相机事件监听</span></span><br><span class="line">camera.<span class="property">moveStart</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;相机开始移动&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">camera.<span class="property">moveEnd</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;相机停止移动&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">camera.<span class="property">changed</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;相机发生变化&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相机控制</span></span><br><span class="line">camera.<span class="title function_">moveForward</span>(<span class="number">1000</span>) <span class="comment">// 向前移动1000米</span></span><br><span class="line">camera.<span class="title function_">lookLeft</span>(<span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">4</span>) <span class="comment">// 向左看45度</span></span><br><span class="line">camera.<span class="title function_">zoomIn</span>(<span class="number">500</span>) <span class="comment">// 放大500米</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取相机信息</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;相机位置:&#x27;</span>, camera.<span class="property">position</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;相机方向:&#x27;</span>, camera.<span class="property">direction</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;航向角:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(camera.<span class="property">heading</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;俯仰角:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(camera.<span class="property">pitch</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;翻滚角:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(camera.<span class="property">roll</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 坐标转换</span></span><br><span class="line"><span class="keyword">const</span> screenPos = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">const</span> worldPos = camera.<span class="title function_">pickEllipsoid</span>(screenPos)</span><br><span class="line"><span class="keyword">if</span> (worldPos) &#123;</span><br><span class="line">  <span class="keyword">const</span> cartographic = <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(worldPos)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击位置:&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">longitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(cartographic.<span class="property">longitude</span>),</span><br><span class="line">    <span class="attr">latitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(cartographic.<span class="property">latitude</span>),</span><br><span class="line">    <span class="attr">height</span>: cartographic.<span class="property">height</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="事件系统详解"><a href="#事件系统详解" class="headerlink" title="事件系统详解"></a>事件系统详解</h2><h3 id="ScreenSpaceEventHandler-屏幕空间事件处理器"><a href="#ScreenSpaceEventHandler-屏幕空间事件处理器" class="headerlink" title="ScreenSpaceEventHandler 屏幕空间事件处理器"></a>ScreenSpaceEventHandler 屏幕空间事件处理器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ScreenSpaceEventHandler - 屏幕空间事件处理器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ScreenSpaceEventHandler</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">canvas</span>) &#123;</span><br><span class="line">    <span class="comment">// canvas: HTMLCanvasElement</span></span><br><span class="line">    <span class="comment">// 作用: 事件监听的画布元素</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvas</span> = canvas</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// setInputAction - 设置输入动作</span></span><br><span class="line">  <span class="title function_">setInputAction</span>(<span class="params">action, type, modifier</span>) &#123;</span><br><span class="line">    <span class="comment">// action: function</span></span><br><span class="line">    <span class="comment">// 作用: 事件处理函数</span></span><br><span class="line">    <span class="comment">// 参数: event对象，包含position等信息</span></span><br><span class="line">    <span class="comment">// type: ScreenSpaceEventType</span></span><br><span class="line">    <span class="comment">// 作用: 事件类型</span></span><br><span class="line">    <span class="comment">// 选项: LEFT_CLICK, LEFT_DOUBLE_CLICK, LEFT_DOWN, LEFT_UP,</span></span><br><span class="line">    <span class="comment">//       RIGHT_CLICK, RIGHT_DOWN, RIGHT_UP,</span></span><br><span class="line">    <span class="comment">//       MIDDLE_CLICK, MIDDLE_DOWN, MIDDLE_UP,</span></span><br><span class="line">    <span class="comment">//       MOUSE_MOVE, WHEEL, PINCH_START, PINCH_END, PINCH_MOVE</span></span><br><span class="line">    <span class="comment">// modifier: KeyboardEventModifier (可选)</span></span><br><span class="line">    <span class="comment">// 作用: 键盘修饰符</span></span><br><span class="line">    <span class="comment">// 选项: SHIFT, CTRL, ALT</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getInputAction - 获取输入动作</span></span><br><span class="line">  <span class="title function_">getInputAction</span>(<span class="params">type, modifier</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回: function | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// removeInputAction - 移除输入动作</span></span><br><span class="line">  <span class="title function_">removeInputAction</span>(<span class="params">type, modifier</span>) &#123;</span><br><span class="line">    <span class="comment">// 移除指定类型的事件处理</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// isDestroyed - 是否已销毁</span></span><br><span class="line">  <span class="title function_">isDestroyed</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_isDestroyed</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// destroy - 销毁处理器</span></span><br><span class="line">  <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 清理所有事件监听</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 事件类型详解</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ScreenSpaceEventType</span> = &#123;</span><br><span class="line">  <span class="comment">// 鼠标点击事件</span></span><br><span class="line">  <span class="attr">LEFT_CLICK</span>: <span class="number">0</span>, <span class="comment">// 左键单击</span></span><br><span class="line">  <span class="attr">LEFT_DOUBLE_CLICK</span>: <span class="number">1</span>, <span class="comment">// 左键双击</span></span><br><span class="line">  <span class="attr">LEFT_DOWN</span>: <span class="number">2</span>, <span class="comment">// 左键按下</span></span><br><span class="line">  <span class="attr">LEFT_UP</span>: <span class="number">3</span>, <span class="comment">// 左键抬起</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">RIGHT_CLICK</span>: <span class="number">5</span>, <span class="comment">// 右键单击</span></span><br><span class="line">  <span class="attr">RIGHT_DOWN</span>: <span class="number">6</span>, <span class="comment">// 右键按下</span></span><br><span class="line">  <span class="attr">RIGHT_UP</span>: <span class="number">7</span>, <span class="comment">// 右键抬起</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">MIDDLE_CLICK</span>: <span class="number">10</span>, <span class="comment">// 中键单击</span></span><br><span class="line">  <span class="attr">MIDDLE_DOWN</span>: <span class="number">11</span>, <span class="comment">// 中键按下</span></span><br><span class="line">  <span class="attr">MIDDLE_UP</span>: <span class="number">12</span>, <span class="comment">// 中键抬起</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 鼠标移动和滚轮</span></span><br><span class="line">  <span class="attr">MOUSE_MOVE</span>: <span class="number">15</span>, <span class="comment">// 鼠标移动</span></span><br><span class="line">  <span class="attr">WHEEL</span>: <span class="number">16</span>, <span class="comment">// 滚轮滚动</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 触摸事件</span></span><br><span class="line">  <span class="attr">PINCH_START</span>: <span class="number">17</span>, <span class="comment">// 捏合开始</span></span><br><span class="line">  <span class="attr">PINCH_END</span>: <span class="number">18</span>, <span class="comment">// 捏合结束</span></span><br><span class="line">  <span class="attr">PINCH_MOVE</span>: <span class="number">19</span>, <span class="comment">// 捏合移动</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 键盘修饰符</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">KeyboardEventModifier</span> = &#123;</span><br><span class="line">  <span class="attr">SHIFT</span>: <span class="number">0</span>, <span class="comment">// Shift键</span></span><br><span class="line">  <span class="attr">CTRL</span>: <span class="number">1</span>, <span class="comment">// Ctrl键</span></span><br><span class="line">  <span class="attr">ALT</span>: <span class="number">2</span>, <span class="comment">// Alt键</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 事件处理示例</span></span><br><span class="line"><span class="keyword">const</span> handler = viewer.<span class="property">cesiumWidget</span>.<span class="property">screenSpaceEventHandler</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 左键点击事件</span></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> position = event.<span class="property">position</span> <span class="comment">// Cartesian2屏幕坐标</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拾取对象</span></span><br><span class="line">  <span class="keyword">const</span> pickedObject = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(position)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Cesium</span>.<span class="title function_">defined</span>(pickedObject)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了对象:&#x27;</span>, pickedObject.<span class="property">id</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 选中实体</span></span><br><span class="line">    viewer.<span class="property">selectedEntity</span> = pickedObject.<span class="property">id</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 拾取地面位置</span></span><br><span class="line">    <span class="keyword">const</span> cartesian = viewer.<span class="property">camera</span>.<span class="title function_">pickEllipsoid</span>(position, viewer.<span class="property">scene</span>.<span class="property">globe</span>.<span class="property">ellipsoid</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cartesian) &#123;</span><br><span class="line">      <span class="keyword">const</span> cartographic = <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(cartesian)</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击地面位置:&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">longitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(cartographic.<span class="property">longitude</span>),</span><br><span class="line">        <span class="attr">latitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(cartographic.<span class="property">latitude</span>),</span><br><span class="line">        <span class="attr">height</span>: cartographic.<span class="property">height</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 右键点击事件</span></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> position = event.<span class="property">position</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 显示上下文菜单</span></span><br><span class="line">  <span class="title function_">showContextMenu</span>(position)</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">RIGHT_CLICK</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 鼠标移动事件</span></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> startPosition = event.<span class="property">startPosition</span> <span class="comment">// 开始位置</span></span><br><span class="line">  <span class="keyword">const</span> endPosition = event.<span class="property">endPosition</span> <span class="comment">// 结束位置</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拾取悬停对象</span></span><br><span class="line">  <span class="keyword">const</span> pickedObject = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(endPosition)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Cesium</span>.<span class="title function_">defined</span>(pickedObject)) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;pointer&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 显示工具提示</span></span><br><span class="line">    <span class="title function_">showTooltip</span>(endPosition, pickedObject.<span class="property">id</span>.<span class="property">name</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;default&#x27;</span></span><br><span class="line">    <span class="title function_">hideTooltip</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">MOUSE_MOVE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 滚轮事件</span></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> delta = event <span class="comment">// 滚轮增量</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;滚轮滚动:&#x27;</span>, delta)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义缩放逻辑</span></span><br><span class="line">  <span class="keyword">if</span> (delta &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    viewer.<span class="property">camera</span>.<span class="title function_">zoomIn</span>(viewer.<span class="property">camera</span>.<span class="property">defaultZoomAmount</span> * <span class="number">0.5</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    viewer.<span class="property">camera</span>.<span class="title function_">zoomOut</span>(viewer.<span class="property">camera</span>.<span class="property">defaultZoomAmount</span> * <span class="number">0.5</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">WHEEL</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 左键拖拽事件</span></span><br><span class="line"><span class="keyword">let</span> isDragging = <span class="literal">false</span></span><br><span class="line"><span class="keyword">let</span> startPosition</span><br><span class="line"></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  isDragging = <span class="literal">true</span></span><br><span class="line">  startPosition = event.<span class="property">position</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 禁用默认相机控制</span></span><br><span class="line">  viewer.<span class="property">scene</span>.<span class="property">screenSpaceCameraController</span>.<span class="property">enableRotate</span> = <span class="literal">false</span></span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_DOWN</span>)</span><br><span class="line"></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isDragging) &#123;</span><br><span class="line">    <span class="keyword">const</span> endPosition = event.<span class="property">endPosition</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算拖拽距离</span></span><br><span class="line">    <span class="keyword">const</span> deltaX = endPosition.<span class="property">x</span> - startPosition.<span class="property">x</span></span><br><span class="line">    <span class="keyword">const</span> deltaY = endPosition.<span class="property">y</span> - startPosition.<span class="property">y</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;拖拽距离:&#x27;</span>, &#123; deltaX, deltaY &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 自定义拖拽逻辑</span></span><br><span class="line">    <span class="title function_">customDragLogic</span>(deltaX, deltaY)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">MOUSE_MOVE</span>)</span><br><span class="line"></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  isDragging = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 恢复默认相机控制</span></span><br><span class="line">  viewer.<span class="property">scene</span>.<span class="property">screenSpaceCameraController</span>.<span class="property">enableRotate</span> = <span class="literal">true</span></span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_UP</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 带修饰符的事件</span></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(</span><br><span class="line">  <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Ctrl + 左键点击&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 多选模式</span></span><br><span class="line">    <span class="title function_">toggleEntitySelection</span>(event.<span class="property">position</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>,</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">KeyboardEventModifier</span>.<span class="property">CTRL</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(</span><br><span class="line">  <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Shift + 左键点击&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 框选模式</span></span><br><span class="line">    <span class="title function_">startBoxSelection</span>(event.<span class="property">position</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>,</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">KeyboardEventModifier</span>.<span class="property">SHIFT</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触摸事件（移动设备）</span></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> position1 = event.<span class="property">position1</span> <span class="comment">// 第一个触摸点</span></span><br><span class="line">  <span class="keyword">const</span> position2 = event.<span class="property">position2</span> <span class="comment">// 第二个触摸点</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;开始捏合手势&#x27;</span>)</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">PINCH_START</span>)</span><br><span class="line"></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> position1 = event.<span class="property">position1</span></span><br><span class="line">  <span class="keyword">const</span> position2 = event.<span class="property">position2</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计算缩放比例</span></span><br><span class="line">  <span class="keyword">const</span> distance = <span class="title class_">Cesium</span>.<span class="property">Cartesian2</span>.<span class="title function_">distance</span>(position1, position2)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;捏合距离:&#x27;</span>, distance)</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">PINCH_MOVE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义工具提示</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showTooltip</span>(<span class="params">position, text</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> tooltip = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tooltip&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (!tooltip) &#123;</span><br><span class="line">    <span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    div.<span class="property">id</span> = <span class="string">&#x27;tooltip&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;absolute&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">background</span> = <span class="string">&#x27;rgba(0,0,0,0.8)&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;white&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;5px&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">borderRadius</span> = <span class="string">&#x27;3px&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">pointerEvents</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">zIndex</span> = <span class="string">&#x27;1000&#x27;</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(div)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> tooltip = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tooltip&#x27;</span>)</span><br><span class="line">  tooltip.<span class="property">textContent</span> = text</span><br><span class="line">  tooltip.<span class="property">style</span>.<span class="property">left</span> = position.<span class="property">x</span> + <span class="number">10</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">  tooltip.<span class="property">style</span>.<span class="property">top</span> = position.<span class="property">y</span> - <span class="number">30</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">  tooltip.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hideTooltip</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> tooltip = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tooltip&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (tooltip) &#123;</span><br><span class="line">    tooltip.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除事件处理</span></span><br><span class="line">handler.<span class="title function_">removeInputAction</span>(<span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>)</span><br><span class="line">handler.<span class="title function_">removeInputAction</span>(<span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>, <span class="title class_">Cesium</span>.<span class="property">KeyboardEventModifier</span>.<span class="property">CTRL</span>)</span><br></pre></td></tr></table></figure>

<h2 id="材质系统详解"><a href="#材质系统详解" class="headerlink" title="材质系统详解"></a>材质系统详解</h2><h3 id="Material-材质类"><a href="#Material-材质类" class="headerlink" title="Material 材质类"></a>Material 材质类</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Material - 材质基类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Material</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// fabric: Object</span></span><br><span class="line">    <span class="comment">// 作用: 材质描述对象</span></span><br><span class="line">    <span class="comment">// 包含: type, uniforms, source等</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fabric</span> = options.<span class="property">fabric</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// translucent: boolean | function</span></span><br><span class="line">    <span class="comment">// 作用: 是否透明</span></span><br><span class="line">    <span class="comment">// 默认: 根据材质类型确定</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">translucent</span> = options.<span class="property">translucent</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromType - 从类型创建材质</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromType</span>(<span class="params">type, uniforms</span>) &#123;</span><br><span class="line">    <span class="comment">// type: string - 材质类型</span></span><br><span class="line">    <span class="comment">// uniforms: Object - 材质参数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Material</span>(&#123;</span><br><span class="line">      <span class="attr">fabric</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: type,</span><br><span class="line">        <span class="attr">uniforms</span>: uniforms,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 内置材质类型</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">ColorType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Color&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 纯色</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">ImageType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Image&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 图片</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">DiffuseMapType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;DiffuseMap&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 漫反射贴图</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">AlphaMapType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;AlphaMap&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 透明贴图</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">SpecularMapType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;SpecularMap&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 镜面贴图</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">EmissionMapType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;EmissionMap&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 发射贴图</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">BumpMapType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;BumpMap&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 凹凸贴图</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">NormalMapType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;NormalMap&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 法线贴图</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">GridType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Grid&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 网格</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">StripeType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Stripe&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 条纹</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">CheckerboardType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Checkerboard&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 棋盘</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">DotType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Dot&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 点</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">WaterType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Water&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 水面</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">RimLightingType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;RimLighting&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 边缘光照</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">FadeType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Fade&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 渐变</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">PolylineArrowType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;PolylineArrow&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 箭头线</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">PolylineGlowType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;PolylineGlow&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 发光线</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">PolylineOutlineType</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;PolylineOutline&#x27;</span></span><br><span class="line">  &#125; <span class="comment">// 轮廓线</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 颜色材质</span></span><br><span class="line"><span class="keyword">const</span> colorMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ColorMaterialProperty</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 图片材质</span></span><br><span class="line"><span class="keyword">const</span> imageMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ImageMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">image</span>: <span class="string">&#x27;path/to/texture.jpg&#x27;</span>, <span class="comment">// 图片路径</span></span><br><span class="line">  <span class="attr">repeat</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">2.0</span>, <span class="number">2.0</span>), <span class="comment">// 重复次数</span></span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>, <span class="comment">// 混合颜色</span></span><br><span class="line">  <span class="attr">transparent</span>: <span class="literal">false</span>, <span class="comment">// 是否透明</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 网格材质</span></span><br><span class="line"><span class="keyword">const</span> gridMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GridMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>, <span class="comment">// 网格颜色</span></span><br><span class="line">  <span class="attr">cellAlpha</span>: <span class="number">0.1</span>, <span class="comment">// 单元格透明度</span></span><br><span class="line">  <span class="attr">lineCount</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">8</span>, <span class="number">8</span>), <span class="comment">// 网格数量</span></span><br><span class="line">  <span class="attr">lineThickness</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">2.0</span>, <span class="number">2.0</span>), <span class="comment">// 线条粗细</span></span><br><span class="line">  <span class="attr">lineOffset</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">0.5</span>, <span class="number">0.5</span>), <span class="comment">// 线条偏移</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 条纹材质</span></span><br><span class="line"><span class="keyword">const</span> stripeMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">StripeMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">evenColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>, <span class="comment">// 偶数条纹颜色</span></span><br><span class="line">  <span class="attr">oddColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>, <span class="comment">// 奇数条纹颜色</span></span><br><span class="line">  <span class="attr">repeat</span>: <span class="number">16.0</span>, <span class="comment">// 条纹数量</span></span><br><span class="line">  <span class="attr">offset</span>: <span class="number">0.0</span>, <span class="comment">// 偏移量</span></span><br><span class="line">  <span class="attr">orientation</span>: <span class="title class_">Cesium</span>.<span class="property">StripeOrientation</span>.<span class="property">HORIZONTAL</span>, <span class="comment">// 方向</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 棋盘材质</span></span><br><span class="line"><span class="keyword">const</span> checkerboardMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CheckerboardMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">evenColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>, <span class="comment">// 偶数格颜色</span></span><br><span class="line">  <span class="attr">oddColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>, <span class="comment">// 奇数格颜色</span></span><br><span class="line">  <span class="attr">repeat</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">4.0</span>, <span class="number">4.0</span>), <span class="comment">// 重复次数</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点材质</span></span><br><span class="line"><span class="keyword">const</span> dotMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">DotMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>, <span class="comment">// 点颜色</span></span><br><span class="line">  <span class="attr">repeat</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">16.0</span>, <span class="number">16.0</span>), <span class="comment">// 点的重复次数</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 水面材质</span></span><br><span class="line"><span class="keyword">const</span> waterMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">WaterMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">baseWaterColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">AQUA</span>, <span class="comment">// 基础水色</span></span><br><span class="line">  <span class="attr">blendColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>, <span class="comment">// 混合颜色</span></span><br><span class="line">  <span class="attr">specularMap</span>: <span class="string">&#x27;path/to/specular.jpg&#x27;</span>, <span class="comment">// 镜面贴图</span></span><br><span class="line">  <span class="attr">normalMap</span>: <span class="string">&#x27;path/to/normal.jpg&#x27;</span>, <span class="comment">// 法线贴图</span></span><br><span class="line">  <span class="attr">frequency</span>: <span class="number">10.0</span>, <span class="comment">// 波浪频率</span></span><br><span class="line">  <span class="attr">animationSpeed</span>: <span class="number">0.01</span>, <span class="comment">// 动画速度</span></span><br><span class="line">  <span class="attr">amplitude</span>: <span class="number">1.0</span>, <span class="comment">// 波幅</span></span><br><span class="line">  <span class="attr">specularIntensity</span>: <span class="number">0.5</span>, <span class="comment">// 镜面强度</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 边缘光照材质</span></span><br><span class="line"><span class="keyword">const</span> rimLightingMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">RimLightingMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">LIME</span>, <span class="comment">// 边缘颜色</span></span><br><span class="line">  <span class="attr">rimColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>, <span class="comment">// 边缘光颜色</span></span><br><span class="line">  <span class="attr">alpha</span>: <span class="number">1.0</span>, <span class="comment">// 透明度</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 渐变材质</span></span><br><span class="line"><span class="keyword">const</span> fadeMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">FadeMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">fadeInColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>, <span class="comment">// 渐入颜色</span></span><br><span class="line">  <span class="attr">fadeOutColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>, <span class="comment">// 渐出颜色</span></span><br><span class="line">  <span class="attr">maximumDistance</span>: <span class="number">500000.0</span>, <span class="comment">// 最大距离</span></span><br><span class="line">  <span class="attr">repeat</span>: <span class="literal">true</span>, <span class="comment">// 是否重复</span></span><br><span class="line">  <span class="attr">fadeDirection</span>: &#123;</span><br><span class="line">    <span class="comment">// 渐变方向</span></span><br><span class="line">    <span class="attr">x</span>: <span class="number">1.0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0.0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多段线材质</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 箭头线材质</span></span><br><span class="line"><span class="keyword">const</span> arrowMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineArrowMaterialProperty</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发光线材质</span></span><br><span class="line"><span class="keyword">const</span> glowMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineGlowMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">glowPower</span>: <span class="number">0.2</span>, <span class="comment">// 发光强度</span></span><br><span class="line">  <span class="attr">taperPower</span>: <span class="number">0.5</span>, <span class="comment">// 锥形强度</span></span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>, <span class="comment">// 颜色</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 虚线材质</span></span><br><span class="line"><span class="keyword">const</span> dashMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineDashMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">CYAN</span>, <span class="comment">// 颜色</span></span><br><span class="line">  <span class="attr">gapColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">TRANSPARENT</span>, <span class="comment">// 间隙颜色</span></span><br><span class="line">  <span class="attr">dashLength</span>: <span class="number">16.0</span>, <span class="comment">// 虚线长度</span></span><br><span class="line">  <span class="attr">dashPattern</span>: <span class="number">255</span>, <span class="comment">// 虚线模式（二进制）</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 轮廓线材质</span></span><br><span class="line"><span class="keyword">const</span> outlineMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineOutlineMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">ORANGE</span>, <span class="comment">// 内部颜色</span></span><br><span class="line">  <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>, <span class="comment">// 轮廓颜色</span></span><br><span class="line">  <span class="attr">outlineWidth</span>: <span class="number">2.0</span>, <span class="comment">// 轮廓宽度</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义着色器材质</span></span><br><span class="line"><span class="keyword">const</span> customMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Material</span>(&#123;</span><br><span class="line">  <span class="attr">fabric</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;CustomShader&#x27;</span>,</span><br><span class="line">    <span class="attr">uniforms</span>: &#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Color</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>),</span><br><span class="line">      <span class="attr">time</span>: <span class="number">0.0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">source</span>: <span class="string">`</span></span><br><span class="line"><span class="string">      uniform vec4 color;</span></span><br><span class="line"><span class="string">      uniform float time;</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">      czm_material czm_getMaterial(czm_materialInput materialInput) &#123;</span></span><br><span class="line"><span class="string">        czm_material material = czm_getDefaultMaterial(materialInput);</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        vec2 st = materialInput.st;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        // 动画波纹效果</span></span><br><span class="line"><span class="string">        float wave = sin(st.s * 10.0 + time) * 0.5 + 0.5;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        material.diffuse = color.rgb * wave;</span></span><br><span class="line"><span class="string">        material.alpha = color.a;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        return material;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    `</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用材质到实体</span></span><br><span class="line"><span class="keyword">const</span> entity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">rectangle</span>: &#123;</span><br><span class="line">    <span class="attr">coordinates</span>: <span class="title class_">Cesium</span>.<span class="property">Rectangle</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.0</span>, <span class="number">39.0</span>, <span class="number">117.0</span>, <span class="number">40.0</span>),</span><br><span class="line">    <span class="attr">material</span>: imageMaterial, <span class="comment">// 应用图片材质</span></span><br><span class="line">    <span class="attr">height</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动态改变材质</span></span><br><span class="line">entity.<span class="property">rectangle</span>.<span class="property">material</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CallbackProperty</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 根据时间变化返回不同材质</span></span><br><span class="line">  <span class="keyword">const</span> time = viewer.<span class="property">clock</span>.<span class="property">currentTime</span></span><br><span class="line">  <span class="keyword">const</span> seconds = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(time, viewer.<span class="property">clock</span>.<span class="property">startTime</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (seconds % <span class="number">4</span> &lt; <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

<h2 id="动画系统详解"><a href="#动画系统详解" class="headerlink" title="动画系统详解"></a>动画系统详解</h2><h3 id="Animation-动画"><a href="#Animation-动画" class="headerlink" title="Animation 动画"></a>Animation 动画</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Clock - 时钟类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Clock</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// startTime: JulianDate</span></span><br><span class="line">    <span class="comment">// 作用: 开始时间</span></span><br><span class="line">    <span class="comment">// 默认: JulianDate.now()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">startTime</span> = options.<span class="property">startTime</span> || <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// stopTime: JulianDate</span></span><br><span class="line">    <span class="comment">// 作用: 结束时间</span></span><br><span class="line">    <span class="comment">// 默认: 开始时间 + 1天</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stopTime</span> =</span><br><span class="line">      options.<span class="property">stopTime</span> || <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addDays</span>(<span class="variable language_">this</span>.<span class="property">startTime</span>, <span class="number">1</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// currentTime: JulianDate</span></span><br><span class="line">    <span class="comment">// 作用: 当前时间</span></span><br><span class="line">    <span class="comment">// 默认: 开始时间</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentTime</span> = options.<span class="property">currentTime</span> || <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">clone</span>(<span class="variable language_">this</span>.<span class="property">startTime</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// multiplier: number</span></span><br><span class="line">    <span class="comment">// 作用: 时间倍率</span></span><br><span class="line">    <span class="comment">// 默认: 1.0（实时）</span></span><br><span class="line">    <span class="comment">// 正值: 正向播放，负值: 反向播放</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">multiplier</span> = options.<span class="property">multiplier</span> !== <span class="literal">undefined</span> ? options.<span class="property">multiplier</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clockStep: ClockStep</span></span><br><span class="line">    <span class="comment">// 作用: 时钟步进模式</span></span><br><span class="line">    <span class="comment">// 默认: ClockStep.SYSTEM_CLOCK_MULTIPLIER</span></span><br><span class="line">    <span class="comment">// 选项: TICK_DEPENDENT, SYSTEM_CLOCK_MULTIPLIER, SYSTEM_CLOCK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clockStep</span> = options.<span class="property">clockStep</span> || <span class="title class_">Cesium</span>.<span class="property">ClockStep</span>.<span class="property">SYSTEM_CLOCK_MULTIPLIER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clockRange: ClockRange</span></span><br><span class="line">    <span class="comment">// 作用: 时钟范围行为</span></span><br><span class="line">    <span class="comment">// 默认: ClockRange.UNBOUNDED</span></span><br><span class="line">    <span class="comment">// 选项: UNBOUNDED, CLAMPED, LOOP_STOP</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clockRange</span> = options.<span class="property">clockRange</span> || <span class="title class_">Cesium</span>.<span class="property">ClockRange</span>.<span class="property">UNBOUNDED</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// canAnimate: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否可以动画</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canAnimate</span> = options.<span class="property">canAnimate</span> !== <span class="literal">undefined</span> ? options.<span class="property">canAnimate</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shouldAnimate: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否应该动画</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shouldAnimate</span> = options.<span class="property">shouldAnimate</span> !== <span class="literal">undefined</span> ? options.<span class="property">shouldAnimate</span> : <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件</span></span><br><span class="line">  <span class="comment">// onTick: Event</span></span><br><span class="line">  <span class="comment">// 作用: 时钟滴答事件</span></span><br><span class="line">  <span class="comment">// 参数: clock对象</span></span><br><span class="line">  onTick = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// onStop: Event</span></span><br><span class="line">  <span class="comment">// 作用: 时钟停止事件</span></span><br><span class="line">  onStop = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// tick - 时钟滴答</span></span><br><span class="line">  <span class="title function_">tick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 更新当前时间并触发事件</span></span><br><span class="line">    <span class="keyword">const</span> currentTime = <span class="variable language_">this</span>.<span class="property">currentTime</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">onTick</span>.<span class="title function_">raiseEvent</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="keyword">return</span> currentTime</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间相关类型</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ClockStep</span> = &#123;</span><br><span class="line">  <span class="attr">TICK_DEPENDENT</span>: <span class="number">0</span>, <span class="comment">// 依赖滴答</span></span><br><span class="line">  <span class="attr">SYSTEM_CLOCK_MULTIPLIER</span>: <span class="number">1</span>, <span class="comment">// 系统时钟倍率</span></span><br><span class="line">  <span class="attr">SYSTEM_CLOCK</span>: <span class="number">2</span>, <span class="comment">// 系统时钟</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ClockRange</span> = &#123;</span><br><span class="line">  <span class="attr">UNBOUNDED</span>: <span class="number">0</span>, <span class="comment">// 无界限</span></span><br><span class="line">  <span class="attr">CLAMPED</span>: <span class="number">1</span>, <span class="comment">// 钳制</span></span><br><span class="line">  <span class="attr">LOOP_STOP</span>: <span class="number">2</span>, <span class="comment">// 循环停止</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Property - 属性类（动画基础）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Property</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// definitionChanged: Event</span></span><br><span class="line">    <span class="comment">// 作用: 定义变化事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">definitionChanged</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// isConstant: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否为常量</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isConstant</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getValue - 获取指定时间的值</span></span><br><span class="line">  <span class="title function_">getValue</span>(<span class="params">time, result</span>) &#123;</span><br><span class="line">    <span class="comment">// time: JulianDate - 时间</span></span><br><span class="line">    <span class="comment">// result: Object - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: 属性值</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// equals - 比较相等</span></span><br><span class="line">  <span class="title function_">equals</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="comment">// other: Property - 其他属性</span></span><br><span class="line">    <span class="comment">// 返回: boolean</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ConstantProperty - 常量属性</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConstantProperty</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Property</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_value</span> = value</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isConstant</span> = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getValue</span>(<span class="params">time, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setValue</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> oldValue = <span class="variable language_">this</span>.<span class="property">_value</span></span><br><span class="line">    <span class="keyword">if</span> (oldValue !== value) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_value</span> = value</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">definitionChanged</span>.<span class="title function_">raiseEvent</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SampledProperty - 采样属性（关键帧动画）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampledProperty</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Property</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">type</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_type</span> = type</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_times</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_values</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_interpolationDegree</span> = <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_interpolationAlgorithm</span> = <span class="title class_">Cesium</span>.<span class="property">LinearApproximation</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addSample - 添加采样点</span></span><br><span class="line">  <span class="title function_">addSample</span>(<span class="params">time, value</span>) &#123;</span><br><span class="line">    <span class="comment">// time: JulianDate - 时间</span></span><br><span class="line">    <span class="comment">// value: Object - 值</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addSamples - 批量添加采样点</span></span><br><span class="line">  <span class="title function_">addSamples</span>(<span class="params">times, values</span>) &#123;</span><br><span class="line">    <span class="comment">// times: Array&lt;JulianDate&gt; - 时间数组</span></span><br><span class="line">    <span class="comment">// values: Array&lt;Object&gt; - 值数组</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// removeSample - 移除采样点</span></span><br><span class="line">  <span class="title function_">removeSample</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="comment">// time: JulianDate - 时间</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// setInterpolationOptions - 设置插值选项</span></span><br><span class="line">  <span class="title function_">setInterpolationOptions</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// options.interpolationDegree: number - 插值度数</span></span><br><span class="line">    <span class="comment">// options.interpolationAlgorithm: InterpolationAlgorithm - 插值算法</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CallbackProperty - 回调属性（程序化动画）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CallbackProperty</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Property</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">callback, isConstant</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_callback</span> = callback</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isConstant</span> = isConstant || <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getValue</span>(<span class="params">time, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_callback</span>(time, result)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CompositeProperty - 复合属性（分段动画）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CompositeProperty</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Property</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_intervals</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeIntervalCollection</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addInterval - 添加时间间隔</span></span><br><span class="line">  <span class="title function_">addInterval</span>(<span class="params">interval</span>) &#123;</span><br><span class="line">    <span class="comment">// interval: TimeInterval - 时间间隔（包含data属性）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="title function_">addInterval</span>(interval)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动画示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 位置动画（关键帧）</span></span><br><span class="line"><span class="keyword">const</span> positionProperty = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SampledPositionProperty</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加关键帧</span></span><br><span class="line"><span class="keyword">const</span> start = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>()</span><br><span class="line"><span class="keyword">const</span> stop = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">60</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>())</span><br><span class="line"></span><br><span class="line">positionProperty.<span class="title function_">addSample</span>(start, <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">0</span>))</span><br><span class="line">positionProperty.<span class="title function_">addSample</span>(</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">30</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.5</span>, <span class="number">39.95</span>, <span class="number">1000</span>),</span><br><span class="line">)</span><br><span class="line">positionProperty.<span class="title function_">addSample</span>(stop, <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.6</span>, <span class="number">40.0</span>, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置插值方式</span></span><br><span class="line">positionProperty.<span class="title function_">setInterpolationOptions</span>(&#123;</span><br><span class="line">  <span class="attr">interpolationDegree</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">interpolationAlgorithm</span>: <span class="title class_">Cesium</span>.<span class="property">HermitePolynomialApproximation</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建移动实体</span></span><br><span class="line"><span class="keyword">const</span> movingEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: positionProperty,</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">uri</span>: <span class="string">&#x27;./models/airplane.gltf&#x27;</span>,</span><br><span class="line">    <span class="attr">scale</span>: <span class="number">2.0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">path</span>: &#123;</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">leadTime</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">trailTime</span>: <span class="number">60</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">CYAN</span>,</span><br><span class="line">    <span class="attr">resolution</span>: <span class="number">1</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 旋转动画（程序化）</span></span><br><span class="line"><span class="keyword">const</span> rotationProperty = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CallbackProperty</span>(<span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> seconds = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(time, start)</span><br><span class="line">  <span class="keyword">const</span> angle = (seconds * <span class="title class_">Math</span>.<span class="property">PI</span>) / <span class="number">10</span> <span class="comment">// 每20秒转一圈</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Quaternion</span>.<span class="title function_">fromAxisAngle</span>(<span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="property">UNIT_Z</span>, angle)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rotatingEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">100</span>),</span><br><span class="line">  <span class="attr">orientation</span>: rotationProperty,</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">uri</span>: <span class="string">&#x27;./models/building.gltf&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 颜色动画（关键帧）</span></span><br><span class="line"><span class="keyword">const</span> colorProperty = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SampledProperty</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>)</span><br><span class="line"></span><br><span class="line">colorProperty.<span class="title function_">addSample</span>(start, <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>)</span><br><span class="line">colorProperty.<span class="title function_">addSample</span>(</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">15</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">GREEN</span>,</span><br><span class="line">)</span><br><span class="line">colorProperty.<span class="title function_">addSample</span>(</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">30</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>,</span><br><span class="line">)</span><br><span class="line">colorProperty.<span class="title function_">addSample</span>(</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">45</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line">)</span><br><span class="line">colorProperty.<span class="title function_">addSample</span>(stop, <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> coloredEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">200</span>),</span><br><span class="line">  <span class="attr">box</span>: &#123;</span><br><span class="line">    <span class="attr">dimensions</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>),</span><br><span class="line">    <span class="attr">material</span>: colorProperty,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 复合动画（分段）</span></span><br><span class="line"><span class="keyword">const</span> compositePosition = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CompositePositionProperty</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一段：静止</span></span><br><span class="line">compositePosition.<span class="title function_">addInterval</span>(</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">    <span class="attr">start</span>: start,</span><br><span class="line">    <span class="attr">stop</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">20</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">    <span class="attr">data</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ConstantPositionProperty</span>(<span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">0</span>)),</span><br><span class="line">  &#125;),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二段：移动</span></span><br><span class="line"><span class="keyword">const</span> movingInterval = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">  <span class="attr">start</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">20</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">  <span class="attr">stop</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">40</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">  <span class="attr">data</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SampledPositionProperty</span>(),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">movingInterval.<span class="property">data</span>.<span class="title function_">addSample</span>(</span><br><span class="line">  movingInterval.<span class="property">start</span>,</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">0</span>),</span><br><span class="line">)</span><br><span class="line">movingInterval.<span class="property">data</span>.<span class="title function_">addSample</span>(movingInterval.<span class="property">stop</span>, <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.5</span>, <span class="number">40.0</span>, <span class="number">1000</span>))</span><br><span class="line"></span><br><span class="line">compositePosition.<span class="title function_">addInterval</span>(movingInterval)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三段：再次静止</span></span><br><span class="line">compositePosition.<span class="title function_">addInterval</span>(</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">    <span class="attr">start</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(start, <span class="number">40</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()),</span><br><span class="line">    <span class="attr">stop</span>: stop,</span><br><span class="line">    <span class="attr">data</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ConstantPositionProperty</span>(<span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.5</span>, <span class="number">40.0</span>, <span class="number">1000</span>)),</span><br><span class="line">  &#125;),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compositeEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: compositePosition,</span><br><span class="line">  <span class="attr">point</span>: &#123;</span><br><span class="line">    <span class="attr">pixelSize</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">LIME</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 时钟控制</span></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">startTime</span> = start</span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">stopTime</span> = stop</span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">currentTime</span> = start</span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">clockRange</span> = <span class="title class_">Cesium</span>.<span class="property">ClockRange</span>.<span class="property">LOOP_STOP</span></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">multiplier</span> = <span class="number">1</span></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">shouldAnimate</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 时钟事件监听</span></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">onTick</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">clock</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;当前时间:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toDate</span>(clock.<span class="property">currentTime</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">onStop</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">clock</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;动画停止&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 插值算法详解</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">InterpolationAlgorithm</span> = &#123;</span><br><span class="line">  <span class="comment">// 线性插值</span></span><br><span class="line">  <span class="attr">LINEAR</span>: <span class="title class_">Cesium</span>.<span class="property">LinearApproximation</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拉格朗日插值</span></span><br><span class="line">  <span class="attr">LAGRANGE</span>: <span class="title class_">Cesium</span>.<span class="property">LagrangePolynomialApproximation</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 埃尔米特插值（平滑）</span></span><br><span class="line">  <span class="attr">HERMITE</span>: <span class="title class_">Cesium</span>.<span class="property">HermitePolynomialApproximation</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置不同的插值算法</span></span><br><span class="line">positionProperty.<span class="title function_">setInterpolationOptions</span>(&#123;</span><br><span class="line">  <span class="attr">interpolationDegree</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">interpolationAlgorithm</span>: <span class="title class_">Cesium</span>.<span class="property">LinearApproximation</span>, <span class="comment">// 线性插值，直线运动</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">positionProperty.<span class="title function_">setInterpolationOptions</span>(&#123;</span><br><span class="line">  <span class="attr">interpolationDegree</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">interpolationAlgorithm</span>: <span class="title class_">Cesium</span>.<span class="property">HermitePolynomialApproximation</span>, <span class="comment">// 平滑曲线运动</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. 外推（Extrapolation）</span></span><br><span class="line"><span class="keyword">const</span> extrapolationTypes = &#123;</span><br><span class="line">  <span class="attr">NONE</span>: <span class="title class_">Cesium</span>.<span class="property">ExtrapolationType</span>.<span class="property">NONE</span>, <span class="comment">// 无外推</span></span><br><span class="line">  <span class="attr">HOLD</span>: <span class="title class_">Cesium</span>.<span class="property">ExtrapolationType</span>.<span class="property">HOLD</span>, <span class="comment">// 保持最后值</span></span><br><span class="line">  <span class="attr">EXTRAPOLATE</span>: <span class="title class_">Cesium</span>.<span class="property">ExtrapolationType</span>.<span class="property">EXTRAPOLATE</span>, <span class="comment">// 继续外推</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">positionProperty.<span class="property">forwardExtrapolationType</span> = <span class="title class_">Cesium</span>.<span class="property">ExtrapolationType</span>.<span class="property">EXTRAPOLATE</span></span><br><span class="line">positionProperty.<span class="property">forwardExtrapolationDuration</span> = <span class="number">10</span> <span class="comment">// 外推10秒</span></span><br><span class="line"></span><br><span class="line">positionProperty.<span class="property">backwardExtrapolationType</span> = <span class="title class_">Cesium</span>.<span class="property">ExtrapolationType</span>.<span class="property">HOLD</span></span><br><span class="line">positionProperty.<span class="property">backwardExtrapolationDuration</span> = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. 动画控制函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">playAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">  viewer.<span class="property">clock</span>.<span class="property">shouldAnimate</span> = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">pauseAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">  viewer.<span class="property">clock</span>.<span class="property">shouldAnimate</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">resetAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">  viewer.<span class="property">clock</span>.<span class="property">currentTime</span> = viewer.<span class="property">clock</span>.<span class="property">startTime</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setAnimationSpeed</span>(<span class="params">multiplier</span>) &#123;</span><br><span class="line">  viewer.<span class="property">clock</span>.<span class="property">multiplier</span> = multiplier</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reverseAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">  viewer.<span class="property">clock</span>.<span class="property">multiplier</span> = -<span class="title class_">Math</span>.<span class="title function_">abs</span>(viewer.<span class="property">clock</span>.<span class="property">multiplier</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 9. 粒子系统动画（基于CallbackProperty）</span></span><br><span class="line"><span class="keyword">const</span> particlePositions = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">  particlePositions.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(</span><br><span class="line">      <span class="number">116.4074</span> + (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">0.01</span>,</span><br><span class="line">      <span class="number">39.9042</span> + (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">0.01</span>,</span><br><span class="line">      <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">1000</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="attr">velocity</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(</span><br><span class="line">      (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">100</span>,</span><br><span class="line">      (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">100</span>,</span><br><span class="line">      (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">50</span>,</span><br><span class="line">    ),</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> particleProperty = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CallbackProperty</span>(<span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> seconds = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(time, start)</span><br><span class="line">  <span class="keyword">const</span> positions = []</span><br><span class="line"></span><br><span class="line">  particlePositions.<span class="title function_">forEach</span>(<span class="function">(<span class="params">particle</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> newPos = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">add</span>(</span><br><span class="line">      particle.<span class="property">position</span>,</span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">multiplyByScalar</span>(particle.<span class="property">velocity</span>, seconds, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>()),</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(),</span><br><span class="line">    )</span><br><span class="line">    positions.<span class="title function_">push</span>(newPos.<span class="property">x</span>, newPos.<span class="property">y</span>, newPos.<span class="property">z</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> positions</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用粒子动画到PointPrimitiveCollection</span></span><br></pre></td></tr></table></figure>

<h2 id="几何体系统详解"><a href="#几何体系统详解" class="headerlink" title="几何体系统详解"></a>几何体系统详解</h2><h3 id="Primitive-图元"><a href="#Primitive-图元" class="headerlink" title="Primitive 图元"></a>Primitive 图元</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Primitive - 图元基类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Primitive</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// geometryInstances: Array&lt;GeometryInstance&gt; | GeometryInstance</span></span><br><span class="line">    <span class="comment">// 作用: 几何实例数组</span></span><br><span class="line">    <span class="comment">// 用途: 定义图元的几何形状</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">geometryInstances</span> = options.<span class="property">geometryInstances</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// appearance: Appearance</span></span><br><span class="line">    <span class="comment">// 作用: 外观定义</span></span><br><span class="line">    <span class="comment">// 用途: 控制图元的渲染方式</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">appearance</span> = options.<span class="property">appearance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// show: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = options.<span class="property">show</span> !== <span class="literal">undefined</span> ? options.<span class="property">show</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// modelMatrix: Matrix4</span></span><br><span class="line">    <span class="comment">// 作用: 模型变换矩阵</span></span><br><span class="line">    <span class="comment">// 默认: Matrix4.IDENTITY</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">modelMatrix</span> = options.<span class="property">modelMatrix</span> || <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="property">IDENTITY</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexCacheOptimize: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否优化顶点缓存</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexCacheOptimize</span> =</span><br><span class="line">      options.<span class="property">vertexCacheOptimize</span> !== <span class="literal">undefined</span> ? options.<span class="property">vertexCacheOptimize</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// interleave: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否交错顶点属性</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">interleave</span> = options.<span class="property">interleave</span> !== <span class="literal">undefined</span> ? options.<span class="property">interleave</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// compressVertices: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否压缩顶点</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">compressVertices</span> = options.<span class="property">compressVertices</span> !== <span class="literal">undefined</span> ? options.<span class="property">compressVertices</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// releaseGeometryInstances: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否在渲染后释放几何实例</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">releaseGeometryInstances</span> =</span><br><span class="line">      options.<span class="property">releaseGeometryInstances</span> !== <span class="literal">undefined</span> ? options.<span class="property">releaseGeometryInstances</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// allowPicking: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否允许拾取</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">allowPicking</span> = options.<span class="property">allowPicking</span> !== <span class="literal">undefined</span> ? options.<span class="property">allowPicking</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// cull: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否启用视锥剔除</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cull</span> = options.<span class="property">cull</span> !== <span class="literal">undefined</span> ? options.<span class="property">cull</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// asynchronous: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否异步创建</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">asynchronous</span> = options.<span class="property">asynchronous</span> !== <span class="literal">undefined</span> ? options.<span class="property">asynchronous</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// debugShowBoundingVolume: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示包围体（调试）</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">debugShowBoundingVolume</span> =</span><br><span class="line">      options.<span class="property">debugShowBoundingVolume</span> !== <span class="literal">undefined</span> ? options.<span class="property">debugShowBoundingVolume</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.DISABLED</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = options.<span class="property">shadows</span> || <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// update - 更新图元</span></span><br><span class="line">  <span class="title function_">update</span>(<span class="params">frameState</span>) &#123;</span><br><span class="line">    <span class="comment">// frameState: FrameState - 帧状态</span></span><br><span class="line">    <span class="comment">// 返回: void</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// isDestroyed - 是否已销毁</span></span><br><span class="line">  <span class="title function_">isDestroyed</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// destroy - 销毁图元</span></span><br><span class="line">  <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 清理资源</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getGeometryInstanceAttributes - 获取几何实例属性</span></span><br><span class="line">  <span class="title function_">getGeometryInstanceAttributes</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="comment">// id: string - 实例ID</span></span><br><span class="line">    <span class="comment">// 返回: Object - 属性对象</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GeometryInstance - 几何实例</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GeometryInstance</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// geometry: Geometry</span></span><br><span class="line">    <span class="comment">// 作用: 几何体</span></span><br><span class="line">    <span class="comment">// 必需: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">geometry</span> = options.<span class="property">geometry</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// modelMatrix: Matrix4</span></span><br><span class="line">    <span class="comment">// 作用: 模型变换矩阵</span></span><br><span class="line">    <span class="comment">// 默认: Matrix4.IDENTITY</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">modelMatrix</span> = options.<span class="property">modelMatrix</span> || <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="property">IDENTITY</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// id: Object</span></span><br><span class="line">    <span class="comment">// 作用: 实例标识符</span></span><br><span class="line">    <span class="comment">// 用途: 拾取和属性更新</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = options.<span class="property">id</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// attributes: Object</span></span><br><span class="line">    <span class="comment">// 作用: 每实例属性</span></span><br><span class="line">    <span class="comment">// 用途: 颜色、显示状态等</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">attributes</span> = options.<span class="property">attributes</span> || &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基础几何体</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// BoxGeometry - 盒子几何体</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BoxGeometry</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// dimensions: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 盒子尺寸（长、宽、高）</span></span><br><span class="line">    <span class="comment">// 必需: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dimensions</span> = options.<span class="property">dimensions</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexFormat: VertexFormat</span></span><br><span class="line">    <span class="comment">// 作用: 顶点格式</span></span><br><span class="line">    <span class="comment">// 默认: VertexFormat.DEFAULT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexFormat</span> = options.<span class="property">vertexFormat</span> || <span class="title class_">Cesium</span>.<span class="property">VertexFormat</span>.<span class="property">DEFAULT</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// createGeometry - 创建几何体</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">createGeometry</span>(<span class="params">boxGeometry</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回: Geometry | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// packedLength - 打包长度</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">packedLength</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// pack - 打包</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">pack</span>(<span class="params">value, array, startingIndex = <span class="number">0</span></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// unpack - 解包</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">unpack</span>(<span class="params">array, startingIndex = <span class="number">0</span>, result</span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SphereGeometry - 球体几何体</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SphereGeometry</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// radius: number</span></span><br><span class="line">    <span class="comment">// 作用: 球体半径</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">radius</span> = options.<span class="property">radius</span> !== <span class="literal">undefined</span> ? options.<span class="property">radius</span> : <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// stackPartitions: number</span></span><br><span class="line">    <span class="comment">// 作用: 堆叠分区数（纬度方向）</span></span><br><span class="line">    <span class="comment">// 默认: 64</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stackPartitions</span> = options.<span class="property">stackPartitions</span> !== <span class="literal">undefined</span> ? options.<span class="property">stackPartitions</span> : <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// slicePartitions: number</span></span><br><span class="line">    <span class="comment">// 作用: 切片分区数（经度方向）</span></span><br><span class="line">    <span class="comment">// 默认: 64</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">slicePartitions</span> = options.<span class="property">slicePartitions</span> !== <span class="literal">undefined</span> ? options.<span class="property">slicePartitions</span> : <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexFormat: VertexFormat</span></span><br><span class="line">    <span class="comment">// 作用: 顶点格式</span></span><br><span class="line">    <span class="comment">// 默认: VertexFormat.DEFAULT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexFormat</span> = options.<span class="property">vertexFormat</span> || <span class="title class_">Cesium</span>.<span class="property">VertexFormat</span>.<span class="property">DEFAULT</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CylinderGeometry - 圆柱体几何体</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CylinderGeometry</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// length: number</span></span><br><span class="line">    <span class="comment">// 作用: 圆柱体长度（高度）</span></span><br><span class="line">    <span class="comment">// 必需: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">length</span> = options.<span class="property">length</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// topRadius: number</span></span><br><span class="line">    <span class="comment">// 作用: 顶部半径</span></span><br><span class="line">    <span class="comment">// 必需: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">topRadius</span> = options.<span class="property">topRadius</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// bottomRadius: number</span></span><br><span class="line">    <span class="comment">// 作用: 底部半径</span></span><br><span class="line">    <span class="comment">// 必需: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bottomRadius</span> = options.<span class="property">bottomRadius</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// slices: number</span></span><br><span class="line">    <span class="comment">// 作用: 切片数量</span></span><br><span class="line">    <span class="comment">// 默认: 128</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">slices</span> = options.<span class="property">slices</span> !== <span class="literal">undefined</span> ? options.<span class="property">slices</span> : <span class="number">128</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexFormat: VertexFormat</span></span><br><span class="line">    <span class="comment">// 作用: 顶点格式</span></span><br><span class="line">    <span class="comment">// 默认: VertexFormat.DEFAULT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexFormat</span> = options.<span class="property">vertexFormat</span> || <span class="title class_">Cesium</span>.<span class="property">VertexFormat</span>.<span class="property">DEFAULT</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PlaneGeometry - 平面几何体</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PlaneGeometry</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// vertexFormat: VertexFormat</span></span><br><span class="line">    <span class="comment">// 作用: 顶点格式</span></span><br><span class="line">    <span class="comment">// 默认: VertexFormat.DEFAULT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexFormat</span> = options.<span class="property">vertexFormat</span> || <span class="title class_">Cesium</span>.<span class="property">VertexFormat</span>.<span class="property">DEFAULT</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// EllipsoidGeometry - 椭球体几何体</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EllipsoidGeometry</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// radii: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 椭球体半径（x, y, z）</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian3(1, 1, 1)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">radii</span> = options.<span class="property">radii</span> || <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// innerRadii: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 内部半径（用于创建空心椭球）</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">innerRadii</span> = options.<span class="property">innerRadii</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// minimumClock: number</span></span><br><span class="line">    <span class="comment">// 作用: 最小时钟角（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">minimumClock</span> = options.<span class="property">minimumClock</span> !== <span class="literal">undefined</span> ? options.<span class="property">minimumClock</span> : <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumClock: number</span></span><br><span class="line">    <span class="comment">// 作用: 最大时钟角（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: 2π</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maximumClock</span> =</span><br><span class="line">      options.<span class="property">maximumClock</span> !== <span class="literal">undefined</span> ? options.<span class="property">maximumClock</span> : <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="property">TWO_PI</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// minimumCone: number</span></span><br><span class="line">    <span class="comment">// 作用: 最小锥角（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">minimumCone</span> = options.<span class="property">minimumCone</span> !== <span class="literal">undefined</span> ? options.<span class="property">minimumCone</span> : <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumCone: number</span></span><br><span class="line">    <span class="comment">// 作用: 最大锥角（弧度）</span></span><br><span class="line">    <span class="comment">// 默认: π</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maximumCone</span> = options.<span class="property">maximumCone</span> !== <span class="literal">undefined</span> ? options.<span class="property">maximumCone</span> : <span class="title class_">Math</span>.<span class="property">PI</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// stackPartitions: number</span></span><br><span class="line">    <span class="comment">// 作用: 堆叠分区数</span></span><br><span class="line">    <span class="comment">// 默认: 64</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stackPartitions</span> = options.<span class="property">stackPartitions</span> !== <span class="literal">undefined</span> ? options.<span class="property">stackPartitions</span> : <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// slicePartitions: number</span></span><br><span class="line">    <span class="comment">// 作用: 切片分区数</span></span><br><span class="line">    <span class="comment">// 默认: 64</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">slicePartitions</span> = options.<span class="property">slicePartitions</span> !== <span class="literal">undefined</span> ? options.<span class="property">slicePartitions</span> : <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexFormat: VertexFormat</span></span><br><span class="line">    <span class="comment">// 作用: 顶点格式</span></span><br><span class="line">    <span class="comment">// 默认: VertexFormat.DEFAULT</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexFormat</span> = options.<span class="property">vertexFormat</span> || <span class="title class_">Cesium</span>.<span class="property">VertexFormat</span>.<span class="property">DEFAULT</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Appearance - 外观类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// MaterialAppearance - 材质外观</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MaterialAppearance</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// material: Material</span></span><br><span class="line">    <span class="comment">// 作用: 材质</span></span><br><span class="line">    <span class="comment">// 默认: Material.ColorType</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">material</span> = options.<span class="property">material</span> || <span class="title class_">Cesium</span>.<span class="property">Material</span>.<span class="title function_">fromType</span>(<span class="title class_">Cesium</span>.<span class="property">Material</span>.<span class="property">ColorType</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// translucent: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否透明</span></span><br><span class="line">    <span class="comment">// 默认: 根据材质确定</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">translucent</span> = options.<span class="property">translucent</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexShaderSource: string</span></span><br><span class="line">    <span class="comment">// 作用: 顶点着色器源码</span></span><br><span class="line">    <span class="comment">// 默认: 使用内置着色器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexShaderSource</span> = options.<span class="property">vertexShaderSource</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fragmentShaderSource: string</span></span><br><span class="line">    <span class="comment">// 作用: 片段着色器源码</span></span><br><span class="line">    <span class="comment">// 默认: 使用内置着色器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fragmentShaderSource</span> = options.<span class="property">fragmentShaderSource</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// renderState: RenderState</span></span><br><span class="line">    <span class="comment">// 作用: 渲染状态</span></span><br><span class="line">    <span class="comment">// 默认: 默认渲染状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">renderState</span> = options.<span class="property">renderState</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// closed: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 几何体是否封闭</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">closed</span> = options.<span class="property">closed</span> !== <span class="literal">undefined</span> ? options.<span class="property">closed</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexFormat: VertexFormat</span></span><br><span class="line">    <span class="comment">// 作用: 顶点格式</span></span><br><span class="line">    <span class="comment">// 默认: MaterialAppearance.vertexFormat</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexFormat</span> = options.<span class="property">vertexFormat</span> || <span class="title class_">MaterialAppearance</span>.<span class="property">vertexFormat</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// flat: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否使用平面着色</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">flat</span> = options.<span class="property">flat</span> !== <span class="literal">undefined</span> ? options.<span class="property">flat</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// faceForward: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否面向前方</span></span><br><span class="line">    <span class="comment">// 默认: !closed</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">faceForward</span> = options.<span class="property">faceForward</span> !== <span class="literal">undefined</span> ? options.<span class="property">faceForward</span> : !<span class="variable language_">this</span>.<span class="property">closed</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PerInstanceColorAppearance - 每实例颜色外观</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PerInstanceColorAppearance</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// flat: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否使用平面着色</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">flat</span> = options.<span class="property">flat</span> !== <span class="literal">undefined</span> ? options.<span class="property">flat</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// faceForward: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否面向前方</span></span><br><span class="line">    <span class="comment">// 默认: !closed</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">faceForward</span> = options.<span class="property">faceForward</span> !== <span class="literal">undefined</span> ? options.<span class="property">faceForward</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// translucent: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否透明</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">translucent</span> = options.<span class="property">translucent</span> !== <span class="literal">undefined</span> ? options.<span class="property">translucent</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// closed: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 几何体是否封闭</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">closed</span> = options.<span class="property">closed</span> !== <span class="literal">undefined</span> ? options.<span class="property">closed</span> : <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// vertexShaderSource: string</span></span><br><span class="line">    <span class="comment">// 作用: 顶点着色器源码</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vertexShaderSource</span> = options.<span class="property">vertexShaderSource</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fragmentShaderSource: string</span></span><br><span class="line">    <span class="comment">// 作用: 片段着色器源码</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fragmentShaderSource</span> = options.<span class="property">fragmentShaderSource</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// renderState: RenderState</span></span><br><span class="line">    <span class="comment">// 作用: 渲染状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">renderState</span> = options.<span class="property">renderState</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 几何体使用示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建盒子图元</span></span><br><span class="line"><span class="keyword">const</span> boxInstances = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) &#123;</span><br><span class="line">    boxInstances.<span class="title function_">push</span>(</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">        <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">BoxGeometry</span>(&#123;</span><br><span class="line">          <span class="attr">dimensions</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">1000</span>, <span class="number">1000</span>, <span class="number">1000</span>),</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">modelMatrix</span>: <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByTranslation</span>(</span><br><span class="line">          <span class="title class_">Cesium</span>.<span class="property">Transforms</span>.<span class="title function_">eastNorthUpToFixedFrame</span>(</span><br><span class="line">            <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span> + i * <span class="number">0.01</span>, <span class="number">39.9042</span> + j * <span class="number">0.01</span>),</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">500</span>),</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>(),</span><br><span class="line">        ),</span><br><span class="line">        <span class="attr">id</span>: <span class="string">`box_<span class="subst">$&#123;i&#125;</span>_<span class="subst">$&#123;j&#125;</span>`</span>,</span><br><span class="line">        <span class="attr">attributes</span>: &#123;</span><br><span class="line">          <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">fromColor</span>(</span><br><span class="line">            <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="title function_">fromRandom</span>(&#123; <span class="attr">alpha</span>: <span class="number">0.8</span> &#125;),</span><br><span class="line">          ),</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> boxPrimitive = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Primitive</span>(&#123;</span><br><span class="line">  <span class="attr">geometryInstances</span>: boxInstances,</span><br><span class="line">  <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerInstanceColorAppearance</span>(&#123;</span><br><span class="line">    <span class="attr">translucent</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">closed</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(boxPrimitive)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建球体图元</span></span><br><span class="line"><span class="keyword">const</span> sphereInstance = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">  <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SphereGeometry</span>(&#123;</span><br><span class="line">    <span class="attr">radius</span>: <span class="number">500.0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">modelMatrix</span>: <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByTranslation</span>(</span><br><span class="line">    <span class="title class_">Cesium</span>.<span class="property">Transforms</span>.<span class="title function_">eastNorthUpToFixedFrame</span>(<span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>)),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1000</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>(),</span><br><span class="line">  ),</span><br><span class="line">  <span class="attr">attributes</span>: &#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">fromColor</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">AQUA</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> spherePrimitive = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Primitive</span>(&#123;</span><br><span class="line">  <span class="attr">geometryInstances</span>: sphereInstance,</span><br><span class="line">  <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerInstanceColorAppearance</span>(),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(spherePrimitive)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 材质外观图元</span></span><br><span class="line"><span class="keyword">const</span> planePrimitive = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Primitive</span>(&#123;</span><br><span class="line">  <span class="attr">geometryInstances</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">    <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PlaneGeometry</span>(&#123;</span><br><span class="line">      <span class="attr">vertexFormat</span>: <span class="title class_">Cesium</span>.<span class="property">MaterialAppearance</span>.<span class="property">vertexFormat</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">modelMatrix</span>: <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByScale</span>(</span><br><span class="line">      <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByTranslation</span>(</span><br><span class="line">        <span class="title class_">Cesium</span>.<span class="property">Transforms</span>.<span class="title function_">eastNorthUpToFixedFrame</span>(<span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>)),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">2000</span>),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>(),</span><br><span class="line">      ),</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">1000</span>, <span class="number">1000</span>, <span class="number">1</span>),</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>(),</span><br><span class="line">    ),</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">MaterialAppearance</span>(&#123;</span><br><span class="line">    <span class="attr">material</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Material</span>(&#123;</span><br><span class="line">      <span class="attr">fabric</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Image&#x27;</span>,</span><br><span class="line">        <span class="attr">uniforms</span>: &#123;</span><br><span class="line">          <span class="attr">image</span>: <span class="string">&#x27;path/to/texture.jpg&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(planePrimitive)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 动态修改属性</span></span><br><span class="line"><span class="keyword">const</span> attributes = boxPrimitive.<span class="title function_">getGeometryInstanceAttributes</span>(<span class="string">&#x27;box_0_0&#x27;</span>)</span><br><span class="line">attributes.<span class="property">color</span> = <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">toValue</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 分类图元（贴地）</span></span><br><span class="line"><span class="keyword">const</span> classifiedPrimitive = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ClassificationPrimitive</span>(&#123;</span><br><span class="line">  <span class="attr">geometryInstances</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">    <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolygonGeometry</span>(&#123;</span><br><span class="line">      <span class="attr">polygonHierarchy</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolygonHierarchy</span>(</span><br><span class="line">        <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>([<span class="number">116.4</span>, <span class="number">39.9</span>, <span class="number">116.5</span>, <span class="number">39.9</span>, <span class="number">116.5</span>, <span class="number">40.0</span>, <span class="number">116.4</span>, <span class="number">40.0</span>]),</span><br><span class="line">      ),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">attributes</span>: &#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">fromColor</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>.<span class="title function_">withAlpha</span>(<span class="number">0.5</span>)),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerInstanceColorAppearance</span>(&#123;</span><br><span class="line">    <span class="attr">translucent</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(classifiedPrimitive)</span><br></pre></td></tr></table></figure>

<h2 id="场景控制详解"><a href="#场景控制详解" class="headerlink" title="场景控制详解"></a>场景控制详解</h2><h3 id="Scene-场景类"><a href="#Scene-场景类" class="headerlink" title="Scene 场景类"></a>Scene 场景类</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Scene - 场景类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Scene</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">canvas, contextOptions, creditContainer</span>) &#123;</span><br><span class="line">    <span class="comment">// canvas: HTMLCanvasElement</span></span><br><span class="line">    <span class="comment">// 作用: 渲染画布</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvas</span> = canvas</span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 渲染控制属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// backgroundColor: Color</span></span><br><span class="line">    <span class="comment">// 作用: 背景颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">backgroundColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fog: Fog</span></span><br><span class="line">    <span class="comment">// 作用: 雾效</span></span><br><span class="line">    <span class="comment">// 默认: new Fog()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fog</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Fog</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// skyBox: SkyBox</span></span><br><span class="line">    <span class="comment">// 作用: 天空盒</span></span><br><span class="line">    <span class="comment">// 默认: undefined（使用默认天空）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">skyBox</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// skyAtmosphere: SkyAtmosphere</span></span><br><span class="line">    <span class="comment">// 作用: 大气散射</span></span><br><span class="line">    <span class="comment">// 默认: new SkyAtmosphere()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">skyAtmosphere</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SkyAtmosphere</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sun: Sun</span></span><br><span class="line">    <span class="comment">// 作用: 太阳</span></span><br><span class="line">    <span class="comment">// 默认: new Sun()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sun</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Sun</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// moon: Moon</span></span><br><span class="line">    <span class="comment">// 作用: 月亮</span></span><br><span class="line">    <span class="comment">// 默认: new Moon()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">moon</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Moon</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sunBloom: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 太阳光晕效果</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sunBloom</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 地球相关属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// globe: Globe</span></span><br><span class="line">    <span class="comment">// 作用: 地球对象</span></span><br><span class="line">    <span class="comment">// 默认: new Globe(Ellipsoid.WGS84)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">globe</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Globe</span>(<span class="title class_">Cesium</span>.<span class="property">Ellipsoid</span>.<span class="property">WGS84</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 渲染性能属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// requestRenderMode: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 按需渲染模式</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">requestRenderMode</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumRenderTimeChange: number</span></span><br><span class="line">    <span class="comment">// 作用: 最大渲染时间变化</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maximumRenderTimeChange</span> = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// debugShowFramesPerSecond: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 显示FPS调试信息</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">debugShowFramesPerSecond</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// debugCommandFilter: function</span></span><br><span class="line">    <span class="comment">// 作用: 调试命令过滤器</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">debugCommandFilter</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 拾取相关属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// pickTranslucentDepth: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 拾取透明物体深度</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pickTranslucentDepth</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 后处理效果 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// postProcessStages: PostProcessStageCollection</span></span><br><span class="line">    <span class="comment">// 作用: 后处理阶段集合</span></span><br><span class="line">    <span class="comment">// 默认: new PostProcessStageCollection()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">postProcessStages</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PostProcessStageCollection</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 光照属性 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// light: Light</span></span><br><span class="line">    <span class="comment">// 作用: 场景光源</span></span><br><span class="line">    <span class="comment">// 默认: new SunLight()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">light</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">SunLight</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否启用阴影</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadowMap: ShadowMap</span></span><br><span class="line">    <span class="comment">// 作用: 阴影贴图</span></span><br><span class="line">    <span class="comment">// 默认: new ShadowMap()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadowMap</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ShadowMap</span>(&#123;</span><br><span class="line">      <span class="attr">context</span>: <span class="variable language_">this</span>.<span class="property">context</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 高动态范围渲染 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// highDynamicRange: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否启用HDR</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">highDynamicRange</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// gamma: number</span></span><br><span class="line">    <span class="comment">// 作用: 伽马校正值</span></span><br><span class="line">    <span class="comment">// 默认: 1.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gamma</span> = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 地下模式 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// underground: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 地下模式</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">underground</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// undergroundColor: Color</span></span><br><span class="line">    <span class="comment">// 作用: 地下背景颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLACK</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">undergroundColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 地球透明度 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// globeTranslucencyState: GlobeTranslucencyState</span></span><br><span class="line">    <span class="comment">// 作用: 地球透明度状态</span></span><br><span class="line">    <span class="comment">// 默认: &#123;&#125;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">globeTranslucencyState</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 相机控制器 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// screenSpaceCameraController: ScreenSpaceCameraController</span></span><br><span class="line">    <span class="comment">// 作用: 屏幕空间相机控制器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">screenSpaceCameraController</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ScreenSpaceCameraController</span>(<span class="variable language_">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// === 图元集合 ===</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// primitives: PrimitiveCollection</span></span><br><span class="line">    <span class="comment">// 作用: 图元集合</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">primitives</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PrimitiveCollection</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// groundPrimitives: PrimitiveCollection</span></span><br><span class="line">    <span class="comment">// 作用: 地面图元集合</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">groundPrimitives</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PrimitiveCollection</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 渲染方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// render - 渲染场景</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="comment">// time: JulianDate - 渲染时间</span></span><br><span class="line">    <span class="comment">// 返回: void</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// requestRender - 请求渲染</span></span><br><span class="line">  <span class="title function_">requestRender</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 在按需渲染模式下请求一次渲染</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 拾取方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// pick - 拾取对象</span></span><br><span class="line">  <span class="title function_">pick</span>(<span class="params">windowPosition</span>) &#123;</span><br><span class="line">    <span class="comment">// windowPosition: Cartesian2 - 屏幕坐标</span></span><br><span class="line">    <span class="comment">// 返回: Object | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// drillPick - 钻取拾取（获取所有对象）</span></span><br><span class="line">  <span class="title function_">drillPick</span>(<span class="params">windowPosition, limit</span>) &#123;</span><br><span class="line">    <span class="comment">// windowPosition: Cartesian2 - 屏幕坐标</span></span><br><span class="line">    <span class="comment">// limit: number - 最大数量限制</span></span><br><span class="line">    <span class="comment">// 返回: Array&lt;Object&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// pickPosition - 拾取位置</span></span><br><span class="line">  <span class="title function_">pickPosition</span>(<span class="params">windowPosition, result</span>) &#123;</span><br><span class="line">    <span class="comment">// windowPosition: Cartesian2 - 屏幕坐标</span></span><br><span class="line">    <span class="comment">// result: Cartesian3 - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian3 | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// sampleHeight - 采样高度</span></span><br><span class="line">  <span class="title function_">sampleHeight</span>(<span class="params">position, objectsToExclude, width</span>) &#123;</span><br><span class="line">    <span class="comment">// position: Cartesian3 - 世界坐标</span></span><br><span class="line">    <span class="comment">// objectsToExclude: Array - 排除的对象</span></span><br><span class="line">    <span class="comment">// width: number - 采样宽度</span></span><br><span class="line">    <span class="comment">// 返回: number | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// clampToHeight - 贴合到高度</span></span><br><span class="line">  <span class="title function_">clampToHeight</span>(<span class="params">cartesian, objectsToExclude, width, result</span>) &#123;</span><br><span class="line">    <span class="comment">// cartesian: Cartesian3 - 世界坐标</span></span><br><span class="line">    <span class="comment">// objectsToExclude: Array - 排除的对象</span></span><br><span class="line">    <span class="comment">// width: number - 采样宽度</span></span><br><span class="line">    <span class="comment">// result: Cartesian3 - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian3 | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 相机方法 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// cartesianToCanvasCoordinates - 笛卡尔坐标转画布坐标</span></span><br><span class="line">  <span class="title function_">cartesianToCanvasCoordinates</span>(<span class="params">position, result</span>) &#123;</span><br><span class="line">    <span class="comment">// position: Cartesian3 - 世界坐标</span></span><br><span class="line">    <span class="comment">// result: Cartesian2 - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian2 | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// === 事件 ===</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// preUpdate: Event</span></span><br><span class="line">  <span class="comment">// 作用: 更新前事件</span></span><br><span class="line">  preUpdate = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// postUpdate: Event</span></span><br><span class="line">  <span class="comment">// 作用: 更新后事件</span></span><br><span class="line">  postUpdate = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// preRender: Event</span></span><br><span class="line">  <span class="comment">// 作用: 渲染前事件</span></span><br><span class="line">  preRender = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// postRender: Event</span></span><br><span class="line">  <span class="comment">// 作用: 渲染后事件</span></span><br><span class="line">  postRender = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// morphStart: Event</span></span><br><span class="line">  <span class="comment">// 作用: 变形开始事件</span></span><br><span class="line">  morphStart = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// morphComplete: Event</span></span><br><span class="line">  <span class="comment">// 作用: 变形完成事件</span></span><br><span class="line">  morphComplete = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// terrainProviderChanged: Event</span></span><br><span class="line">  <span class="comment">// 作用: 地形提供者变化事件</span></span><br><span class="line">  terrainProviderChanged = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Globe - 地球类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Globe</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">ellipsoid</span>) &#123;</span><br><span class="line">    <span class="comment">// ellipsoid: Ellipsoid</span></span><br><span class="line">    <span class="comment">// 作用: 椭球体</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ellipsoid</span> = ellipsoid || <span class="title class_">Cesium</span>.<span class="property">Ellipsoid</span>.<span class="property">WGS84</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// show: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示地球</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// maximumScreenSpaceError: number</span></span><br><span class="line">    <span class="comment">// 作用: 最大屏幕空间误差</span></span><br><span class="line">    <span class="comment">// 默认: 2</span></span><br><span class="line">    <span class="comment">// 性能影响: 值越小质量越高，性能越低</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maximumScreenSpaceError</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// tileCacheSize: number</span></span><br><span class="line">    <span class="comment">// 作用: 瓦片缓存大小</span></span><br><span class="line">    <span class="comment">// 默认: 100</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tileCacheSize</span> = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// loadingDescendantLimit: number</span></span><br><span class="line">    <span class="comment">// 作用: 加载后代限制</span></span><br><span class="line">    <span class="comment">// 默认: 20</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loadingDescendantLimit</span> = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// preloadAncestors: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否预加载祖先瓦片</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">preloadAncestors</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// preloadSiblings: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否预加载兄弟瓦片</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">preloadSiblings</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// enableLighting: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否启用光照</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">enableLighting</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// lightingFadeOutDistance: number</span></span><br><span class="line">    <span class="comment">// 作用: 光照淡出距离</span></span><br><span class="line">    <span class="comment">// 默认: 6500000.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lightingFadeOutDistance</span> = <span class="number">6500000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// lightingFadeInDistance: number</span></span><br><span class="line">    <span class="comment">// 作用: 光照淡入距离</span></span><br><span class="line">    <span class="comment">// 默认: 9000000.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lightingFadeInDistance</span> = <span class="number">9000000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// showWaterEffect: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示水体效果</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">showWaterEffect</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shadows: ShadowMode</span></span><br><span class="line">    <span class="comment">// 作用: 阴影模式</span></span><br><span class="line">    <span class="comment">// 默认: ShadowMode.RECEIVE_ONLY</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">shadows</span> = <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">RECEIVE_ONLY</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// atmosphereLightIntensity: number</span></span><br><span class="line">    <span class="comment">// 作用: 大气光照强度</span></span><br><span class="line">    <span class="comment">// 默认: 10.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">atmosphereLightIntensity</span> = <span class="number">10.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// atmosphereRayleighCoefficient: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 瑞利散射系数</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian3(5.5e-6, 13.0e-6, 28.4e-6)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">atmosphereRayleighCoefficient</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">5.5e-6</span>, <span class="number">13.0e-6</span>, <span class="number">28.4e-6</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// atmosphereMieCoefficient: Cartesian3</span></span><br><span class="line">    <span class="comment">// 作用: 米氏散射系数</span></span><br><span class="line">    <span class="comment">// 默认: Cartesian3(21e-6, 21e-6, 21e-6)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">atmosphereMieCoefficient</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">21e-6</span>, <span class="number">21e-6</span>, <span class="number">21e-6</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// atmosphereRayleighScaleHeight: number</span></span><br><span class="line">    <span class="comment">// 作用: 瑞利散射高度</span></span><br><span class="line">    <span class="comment">// 默认: 8000.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">atmosphereRayleighScaleHeight</span> = <span class="number">8000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// atmosphereMieScaleHeight: number</span></span><br><span class="line">    <span class="comment">// 作用: 米氏散射高度</span></span><br><span class="line">    <span class="comment">// 默认: 1200.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">atmosphereMieScaleHeight</span> = <span class="number">1200.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// atmosphereMieAnisotropy: number</span></span><br><span class="line">    <span class="comment">// 作用: 米氏散射各向异性</span></span><br><span class="line">    <span class="comment">// 默认: 0.9</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">atmosphereMieAnisotropy</span> = <span class="number">0.9</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// baseColor: Color</span></span><br><span class="line">    <span class="comment">// 作用: 基础颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.BLUE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">baseColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clippingPlanes: ClippingPlaneCollection</span></span><br><span class="line">    <span class="comment">// 作用: 裁剪平面集合</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clippingPlanes</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// cartographicLimitRectangle: Rectangle</span></span><br><span class="line">    <span class="comment">// 作用: 地理限制矩形</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cartographicLimitRectangle</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// backFaceCulling: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 背面剔除</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">backFaceCulling</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// showSkirts: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示裙边</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">showSkirts</span> = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// getHeight - 获取高度</span></span><br><span class="line">  <span class="title function_">getHeight</span>(<span class="params">cartographic</span>) &#123;</span><br><span class="line">    <span class="comment">// cartographic: Cartographic - 地理坐标</span></span><br><span class="line">    <span class="comment">// 返回: number | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// pick - 拾取地球表面</span></span><br><span class="line">  <span class="title function_">pick</span>(<span class="params">ray, scene, result</span>) &#123;</span><br><span class="line">    <span class="comment">// ray: Ray - 射线</span></span><br><span class="line">    <span class="comment">// scene: Scene - 场景</span></span><br><span class="line">    <span class="comment">// result: Cartesian3 - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: Cartesian3 | undefined</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景使用示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 基础场景配置</span></span><br><span class="line"><span class="keyword">const</span> scene = viewer.<span class="property">scene</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置背景色</span></span><br><span class="line">scene.<span class="property">backgroundColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">DARKSLATEGRAY</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启阴影</span></span><br><span class="line">scene.<span class="property">shadows</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">shadowMap</span>.<span class="property">maximumDistance</span> = <span class="number">10000.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启雾效</span></span><br><span class="line">scene.<span class="property">fog</span>.<span class="property">enabled</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">fog</span>.<span class="property">density</span> = <span class="number">0.0001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 地球配置</span></span><br><span class="line"><span class="keyword">const</span> globe = scene.<span class="property">globe</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 地形细节级别</span></span><br><span class="line">globe.<span class="property">maximumScreenSpaceError</span> = <span class="number">1</span> <span class="comment">// 更高质量</span></span><br><span class="line">globe.<span class="property">tileCacheSize</span> = <span class="number">200</span> <span class="comment">// 更大缓存</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启地球光照</span></span><br><span class="line">globe.<span class="property">enableLighting</span> = <span class="literal">true</span></span><br><span class="line">globe.<span class="property">atmosphereLightIntensity</span> = <span class="number">15.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 水体效果</span></span><br><span class="line">globe.<span class="property">showWaterEffect</span> = <span class="literal">true</span></span><br><span class="line">globe.<span class="property">baseColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">NAVY</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 后处理效果</span></span><br><span class="line"><span class="keyword">const</span> postProcess = scene.<span class="property">postProcessStages</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加FXAA抗锯齿</span></span><br><span class="line"><span class="keyword">const</span> fxaa = <span class="title class_">Cesium</span>.<span class="property">PostProcessStageLibrary</span>.<span class="title function_">createFXAAStage</span>()</span><br><span class="line">postProcess.<span class="title function_">add</span>(fxaa)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加轮廓线效果</span></span><br><span class="line"><span class="keyword">const</span> silhouette = <span class="title class_">Cesium</span>.<span class="property">PostProcessStageLibrary</span>.<span class="title function_">createSilhouetteStage</span>()</span><br><span class="line">postProcess.<span class="title function_">add</span>(silhouette)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义后处理效果</span></span><br><span class="line"><span class="keyword">const</span> customStage = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PostProcessStage</span>(&#123;</span><br><span class="line">  <span class="attr">fragmentShader</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    uniform sampler2D colorTexture;</span></span><br><span class="line"><span class="string">    in vec2 v_textureCoordinates;</span></span><br><span class="line"><span class="string">    out vec4 fragColor;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    void main() &#123;</span></span><br><span class="line"><span class="string">      vec4 color = texture(colorTexture, v_textureCoordinates);</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">      // 简单的灰度效果</span></span><br><span class="line"><span class="string">      float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));</span></span><br><span class="line"><span class="string">      fragColor = vec4(gray, gray, gray, color.a);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  <span class="attr">uniforms</span>: &#123;&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">postProcess.<span class="title function_">add</span>(customStage)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 事件监听</span></span><br><span class="line">scene.<span class="property">preRender</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 渲染前的自定义逻辑</span></span><br><span class="line">  customStage.<span class="property">enabled</span> = viewer.<span class="property">clock</span>.<span class="property">currentTime</span>.<span class="property">secondsOfDay</span> &gt; <span class="number">43200</span> <span class="comment">// 下午启用灰度效果</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">scene.<span class="property">postRender</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 渲染后的统计信息</span></span><br><span class="line">  <span class="keyword">if</span> (scene.<span class="property">debugShowFramesPerSecond</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;FPS:&#x27;</span>, scene.<span class="property">debugShowFramesPerSecond</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 拾取增强</span></span><br><span class="line">scene.<span class="property">pickTranslucentDepth</span> = <span class="literal">true</span> <span class="comment">// 拾取透明物体</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义拾取处理</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enhancedPick</span>(<span class="params">windowPosition</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> picked = scene.<span class="title function_">pick</span>(windowPosition)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Cesium</span>.<span class="title function_">defined</span>(picked)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;拾取到对象:&#x27;</span>, picked.<span class="property">id</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取精确位置</span></span><br><span class="line">    <span class="keyword">const</span> position = scene.<span class="title function_">pickPosition</span>(windowPosition)</span><br><span class="line">    <span class="keyword">if</span> (position) &#123;</span><br><span class="line">      <span class="keyword">const</span> cartographic = <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(position)</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;精确位置:&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">longitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(cartographic.<span class="property">longitude</span>),</span><br><span class="line">        <span class="attr">latitude</span>: <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="title function_">toDegrees</span>(cartographic.<span class="property">latitude</span>),</span><br><span class="line">        <span class="attr">height</span>: cartographic.<span class="property">height</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 钻取拾取（获取所有层级的对象）</span></span><br><span class="line">    <span class="keyword">const</span> allPicked = scene.<span class="title function_">drillPick</span>(windowPosition, <span class="number">10</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;所有拾取对象:&#x27;</span>, allPicked)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 性能优化配置</span></span><br><span class="line"><span class="comment">// 按需渲染</span></span><br><span class="line">scene.<span class="property">requestRenderMode</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">maximumRenderTimeChange</span> = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 手动请求渲染</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestRenderIfNeeded</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (scene.<span class="property">requestRenderMode</span> &amp;&amp; needsUpdate) &#123;</span><br><span class="line">    scene.<span class="title function_">requestRender</span>()</span><br><span class="line">    needsUpdate = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. 调试配置</span></span><br><span class="line">scene.<span class="property">debugShowFramesPerSecond</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">debugCommandFilter</span> = <span class="function">(<span class="params">command</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 过滤调试命令</span></span><br><span class="line">  <span class="keyword">return</span> command.<span class="property">pass</span> === <span class="title class_">Cesium</span>.<span class="property">Pass</span>.<span class="property">OPAQUE</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. HDR和色调映射</span></span><br><span class="line">scene.<span class="property">highDynamicRange</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">gamma</span> = <span class="number">2.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 9. 地下模式</span></span><br><span class="line">scene.<span class="property">underground</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">undergroundColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>.<span class="title function_">withAlpha</span>(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 10. 全球透明度</span></span><br><span class="line">scene.<span class="property">globe</span>.<span class="property">translucency</span>.<span class="property">enabled</span> = <span class="literal">true</span></span><br><span class="line">scene.<span class="property">globe</span>.<span class="property">translucency</span>.<span class="property">frontFaceAlpha</span> = <span class="number">0.5</span></span><br><span class="line">scene.<span class="property">globe</span>.<span class="property">translucency</span>.<span class="property">backFaceAlpha</span> = <span class="number">0.1</span></span><br></pre></td></tr></table></figure>

<h2 id="数据源详解"><a href="#数据源详解" class="headerlink" title="数据源详解"></a>数据源详解</h2><h3 id="DataSource-数据源"><a href="#DataSource-数据源" class="headerlink" title="DataSource 数据源"></a>DataSource 数据源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DataSource - 数据源基类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="comment">// name: string</span></span><br><span class="line">    <span class="comment">// 作用: 数据源名称</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line"></span><br><span class="line">    <span class="comment">// show: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否显示</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// entities: EntityCollection</span></span><br><span class="line">    <span class="comment">// 作用: 实体集合</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">entities</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">EntityCollection</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// isLoading: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否正在加载</span></span><br><span class="line">    <span class="comment">// 只读: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// changedEvent: Event</span></span><br><span class="line">    <span class="comment">// 作用: 变化事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">changedEvent</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// errorEvent: Event</span></span><br><span class="line">    <span class="comment">// 作用: 错误事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">errorEvent</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// loadingEvent: Event</span></span><br><span class="line">    <span class="comment">// 作用: 加载事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loadingEvent</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// clock: DataSourceClock</span></span><br><span class="line">    <span class="comment">// 作用: 数据源时钟</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clock</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clustering: EntityCluster</span></span><br><span class="line">    <span class="comment">// 作用: 实体聚类</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clustering</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">EntityCluster</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// update - 更新数据源</span></span><br><span class="line">  <span class="title function_">update</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="comment">// time: JulianDate - 当前时间</span></span><br><span class="line">    <span class="comment">// 返回: boolean - 是否需要渲染</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CzmlDataSource - CZML数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CzmlDataSource</span> <span class="keyword">extends</span> <span class="title class_ inherited__">DataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// load - 加载CZML数据</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">load</span>(<span class="params">czml, options</span>) &#123;</span><br><span class="line">    <span class="comment">// czml: Object | string | Resource</span></span><br><span class="line">    <span class="comment">// 作用: CZML数据</span></span><br><span class="line">    <span class="comment">// options: Object</span></span><br><span class="line">    <span class="comment">// sourceUri: string - 源URI</span></span><br><span class="line">    <span class="comment">// credit: Credit - 版权信息</span></span><br><span class="line">    <span class="comment">// 返回: Promise&lt;CzmlDataSource&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// process - 处理CZML数据</span></span><br><span class="line">  <span class="title function_">process</span>(<span class="params">czml, options</span>) &#123;</span><br><span class="line">    <span class="comment">// czml: Object | string</span></span><br><span class="line">    <span class="comment">// 作用: CZML数据</span></span><br><span class="line">    <span class="comment">// options: Object</span></span><br><span class="line">    <span class="comment">// sourceUri: string - 源URI</span></span><br><span class="line">    <span class="comment">// isUpdating: boolean - 是否更新模式</span></span><br><span class="line">    <span class="comment">// 返回: Promise&lt;CzmlDataSource&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GeoJsonDataSource - GeoJSON数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GeoJsonDataSource</span> <span class="keyword">extends</span> <span class="title class_ inherited__">DataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// markerSize: number</span></span><br><span class="line">    <span class="comment">// 作用: 标记大小</span></span><br><span class="line">    <span class="comment">// 默认: 48</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">markerSize</span> = <span class="number">48</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// markerSymbol: string</span></span><br><span class="line">    <span class="comment">// 作用: 标记符号</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">markerSymbol</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// markerColor: Color</span></span><br><span class="line">    <span class="comment">// 作用: 标记颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.ROYALBLUE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">markerColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">ROYALBLUE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// stroke: Color</span></span><br><span class="line">    <span class="comment">// 作用: 描边颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.YELLOW</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stroke</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// strokeWidth: number</span></span><br><span class="line">    <span class="comment">// 作用: 描边宽度</span></span><br><span class="line">    <span class="comment">// 默认: 2</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">strokeWidth</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fill: Color</span></span><br><span class="line">    <span class="comment">// 作用: 填充颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.YELLOW.withAlpha(0.5)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fill</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>.<span class="title function_">withAlpha</span>(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// clampToGround: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否贴地</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clampToGround</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// load - 加载GeoJSON数据</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">load</span>(<span class="params">data, options</span>) &#123;</span><br><span class="line">    <span class="comment">// data: Resource | string | Object</span></span><br><span class="line">    <span class="comment">// 作用: GeoJSON数据</span></span><br><span class="line">    <span class="comment">// options: Object</span></span><br><span class="line">    <span class="comment">// sourceUri: string - 源URI</span></span><br><span class="line">    <span class="comment">// markerSize: number - 标记大小</span></span><br><span class="line">    <span class="comment">// markerSymbol: string - 标记符号</span></span><br><span class="line">    <span class="comment">// markerColor: Color - 标记颜色</span></span><br><span class="line">    <span class="comment">// stroke: Color - 描边颜色</span></span><br><span class="line">    <span class="comment">// strokeWidth: number - 描边宽度</span></span><br><span class="line">    <span class="comment">// fill: Color - 填充颜色</span></span><br><span class="line">    <span class="comment">// clampToGround: boolean - 是否贴地</span></span><br><span class="line">    <span class="comment">// credit: Credit - 版权信息</span></span><br><span class="line">    <span class="comment">// 返回: Promise&lt;GeoJsonDataSource&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// KmlDataSource - KML数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">KmlDataSource</span> <span class="keyword">extends</span> <span class="title class_ inherited__">DataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// refreshEvent: Event</span></span><br><span class="line">    <span class="comment">// 作用: 刷新事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">refreshEvent</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// unsupportedNodeEvent: Event</span></span><br><span class="line">    <span class="comment">// 作用: 不支持节点事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">unsupportedNodeEvent</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// load - 加载KML数据</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">load</span>(<span class="params">data, options</span>) &#123;</span><br><span class="line">    <span class="comment">// data: Resource | string | Document | Blob</span></span><br><span class="line">    <span class="comment">// 作用: KML数据</span></span><br><span class="line">    <span class="comment">// options: Object</span></span><br><span class="line">    <span class="comment">// sourceUri: string - 源URI</span></span><br><span class="line">    <span class="comment">// clampToGround: boolean - 是否贴地</span></span><br><span class="line">    <span class="comment">// ellipsoid: Ellipsoid - 椭球体</span></span><br><span class="line">    <span class="comment">// credit: Credit - 版权信息</span></span><br><span class="line">    <span class="comment">// 返回: Promise&lt;KmlDataSource&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GpxDataSource - GPX数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GpxDataSource</span> <span class="keyword">extends</span> <span class="title class_ inherited__">DataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// trackColor: Color</span></span><br><span class="line">    <span class="comment">// 作用: 轨迹颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.YELLOW</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">trackColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// routeColor: Color</span></span><br><span class="line">    <span class="comment">// 作用: 路线颜色</span></span><br><span class="line">    <span class="comment">// 默认: Color.ORANGE</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">routeColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">ORANGE</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// waypointImage: string</span></span><br><span class="line">    <span class="comment">// 作用: 路点图像</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">waypointImage</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// clampToGround: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否贴地</span></span><br><span class="line">    <span class="comment">// 默认: false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clampToGround</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// load - 加载GPX数据</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">load</span>(<span class="params">data, options</span>) &#123;</span><br><span class="line">    <span class="comment">// data: Resource | string | Document | Blob</span></span><br><span class="line">    <span class="comment">// 作用: GPX数据</span></span><br><span class="line">    <span class="comment">// options: Object</span></span><br><span class="line">    <span class="comment">// 返回: Promise&lt;GpxDataSource&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CustomDataSource - 自定义数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomDataSource</span> <span class="keyword">extends</span> <span class="title class_ inherited__">DataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据源使用示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. CZML数据源</span></span><br><span class="line"><span class="keyword">const</span> czmlData = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;document&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;CZML示例&#x27;</span>,</span><br><span class="line">    <span class="attr">version</span>: <span class="string">&#x27;1.0&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;satellite&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;卫星&#x27;</span>,</span><br><span class="line">    <span class="attr">availability</span>: <span class="string">&#x27;2023-01-01T00:00:00Z/2023-01-02T00:00:00Z&#x27;</span>,</span><br><span class="line">    <span class="attr">position</span>: &#123;</span><br><span class="line">      <span class="attr">epoch</span>: <span class="string">&#x27;2023-01-01T00:00:00Z&#x27;</span>,</span><br><span class="line">      <span class="attr">cartographicDegrees</span>: [<span class="number">0</span>, <span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">400000</span>, <span class="number">3600</span>, <span class="number">121.4737</span>, <span class="number">31.2304</span>, <span class="number">400000</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">billboard</span>: &#123;</span><br><span class="line">      <span class="attr">image</span>:</span><br><span class="line">        <span class="string">&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==&#x27;</span>,</span><br><span class="line">      <span class="attr">scale</span>: <span class="number">2.0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">path</span>: &#123;</span><br><span class="line">      <span class="attr">material</span>: &#123;</span><br><span class="line">        <span class="attr">polylineOutline</span>: &#123;</span><br><span class="line">          <span class="attr">color</span>: &#123; <span class="attr">rgba</span>: [<span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>] &#125;,</span><br><span class="line">          <span class="attr">outlineColor</span>: &#123; <span class="attr">rgba</span>: [<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>] &#125;,</span><br><span class="line">          <span class="attr">outlineWidth</span>: <span class="number">5</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">width</span>: <span class="number">8</span>,</span><br><span class="line">      <span class="attr">leadTime</span>: <span class="number">10</span>,</span><br><span class="line">      <span class="attr">trailTime</span>: <span class="number">1000</span>,</span><br><span class="line">      <span class="attr">resolution</span>: <span class="number">5</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="title class_">Cesium</span>.<span class="property">CzmlDataSource</span>.<span class="title function_">load</span>(czmlData).<span class="title function_">then</span>(<span class="function">(<span class="params">dataSource</span>) =&gt;</span> &#123;</span><br><span class="line">  viewer.<span class="property">dataSources</span>.<span class="title function_">add</span>(dataSource)</span><br><span class="line">  viewer.<span class="title function_">zoomTo</span>(dataSource)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. GeoJSON数据源</span></span><br><span class="line"><span class="keyword">const</span> geoJsonData = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;FeatureCollection&#x27;</span>,</span><br><span class="line">  <span class="attr">features</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">      <span class="attr">properties</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;北京市&#x27;</span>,</span><br><span class="line">        <span class="attr">population</span>: <span class="number">21540000</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">geometry</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Point&#x27;</span>,</span><br><span class="line">        <span class="attr">coordinates</span>: [<span class="number">116.4074</span>, <span class="number">39.9042</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">      <span class="attr">properties</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;故宫&#x27;</span>,</span><br><span class="line">        <span class="attr">area</span>: <span class="number">720000</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">geometry</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Polygon&#x27;</span>,</span><br><span class="line">        <span class="attr">coordinates</span>: [</span><br><span class="line">          [</span><br><span class="line">            [<span class="number">116.3906</span>, <span class="number">39.9097</span>],</span><br><span class="line">            [<span class="number">116.3971</span>, <span class="number">39.9097</span>],</span><br><span class="line">            [<span class="number">116.3971</span>, <span class="number">39.9208</span>],</span><br><span class="line">            [<span class="number">116.3906</span>, <span class="number">39.9208</span>],</span><br><span class="line">            [<span class="number">116.3906</span>, <span class="number">39.9097</span>],</span><br><span class="line">          ],</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Cesium</span>.<span class="property">GeoJsonDataSource</span>.<span class="title function_">load</span>(geoJsonData, &#123;</span><br><span class="line">  <span class="attr">markerSize</span>: <span class="number">64</span>,</span><br><span class="line">  <span class="attr">markerColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span>,</span><br><span class="line">  <span class="attr">stroke</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>,</span><br><span class="line">  <span class="attr">strokeWidth</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">fill</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLUE</span>.<span class="title function_">withAlpha</span>(<span class="number">0.3</span>),</span><br><span class="line">  <span class="attr">clampToGround</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">dataSource</span>) =&gt;</span> &#123;</span><br><span class="line">  viewer.<span class="property">dataSources</span>.<span class="title function_">add</span>(dataSource)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义样式</span></span><br><span class="line">  <span class="keyword">const</span> entities = dataSource.<span class="property">entities</span>.<span class="property">values</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; entities.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> entity = entities[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entity.<span class="property">billboard</span>) &#123;</span><br><span class="line">      <span class="comment">// 自定义点样式</span></span><br><span class="line">      entity.<span class="property">billboard</span>.<span class="property">image</span> = <span class="title function_">createCustomIcon</span>(entity.<span class="property">properties</span>.<span class="property">name</span>)</span><br><span class="line">      entity.<span class="property">billboard</span>.<span class="property">scale</span> = <span class="number">1.5</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entity.<span class="property">polygon</span>) &#123;</span><br><span class="line">      <span class="comment">// 自定义多边形样式</span></span><br><span class="line">      entity.<span class="property">polygon</span>.<span class="property">material</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="title function_">fromCssColorString</span>(<span class="string">&#x27;#ff6b6b&#x27;</span>).<span class="title function_">withAlpha</span>(<span class="number">0.4</span>)</span><br><span class="line">      entity.<span class="property">polygon</span>.<span class="property">outline</span> = <span class="literal">true</span></span><br><span class="line">      entity.<span class="property">polygon</span>.<span class="property">outlineColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="title function_">fromCssColorString</span>(<span class="string">&#x27;#ff4757&#x27;</span>)</span><br><span class="line">      entity.<span class="property">polygon</span>.<span class="property">height</span> = <span class="number">50</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加标签</span></span><br><span class="line">    entity.<span class="property">label</span> = &#123;</span><br><span class="line">      <span class="attr">text</span>: entity.<span class="property">properties</span>.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">font</span>: <span class="string">&#x27;16pt Microsoft YaHei&#x27;</span>,</span><br><span class="line">      <span class="attr">fillColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>,</span><br><span class="line">      <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">      <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">style</span>: <span class="title class_">Cesium</span>.<span class="property">LabelStyle</span>.<span class="property">FILL_AND_OUTLINE</span>,</span><br><span class="line">      <span class="attr">pixelOffset</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">0</span>, -<span class="number">50</span>),</span><br><span class="line">      <span class="attr">showBackground</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">backgroundColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>.<span class="title function_">withAlpha</span>(<span class="number">0.7</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. KML数据源（从文件加载）</span></span><br><span class="line"><span class="title class_">Cesium</span>.<span class="property">KmlDataSource</span>.<span class="title function_">load</span>(<span class="string">&#x27;./data/sample.kml&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">clampToGround</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">dataSource</span>) =&gt;</span> &#123;</span><br><span class="line">  viewer.<span class="property">dataSources</span>.<span class="title function_">add</span>(dataSource)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听不支持的KML节点</span></span><br><span class="line">  dataSource.<span class="property">unsupportedNodeEvent</span>.<span class="title function_">addEventListener</span>(</span><br><span class="line">    <span class="function">(<span class="params">dataSource, parentEntity, node, entityCollection, styleCollection</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;不支持的KML节点:&#x27;</span>, node.<span class="property">nodeName</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 自定义数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RealtimeDataSource</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Cesium.CustomDataSource</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(<span class="string">&#x27;实时数据&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_timer</span> = <span class="literal">undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_isLoading</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 开始实时数据更新</span></span><br><span class="line">  <span class="title function_">startRealtime</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateData</span>()</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 停止实时数据更新</span></span><br><span class="line">  <span class="title function_">stopRealtime</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_timer</span>) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">_timer</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_timer</span> = <span class="literal">undefined</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新数据</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">updateData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_isLoading</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_isLoading</span> = <span class="literal">true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loadingEvent</span>.<span class="title function_">raiseEvent</span>(<span class="variable language_">this</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 模拟从API获取数据</span></span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/realtime-data&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>()</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 更新实体</span></span><br><span class="line">      data.<span class="property">vehicles</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">vehicle</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> entity = <span class="variable language_">this</span>.<span class="property">entities</span>.<span class="title function_">getById</span>(vehicle.<span class="property">id</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!entity) &#123;</span><br><span class="line">          <span class="comment">// 创建新实体</span></span><br><span class="line">          entity = <span class="variable language_">this</span>.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">            <span class="attr">id</span>: vehicle.<span class="property">id</span>,</span><br><span class="line">            <span class="attr">name</span>: vehicle.<span class="property">name</span>,</span><br><span class="line">            <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(vehicle.<span class="property">lon</span>, vehicle.<span class="property">lat</span>, vehicle.<span class="property">alt</span>),</span><br><span class="line">            <span class="attr">billboard</span>: &#123;</span><br><span class="line">              <span class="attr">image</span>: <span class="string">&#x27;./icons/vehicle.png&#x27;</span>,</span><br><span class="line">              <span class="attr">scale</span>: <span class="number">1.0</span>,</span><br><span class="line">              <span class="attr">verticalOrigin</span>: <span class="title class_">Cesium</span>.<span class="property">VerticalOrigin</span>.<span class="property">BOTTOM</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">label</span>: &#123;</span><br><span class="line">              <span class="attr">text</span>: vehicle.<span class="property">name</span>,</span><br><span class="line">              <span class="attr">font</span>: <span class="string">&#x27;12pt sans-serif&#x27;</span>,</span><br><span class="line">              <span class="attr">pixelOffset</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">0</span>, -<span class="number">40</span>),</span><br><span class="line">              <span class="attr">fillColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span>,</span><br><span class="line">              <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">              <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line">              <span class="attr">style</span>: <span class="title class_">Cesium</span>.<span class="property">LabelStyle</span>.<span class="property">FILL_AND_OUTLINE</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 更新位置</span></span><br><span class="line">          entity.<span class="property">position</span> = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(vehicle.<span class="property">lon</span>, vehicle.<span class="property">lat</span>, vehicle.<span class="property">alt</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 更新属性</span></span><br><span class="line">        entity.<span class="property">description</span> = <span class="string">`</span></span><br><span class="line"><span class="string">          &lt;div&gt;</span></span><br><span class="line"><span class="string">            &lt;h3&gt;<span class="subst">$&#123;vehicle.name&#125;</span>&lt;/h3&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;速度: <span class="subst">$&#123;vehicle.speed&#125;</span> km/h&lt;/p&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;方向: <span class="subst">$&#123;vehicle.heading&#125;</span>°&lt;/p&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;更新时间: <span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>(vehicle.timestamp).toLocaleString()&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt;</span></span><br><span class="line"><span class="string">        `</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">changedEvent</span>.<span class="title function_">raiseEvent</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;更新实时数据失败:&#x27;</span>, error)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">errorEvent</span>.<span class="title function_">raiseEvent</span>(<span class="variable language_">this</span>, error)</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_isLoading</span> = <span class="literal">false</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">loadingEvent</span>.<span class="title function_">raiseEvent</span>(<span class="variable language_">this</span>, <span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用自定义数据源</span></span><br><span class="line"><span class="keyword">const</span> realtimeDataSource = <span class="keyword">new</span> <span class="title class_">RealtimeDataSource</span>()</span><br><span class="line">viewer.<span class="property">dataSources</span>.<span class="title function_">add</span>(realtimeDataSource)</span><br><span class="line">realtimeDataSource.<span class="title function_">startRealtime</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 数据源管理</span></span><br><span class="line"><span class="keyword">const</span> dataSources = viewer.<span class="property">dataSources</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加数据源</span></span><br><span class="line">dataSources.<span class="title function_">add</span>(dataSource)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除数据源</span></span><br><span class="line">dataSources.<span class="title function_">remove</span>(dataSource)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据源</span></span><br><span class="line"><span class="keyword">const</span> firstDataSource = dataSources.<span class="title function_">get</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> dataSourceByName = dataSources.<span class="title function_">getByName</span>(<span class="string">&#x27;实时数据&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 显示/隐藏数据源</span></span><br><span class="line">dataSource.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听数据源变化</span></span><br><span class="line">dataSources.<span class="property">dataSourceAdded</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">collection, dataSource</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;添加数据源:&#x27;</span>, dataSource.<span class="property">name</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">dataSources.<span class="property">dataSourceRemoved</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">collection, dataSource</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;移除数据源:&#x27;</span>, dataSource.<span class="property">name</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 实体聚类</span></span><br><span class="line"><span class="keyword">const</span> clustering = dataSource.<span class="property">clustering</span></span><br><span class="line">clustering.<span class="property">enabled</span> = <span class="literal">true</span></span><br><span class="line">clustering.<span class="property">pixelRange</span> = <span class="number">15</span></span><br><span class="line">clustering.<span class="property">minimumClusterSize</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义聚类样式</span></span><br><span class="line">clustering.<span class="property">clusterBillboards</span> = <span class="literal">false</span></span><br><span class="line">clustering.<span class="property">clusterLabels</span> = <span class="literal">false</span></span><br><span class="line">clustering.<span class="property">clusterPoints</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 聚类事件</span></span><br><span class="line">clustering.<span class="property">clusterEvent</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">clusteredEntities, cluster</span>) =&gt;</span> &#123;</span><br><span class="line">  cluster.<span class="property">billboard</span>.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">text</span> = clusteredEntities.<span class="property">length</span>.<span class="title function_">toString</span>()</span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">font</span> = <span class="string">&#x27;16pt sans-serif&#x27;</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">fillColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">WHITE</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">outlineColor</span> = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">outlineWidth</span> = <span class="number">2</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">style</span> = <span class="title class_">Cesium</span>.<span class="property">LabelStyle</span>.<span class="property">FILL_AND_OUTLINE</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加自定义点</span></span><br><span class="line">  cluster.<span class="property">point</span> = &#123;</span><br><span class="line">    <span class="attr">pixelSize</span>: <span class="number">30</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">CYAN</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">    <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createCustomIcon</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="comment">// 创建自定义图标</span></span><br><span class="line">  <span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;canvas&#x27;</span>)</span><br><span class="line">  canvas.<span class="property">width</span> = <span class="number">64</span></span><br><span class="line">  canvas.<span class="property">height</span> = <span class="number">64</span></span><br><span class="line">  <span class="keyword">const</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&#x27;2d&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绘制背景圆</span></span><br><span class="line">  ctx.<span class="property">fillStyle</span> = <span class="string">&#x27;#ff6b6b&#x27;</span></span><br><span class="line">  ctx.<span class="title function_">beginPath</span>()</span><br><span class="line">  ctx.<span class="title function_">arc</span>(<span class="number">32</span>, <span class="number">32</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span>)</span><br><span class="line">  ctx.<span class="title function_">fill</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绘制边框</span></span><br><span class="line">  ctx.<span class="property">strokeStyle</span> = <span class="string">&#x27;#ff4757&#x27;</span></span><br><span class="line">  ctx.<span class="property">lineWidth</span> = <span class="number">3</span></span><br><span class="line">  ctx.<span class="title function_">stroke</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绘制文字</span></span><br><span class="line">  ctx.<span class="property">fillStyle</span> = <span class="string">&#x27;white&#x27;</span></span><br><span class="line">  ctx.<span class="property">font</span> = <span class="string">&#x27;12px Arial&#x27;</span></span><br><span class="line">  ctx.<span class="property">textAlign</span> = <span class="string">&#x27;center&#x27;</span></span><br><span class="line">  ctx.<span class="title function_">fillText</span>(name.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">2</span>), <span class="number">32</span>, <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> canvas.<span class="title function_">toDataURL</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="时间系统详解"><a href="#时间系统详解" class="headerlink" title="时间系统详解"></a>时间系统详解</h2><h3 id="JulianDate-儒略日期"><a href="#JulianDate-儒略日期" class="headerlink" title="JulianDate 儒略日期"></a>JulianDate 儒略日期</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JulianDate - 儒略日期类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JulianDate</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">julianDayNumber, secondsOfDay, timeStandard</span>) &#123;</span><br><span class="line">    <span class="comment">// julianDayNumber: number</span></span><br><span class="line">    <span class="comment">// 作用: 儒略日数</span></span><br><span class="line">    <span class="comment">// 默认: 0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">julianDayNumber</span> = julianDayNumber || <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// secondsOfDay: number</span></span><br><span class="line">    <span class="comment">// 作用: 一天中的秒数</span></span><br><span class="line">    <span class="comment">// 默认: 0.0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">secondsOfDay</span> = secondsOfDay || <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// timeStandard: TimeStandard</span></span><br><span class="line">    <span class="comment">// 作用: 时间标准</span></span><br><span class="line">    <span class="comment">// 默认: TimeStandard.UTC</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timeStandard</span> = timeStandard || <span class="title class_">Cesium</span>.<span class="property">TimeStandard</span>.<span class="property">UTC</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// now - 获取当前时间</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">now</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="comment">// result: JulianDate - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: JulianDate</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>(result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromDate - 从JavaScript Date创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromDate</span>(<span class="params">date, result</span>) &#123;</span><br><span class="line">    <span class="comment">// date: Date - JavaScript日期对象</span></span><br><span class="line">    <span class="comment">// result: JulianDate - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: JulianDate</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromDate</span>(date, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fromIso8601 - 从ISO 8601字符串创建</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">fromIso8601</span>(<span class="params">iso8601String, result</span>) &#123;</span><br><span class="line">    <span class="comment">// iso8601String: string - ISO 8601格式字符串</span></span><br><span class="line">    <span class="comment">// 例如: &quot;2023-01-01T12:00:00Z&quot;</span></span><br><span class="line">    <span class="comment">// result: JulianDate - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: JulianDate</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(iso8601String, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// toDate - 转换为JavaScript Date</span></span><br><span class="line">  <span class="title function_">toDate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 返回: Date</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toDate</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// toIso8601 - 转换为ISO 8601字符串</span></span><br><span class="line">  <span class="title function_">toIso8601</span>(<span class="params">precision</span>) &#123;</span><br><span class="line">    <span class="comment">// precision: number - 精度（小数位数）</span></span><br><span class="line">    <span class="comment">// 返回: string</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toIso8601</span>(<span class="variable language_">this</span>, precision)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addSeconds - 添加秒数</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">addSeconds</span>(<span class="params">julianDate, seconds, result</span>) &#123;</span><br><span class="line">    <span class="comment">// julianDate: JulianDate - 儒略日期</span></span><br><span class="line">    <span class="comment">// seconds: number - 秒数</span></span><br><span class="line">    <span class="comment">// result: JulianDate - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: JulianDate</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(julianDate, seconds, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addMinutes - 添加分钟数</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">addMinutes</span>(<span class="params">julianDate, minutes, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addMinutes</span>(julianDate, minutes, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addHours - 添加小时数</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">addHours</span>(<span class="params">julianDate, hours, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addHours</span>(julianDate, hours, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// addDays - 添加天数</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">addDays</span>(<span class="params">julianDate, days, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addDays</span>(julianDate, days, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// secondsDifference - 计算秒数差</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">secondsDifference</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line">    <span class="comment">// left: JulianDate - 左操作数</span></span><br><span class="line">    <span class="comment">// right: JulianDate - 右操作数</span></span><br><span class="line">    <span class="comment">// 返回: number - 秒数差 (left - right)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(left, right)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// daysDifference - 计算天数差</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">daysDifference</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">daysDifference</span>(left, right)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// compare - 比较两个日期</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">compare</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回: number</span></span><br><span class="line">    <span class="comment">// -1: left &lt; right</span></span><br><span class="line">    <span class="comment">//  0: left === right</span></span><br><span class="line">    <span class="comment">//  1: left &gt; right</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">compare</span>(left, right)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// equals - 判断相等</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">equals</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回: boolean</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">equals</span>(left, right)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// equalsEpsilon - 在指定精度内判断相等</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">equalsEpsilon</span>(<span class="params">left, right, epsilon</span>) &#123;</span><br><span class="line">    <span class="comment">// epsilon: number - 误差范围（秒）</span></span><br><span class="line">    <span class="comment">// 返回: boolean</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">equalsEpsilon</span>(left, right, epsilon)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// clone - 克隆</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">clone</span>(<span class="params">julianDate, result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">clone</span>(julianDate, result)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TimeInterval - 时间间隔</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeInterval</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// start: JulianDate</span></span><br><span class="line">    <span class="comment">// 作用: 开始时间</span></span><br><span class="line">    <span class="comment">// 默认: new JulianDate()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">start</span> = options.<span class="property">start</span> || <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// stop: JulianDate</span></span><br><span class="line">    <span class="comment">// 作用: 结束时间</span></span><br><span class="line">    <span class="comment">// 默认: new JulianDate()</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stop</span> = options.<span class="property">stop</span> || <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// isStartIncluded: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否包含开始时间</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isStartIncluded</span> = options.<span class="property">isStartIncluded</span> !== <span class="literal">undefined</span> ? options.<span class="property">isStartIncluded</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// isStopIncluded: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否包含结束时间</span></span><br><span class="line">    <span class="comment">// 默认: true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isStopIncluded</span> = options.<span class="property">isStopIncluded</span> !== <span class="literal">undefined</span> ? options.<span class="property">isStopIncluded</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// data: Object</span></span><br><span class="line">    <span class="comment">// 作用: 关联数据</span></span><br><span class="line">    <span class="comment">// 默认: undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span> = options.<span class="property">data</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// contains - 是否包含指定时间</span></span><br><span class="line">  <span class="title function_">contains</span>(<span class="params">julianDate</span>) &#123;</span><br><span class="line">    <span class="comment">// julianDate: JulianDate - 要检查的时间</span></span><br><span class="line">    <span class="comment">// 返回: boolean</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">TimeInterval</span>.<span class="title function_">contains</span>(<span class="variable language_">this</span>, julianDate)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// intersect - 求交集</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">intersect</span>(<span class="params">left, right, result</span>) &#123;</span><br><span class="line">    <span class="comment">// left: TimeInterval - 左间隔</span></span><br><span class="line">    <span class="comment">// right: TimeInterval - 右间隔</span></span><br><span class="line">    <span class="comment">// result: TimeInterval - 结果对象</span></span><br><span class="line">    <span class="comment">// 返回: TimeInterval</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">TimeInterval</span>.<span class="title function_">intersect</span>(left, right, result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// isEmpty - 是否为空间隔</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">isEmpty</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">TimeInterval</span>.<span class="title function_">isEmpty</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TimeIntervalCollection - 时间间隔集合</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeIntervalCollection</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">intervals</span>) &#123;</span><br><span class="line">    <span class="comment">// intervals: Array&lt;TimeInterval&gt; - 时间间隔数组</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_intervals</span> = intervals || []</span><br><span class="line"></span><br><span class="line">    <span class="comment">// changed: Event</span></span><br><span class="line">    <span class="comment">// 作用: 集合变化事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">changed</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Event</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// changedEventHelper: EventHelper</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">changedEventHelper</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">EventHelper</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 属性</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// start: JulianDate</span></span><br><span class="line">  <span class="comment">// 作用: 第一个间隔的开始时间</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">start</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="variable language_">this</span>.<span class="property">_intervals</span>[<span class="number">0</span>].<span class="property">start</span> : <span class="literal">undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// stop: JulianDate</span></span><br><span class="line">  <span class="comment">// 作用: 最后一个间隔的结束时间</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">stop</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="variable language_">this</span>.<span class="property">_intervals</span>[<span class="variable language_">this</span>.<span class="property">length</span> - <span class="number">1</span>].<span class="property">stop</span> : <span class="literal">undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// length: number</span></span><br><span class="line">  <span class="comment">// 作用: 间隔数量</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">length</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="property">length</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// isEmpty: boolean</span></span><br><span class="line">  <span class="comment">// 作用: 是否为空集合</span></span><br><span class="line">  <span class="comment">// 只读: true</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">isEmpty</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">length</span> === <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// addInterval - 添加间隔</span></span><br><span class="line">  <span class="title function_">addInterval</span>(<span class="params">interval, dataComparer</span>) &#123;</span><br><span class="line">    <span class="comment">// interval: TimeInterval - 要添加的间隔</span></span><br><span class="line">    <span class="comment">// dataComparer: function - 数据比较函数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="title function_">push</span>(interval)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">changed</span>.<span class="title function_">raiseEvent</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// removeInterval - 移除间隔</span></span><br><span class="line">  <span class="title function_">removeInterval</span>(<span class="params">interval</span>) &#123;</span><br><span class="line">    <span class="comment">// interval: TimeInterval - 要移除的间隔</span></span><br><span class="line">    <span class="keyword">const</span> index = <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="title function_">indexOf</span>(interval)</span><br><span class="line">    <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">changed</span>.<span class="title function_">raiseEvent</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// contains - 是否包含指定时间</span></span><br><span class="line">  <span class="title function_">contains</span>(<span class="params">julianDate</span>) &#123;</span><br><span class="line">    <span class="comment">// julianDate: JulianDate - 要检查的时间</span></span><br><span class="line">    <span class="comment">// 返回: boolean</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="title function_">some</span>(<span class="function">(<span class="params">interval</span>) =&gt;</span> interval.<span class="title function_">contains</span>(julianDate))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// findInterval - 查找包含指定时间的间隔</span></span><br><span class="line">  <span class="title function_">findInterval</span>(<span class="params">julianDate</span>) &#123;</span><br><span class="line">    <span class="comment">// julianDate: JulianDate - 要查找的时间</span></span><br><span class="line">    <span class="comment">// 返回: TimeInterval | undefined</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">interval</span>) =&gt;</span> interval.<span class="title function_">contains</span>(julianDate))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// findDataForIntervalContainingDate - 查找包含指定时间的间隔数据</span></span><br><span class="line">  <span class="title function_">findDataForIntervalContainingDate</span>(<span class="params">julianDate</span>) &#123;</span><br><span class="line">    <span class="comment">// julianDate: JulianDate - 要查找的时间</span></span><br><span class="line">    <span class="comment">// 返回: Object | undefined</span></span><br><span class="line">    <span class="keyword">const</span> interval = <span class="variable language_">this</span>.<span class="title function_">findInterval</span>(julianDate)</span><br><span class="line">    <span class="keyword">return</span> interval ? interval.<span class="property">data</span> : <span class="literal">undefined</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get - 获取指定索引的间隔</span></span><br><span class="line">  <span class="title function_">get</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    <span class="comment">// index: number - 索引</span></span><br><span class="line">    <span class="comment">// 返回: TimeInterval</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_intervals</span>[index]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// removeAll - 移除所有间隔</span></span><br><span class="line">  <span class="title function_">removeAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_intervals</span>.<span class="property">length</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">changed</span>.<span class="title function_">raiseEvent</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// intersect - 求与另一个集合的交集</span></span><br><span class="line">  <span class="title function_">intersect</span>(<span class="params">other, dataComparer, mergeCallback</span>) &#123;</span><br><span class="line">    <span class="comment">// other: TimeIntervalCollection - 另一个集合</span></span><br><span class="line">    <span class="comment">// dataComparer: function - 数据比较函数</span></span><br><span class="line">    <span class="comment">// mergeCallback: function - 合并回调</span></span><br><span class="line">    <span class="comment">// 返回: TimeIntervalCollection</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间系统使用示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 基础时间操作</span></span><br><span class="line"><span class="keyword">const</span> now = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;当前时间:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toDate</span>(now))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从不同格式创建时间</span></span><br><span class="line"><span class="keyword">const</span> fromDate = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2023-01-01T12:00:00Z&#x27;</span>))</span><br><span class="line"><span class="keyword">const</span> fromIso = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T12:00:00Z&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fromComponents = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>(<span class="number">2459945</span>, <span class="number">43200</span>) <span class="comment">// 2023-01-01 12:00:00 UTC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间运算</span></span><br><span class="line"><span class="keyword">const</span> futureTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addHours</span>(now, <span class="number">24</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>())</span><br><span class="line"><span class="keyword">const</span> pastTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addDays</span>(now, -<span class="number">7</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间差计算</span></span><br><span class="line"><span class="keyword">const</span> secondsDiff = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(futureTime, now)</span><br><span class="line"><span class="keyword">const</span> daysDiff = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">daysDifference</span>(futureTime, now)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`未来时间相差 <span class="subst">$&#123;secondsDiff&#125;</span> 秒，<span class="subst">$&#123;daysDiff&#125;</span> 天`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间比较</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">compare</span>(futureTime, now) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;futureTime 在 now 之后&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 时间间隔操作</span></span><br><span class="line"><span class="keyword">const</span> interval1 = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">  <span class="attr">start</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T00:00:00Z&#x27;</span>),</span><br><span class="line">  <span class="attr">stop</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T12:00:00Z&#x27;</span>),</span><br><span class="line">  <span class="attr">data</span>: &#123; <span class="attr">period</span>: <span class="string">&#x27;上午&#x27;</span> &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> interval2 = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">  <span class="attr">start</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T12:00:00Z&#x27;</span>),</span><br><span class="line">  <span class="attr">stop</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-02T00:00:00Z&#x27;</span>),</span><br><span class="line">  <span class="attr">data</span>: &#123; <span class="attr">period</span>: <span class="string">&#x27;下午&#x27;</span> &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查时间是否在间隔内</span></span><br><span class="line"><span class="keyword">const</span> testTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T10:00:00Z&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;测试时间在interval1内:&#x27;</span>, interval1.<span class="title function_">contains</span>(testTime))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 求交集</span></span><br><span class="line"><span class="keyword">const</span> intersection = <span class="title class_">Cesium</span>.<span class="property">TimeInterval</span>.<span class="title function_">intersect</span>(interval1, interval2, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;交集是否为空:&#x27;</span>, intersection.<span class="property">isEmpty</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 时间间隔集合</span></span><br><span class="line"><span class="keyword">const</span> collection = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeIntervalCollection</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加多个间隔</span></span><br><span class="line">collection.<span class="title function_">addInterval</span>(interval1)</span><br><span class="line">collection.<span class="title function_">addInterval</span>(interval2)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加更多间隔（模拟一天的时间段）</span></span><br><span class="line"><span class="keyword">const</span> hourlyIntervals = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> hour = <span class="number">0</span>; hour &lt; <span class="number">24</span>; hour++) &#123;</span><br><span class="line">  <span class="keyword">const</span> startTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(</span><br><span class="line">    <span class="string">`2023-01-01T<span class="subst">$&#123;hour.toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)&#125;</span>:00:00Z`</span>,</span><br><span class="line">  )</span><br><span class="line">  <span class="keyword">const</span> stopTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addHours</span>(startTime, <span class="number">1</span>, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> interval = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">    <span class="attr">start</span>: startTime,</span><br><span class="line">    <span class="attr">stop</span>: stopTime,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">hour</span>: hour,</span><br><span class="line">      <span class="attr">period</span>: hour &lt; <span class="number">6</span> ? <span class="string">&#x27;凌晨&#x27;</span> : hour &lt; <span class="number">12</span> ? <span class="string">&#x27;上午&#x27;</span> : hour &lt; <span class="number">18</span> ? <span class="string">&#x27;下午&#x27;</span> : <span class="string">&#x27;晚上&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  collection.<span class="title function_">addInterval</span>(interval)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找特定时间的数据</span></span><br><span class="line"><span class="keyword">const</span> queryTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T15:30:00Z&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> intervalData = collection.<span class="title function_">findDataForIntervalContainingDate</span>(queryTime)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;15:30的时间段数据:&#x27;</span>, intervalData)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听集合变化</span></span><br><span class="line">collection.<span class="property">changed</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;时间间隔集合发生变化，当前包含&#x27;</span>, collection.<span class="property">length</span>, <span class="string">&#x27;个间隔&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 实体可用性时间</span></span><br><span class="line"><span class="keyword">const</span> entity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;限时显示的实体&#x27;</span>,</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="attr">point</span>: &#123;</span><br><span class="line">    <span class="attr">pixelSize</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 设置可用性时间</span></span><br><span class="line">  <span class="attr">availability</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeIntervalCollection</span>([</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">TimeInterval</span>(&#123;</span><br><span class="line">      <span class="attr">start</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T08:00:00Z&#x27;</span>),</span><br><span class="line">      <span class="attr">stop</span>: <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T18:00:00Z&#x27;</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  ]),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 时钟控制</span></span><br><span class="line"><span class="keyword">const</span> clock = viewer.<span class="property">clock</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置时间范围</span></span><br><span class="line">clock.<span class="property">startTime</span> = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-01T00:00:00Z&#x27;</span>)</span><br><span class="line">clock.<span class="property">stopTime</span> = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromIso8601</span>(<span class="string">&#x27;2023-01-02T00:00:00Z&#x27;</span>)</span><br><span class="line">clock.<span class="property">currentTime</span> = clock.<span class="property">startTime</span>.<span class="title function_">clone</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间控制</span></span><br><span class="line">clock.<span class="property">multiplier</span> = <span class="number">3600</span> <span class="comment">// 1秒代表1小时</span></span><br><span class="line">clock.<span class="property">clockRange</span> = <span class="title class_">Cesium</span>.<span class="property">ClockRange</span>.<span class="property">LOOP_STOP</span> <span class="comment">// 循环播放</span></span><br><span class="line">clock.<span class="property">shouldAnimate</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听时钟事件</span></span><br><span class="line">clock.<span class="property">onTick</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">clock</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> currentHour = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toDate</span>(clock.<span class="property">currentTime</span>).<span class="title function_">getHours</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 根据时间改变场景</span></span><br><span class="line">  <span class="keyword">if</span> (currentHour &gt;= <span class="number">6</span> &amp;&amp; currentHour &lt; <span class="number">18</span>) &#123;</span><br><span class="line">    <span class="comment">// 白天</span></span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">skyAtmosphere</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">sun</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">moon</span>.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 夜晚</span></span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">skyAtmosphere</span>.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">sun</span>.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">moon</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 时间相关的属性动画</span></span><br><span class="line"><span class="keyword">const</span> timeBasedPosition = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CallbackProperty</span>(<span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> secondsIntoDay = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsOfDay</span>(time)</span><br><span class="line">  <span class="keyword">const</span> angle = (secondsIntoDay / <span class="number">86400</span>) * <span class="title class_">Cesium</span>.<span class="property">Math</span>.<span class="property">TWO_PI</span> <span class="comment">// 一天转一圈</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> radius = <span class="number">1000</span></span><br><span class="line">  <span class="keyword">const</span> x = radius * <span class="title class_">Math</span>.<span class="title function_">cos</span>(angle)</span><br><span class="line">  <span class="keyword">const</span> y = radius * <span class="title class_">Math</span>.<span class="title function_">sin</span>(angle)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(</span><br><span class="line">    <span class="number">116.4074</span> + x / <span class="number">111320</span>, <span class="comment">// 转换为经度偏移</span></span><br><span class="line">    <span class="number">39.9042</span> + y / <span class="number">110540</span>, <span class="comment">// 转换为纬度偏移</span></span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">  )</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orbitingEntity = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: timeBasedPosition,</span><br><span class="line">  <span class="attr">point</span>: &#123;</span><br><span class="line">    <span class="attr">pixelSize</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">LIME</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">path</span>: &#123;</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">leadTime</span>: <span class="number">3600</span>, <span class="comment">// 显示未来1小时的轨迹</span></span><br><span class="line">    <span class="attr">trailTime</span>: <span class="number">3600</span>, <span class="comment">// 显示过去1小时的轨迹</span></span><br><span class="line">    <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">LIME</span>,</span><br><span class="line">    <span class="attr">resolution</span>: <span class="number">60</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. 时区转换</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">convertToLocalTime</span>(<span class="params">julianDate, timezoneOffset</span>) &#123;</span><br><span class="line">  <span class="comment">// timezoneOffset: 时区偏移（小时）</span></span><br><span class="line">  <span class="keyword">const</span> offsetSeconds = timezoneOffset * <span class="number">3600</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">addSeconds</span>(julianDate, offsetSeconds, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">JulianDate</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为北京时间（UTC+8）</span></span><br><span class="line"><span class="keyword">const</span> utcTime = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>()</span><br><span class="line"><span class="keyword">const</span> beijingTime = <span class="title function_">convertToLocalTime</span>(utcTime, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;UTC时间:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toDate</span>(utcTime))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;北京时间:&#x27;</span>, <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">toDate</span>(beijingTime))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. 性能时间测量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">measurePerformance</span>(<span class="params">fn, name</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> start = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">fn</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> end = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">now</span>()</span><br><span class="line">  <span class="keyword">const</span> elapsed = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(end, start)</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> 执行时间: <span class="subst">$&#123;elapsed * <span class="number">1000</span>&#125;</span> 毫秒`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="title function_">measurePerformance</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 一些计算密集的操作</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">    <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="string">&#x27;数学计算&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="绘制功能详解"><a href="#绘制功能详解" class="headerlink" title="绘制功能详解"></a>绘制功能详解</h2><h3 id="绘制工具基类"><a href="#绘制工具基类" class="headerlink" title="绘制工具基类"></a>绘制工具基类</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cesium绘制工具基类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CesiumDrawTool</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">viewer</span> = viewer</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">scene</span> = viewer.<span class="property">scene</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">camera</span> = viewer.<span class="property">camera</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvas</span> = viewer.<span class="property">canvas</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// type: string</span></span><br><span class="line">    <span class="comment">// 作用: 绘制类型</span></span><br><span class="line">    <span class="comment">// 选项: &#x27;point&#x27;, &#x27;polyline&#x27;, &#x27;polygon&#x27;, &#x27;rectangle&#x27;, &#x27;circle&#x27;, &#x27;billboard&#x27;, &#x27;model&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = options.<span class="property">type</span> || <span class="string">&#x27;point&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// style: Object</span></span><br><span class="line">    <span class="comment">// 作用: 绘制样式配置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span> = options.<span class="property">style</span> || &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// clampToGround: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 是否贴地</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">clampToGround</span> = options.<span class="property">clampToGround</span> !== <span class="literal">undefined</span> ? options.<span class="property">clampToGround</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// enableEdit: boolean</span></span><br><span class="line">    <span class="comment">// 作用: 绘制完成后是否可编辑</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">enableEdit</span> = options.<span class="property">enableEdit</span> !== <span class="literal">undefined</span> ? options.<span class="property">enableEdit</span> : <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// heightOffset: number</span></span><br><span class="line">    <span class="comment">// 作用: 高度偏移量（米）</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">heightOffset</span> = options.<span class="property">heightOffset</span> || <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isActive</span> = <span class="literal">false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">positions</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">activeEntity</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tempEntities</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handler</span> = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 激活绘制工具</span></span><br><span class="line">  <span class="title function_">activate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isActive</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isActive</span> = <span class="literal">true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">positions</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearTempEntities</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建事件处理器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handler</span> = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ScreenSpaceEventHandler</span>(<span class="variable language_">this</span>.<span class="property">canvas</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绑定事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">bindEvents</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 改变鼠标样式</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvas</span>.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;crosshair&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 触发激活事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">onActivate</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 停用绘制工具</span></span><br><span class="line">  <span class="title function_">deactivate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isActive</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isActive</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解绑事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">unbindEvents</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理临时实体</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearTempEntities</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 恢复鼠标样式</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvas</span>.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;default&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 触发停用事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">onDeactivate</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绑定鼠标事件</span></span><br><span class="line">  <span class="title function_">bindEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 左键点击</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handler</span>.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">click</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> position = <span class="variable language_">this</span>.<span class="title function_">pickPosition</span>(click.<span class="property">position</span>)</span><br><span class="line">      <span class="keyword">if</span> (position) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">handleClick</span>(position)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 鼠标移动</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handler</span>.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">movement</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> position = <span class="variable language_">this</span>.<span class="title function_">pickPosition</span>(movement.<span class="property">endPosition</span>)</span><br><span class="line">      <span class="keyword">if</span> (position) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">handleMouseMove</span>(position)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">MOUSE_MOVE</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 右键完成</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handler</span>.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">click</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">finishDrawing</span>()</span><br><span class="line">    &#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">RIGHT_CLICK</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 双击完成</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handler</span>.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">click</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">finishDrawing</span>()</span><br><span class="line">    &#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_DOUBLE_CLICK</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 解绑事件</span></span><br><span class="line">  <span class="title function_">unbindEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">handler</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">handler</span>.<span class="title function_">destroy</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">handler</span> = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拾取位置</span></span><br><span class="line">  <span class="title function_">pickPosition</span>(<span class="params">windowPosition</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> pickedPosition</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">clampToGround</span>) &#123;</span><br><span class="line">      <span class="comment">// 贴地模式 - 拾取地形</span></span><br><span class="line">      <span class="keyword">const</span> ray = <span class="variable language_">this</span>.<span class="property">camera</span>.<span class="title function_">getPickRay</span>(windowPosition)</span><br><span class="line">      pickedPosition = <span class="variable language_">this</span>.<span class="property">scene</span>.<span class="property">globe</span>.<span class="title function_">pick</span>(ray, <span class="variable language_">this</span>.<span class="property">scene</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 空间模式 - 拾取椭球面</span></span><br><span class="line">      pickedPosition = <span class="variable language_">this</span>.<span class="property">camera</span>.<span class="title function_">pickEllipsoid</span>(windowPosition, <span class="variable language_">this</span>.<span class="property">scene</span>.<span class="property">globe</span>.<span class="property">ellipsoid</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pickedPosition) &#123;</span><br><span class="line">      <span class="comment">// 添加高度偏移</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">heightOffset</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> cartographic = <span class="title class_">Cesium</span>.<span class="property">Cartographic</span>.<span class="title function_">fromCartesian</span>(pickedPosition)</span><br><span class="line">        cartographic.<span class="property">height</span> += <span class="variable language_">this</span>.<span class="property">heightOffset</span></span><br><span class="line">        pickedPosition = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromRadians</span>(</span><br><span class="line">          cartographic.<span class="property">longitude</span>,</span><br><span class="line">          cartographic.<span class="property">latitude</span>,</span><br><span class="line">          cartographic.<span class="property">height</span>,</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pickedPosition</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 处理点击事件</span></span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params">position</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">positions</span>.<span class="title function_">push</span>(position)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateDrawing</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查是否满足完成条件</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">shouldFinish</span>()) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">finishDrawing</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 处理鼠标移动</span></span><br><span class="line">  <span class="title function_">handleMouseMove</span>(<span class="params">position</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updatePreview</span>(position)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新绘制状态</span></span><br><span class="line">  <span class="title function_">updateDrawing</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 子类实现</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新预览</span></span><br><span class="line">  <span class="title function_">updatePreview</span>(<span class="params">position</span>) &#123;</span><br><span class="line">    <span class="comment">// 子类实现</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 是否应该完成绘制</span></span><br><span class="line">  <span class="title function_">shouldFinish</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;point&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;billboard&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;model&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &gt;= <span class="number">1</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;polyline&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &gt;= <span class="number">2</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;polygon&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &gt;= <span class="number">3</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;rectangle&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;circle&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &gt;= <span class="number">2</span></span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 完成绘制</span></span><br><span class="line">  <span class="title function_">finishDrawing</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &lt; <span class="variable language_">this</span>.<span class="title function_">getMinPointCount</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建最终实体</span></span><br><span class="line">    <span class="keyword">const</span> entity = <span class="variable language_">this</span>.<span class="title function_">createFinalEntity</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理临时实体</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearTempEntities</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 停用工具</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">deactivate</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 触发完成事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">onComplete</span>(entity)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> entity</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取最小点数</span></span><br><span class="line">  <span class="title function_">getMinPointCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;point&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;billboard&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;model&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;polyline&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;polygon&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;rectangle&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;circle&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建最终实体（子类实现）</span></span><br><span class="line">  <span class="title function_">createFinalEntity</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理临时实体</span></span><br><span class="line">  <span class="title function_">clearTempEntities</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tempEntities</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">entity</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">remove</span>(entity)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tempEntities</span> = []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  <span class="title function_">onActivate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.type&#125;</span> 绘制工具已激活`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onDeactivate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.type&#125;</span> 绘制工具已停用`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onComplete</span>(<span class="params">entity</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.type&#125;</span> 绘制完成:`</span>, entity)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点绘制工具</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PointDrawTool</span> <span class="keyword">extends</span> <span class="title class_ inherited__">CesiumDrawTool</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(viewer, &#123; ...options, <span class="attr">type</span>: <span class="string">&#x27;point&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认点样式</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// pixelSize: number - 点的像素大小</span></span><br><span class="line">        <span class="attr">pixelSize</span>: <span class="number">10</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// color: Cesium.Color - 点的颜色</span></span><br><span class="line">        <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// outlineColor: Cesium.Color - 轮廓颜色</span></span><br><span class="line">        <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// outlineWidth: number - 轮廓宽度</span></span><br><span class="line">        <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// heightReference: Cesium.HeightReference - 高度参考</span></span><br><span class="line">        <span class="attr">heightReference</span>: <span class="variable language_">this</span>.<span class="property">clampToGround</span></span><br><span class="line">          ? <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">CLAMP_TO_GROUND</span></span><br><span class="line">          : <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// disableDepthTestDistance: number - 禁用深度测试距离</span></span><br><span class="line">        <span class="attr">disableDepthTestDistance</span>: <span class="title class_">Number</span>.<span class="property">POSITIVE_INFINITY</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// scaleByDistance: Cesium.NearFarScalar - 基于距离的缩放</span></span><br><span class="line">        <span class="attr">scaleByDistance</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// distanceDisplayCondition: Cesium.DistanceDisplayCondition - 距离显示条件</span></span><br><span class="line">        <span class="attr">distanceDisplayCondition</span>: <span class="literal">undefined</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      options.<span class="property">style</span>,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">createFinalEntity</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> entity = <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;DrawPoint&#x27;</span>,</span><br><span class="line">      <span class="attr">position</span>: <span class="variable language_">this</span>.<span class="property">positions</span>[<span class="number">0</span>],</span><br><span class="line">      <span class="attr">point</span>: &#123;</span><br><span class="line">        <span class="attr">pixelSize</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">pixelSize</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">color</span>,</span><br><span class="line">        <span class="attr">outlineColor</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outlineColor</span>,</span><br><span class="line">        <span class="attr">outlineWidth</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outlineWidth</span>,</span><br><span class="line">        <span class="attr">heightReference</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">heightReference</span>,</span><br><span class="line">        <span class="attr">disableDepthTestDistance</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">disableDepthTestDistance</span>,</span><br><span class="line">        <span class="attr">scaleByDistance</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">scaleByDistance</span>,</span><br><span class="line">        <span class="attr">distanceDisplayCondition</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">distanceDisplayCondition</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> entity</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 线绘制工具</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PolylineDrawTool</span> <span class="keyword">extends</span> <span class="title class_ inherited__">CesiumDrawTool</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(viewer, &#123; ...options, <span class="attr">type</span>: <span class="string">&#x27;polyline&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// width: number - 线宽</span></span><br><span class="line">        <span class="attr">width</span>: <span class="number">3</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// material: Cesium.MaterialProperty - 材质</span></span><br><span class="line">        <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// clampToGround: boolean - 是否贴地</span></span><br><span class="line">        <span class="attr">clampToGround</span>: <span class="variable language_">this</span>.<span class="property">clampToGround</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// classificationType: Cesium.ClassificationType - 分类类型</span></span><br><span class="line">        <span class="attr">classificationType</span>: <span class="variable language_">this</span>.<span class="property">clampToGround</span> ? <span class="title class_">Cesium</span>.<span class="property">ClassificationType</span>.<span class="property">TERRAIN</span> : <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// shadows: Cesium.ShadowMode - 阴影模式</span></span><br><span class="line">        <span class="attr">shadows</span>: <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// distanceDisplayCondition: Cesium.DistanceDisplayCondition</span></span><br><span class="line">        <span class="attr">distanceDisplayCondition</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// zIndex: number - 层级（贴地时有效）</span></span><br><span class="line">        <span class="attr">zIndex</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      options.<span class="property">style</span>,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateDrawing</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &lt; <span class="number">2</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 移除之前的临时线</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearTempEntities</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建临时线</span></span><br><span class="line">    <span class="keyword">const</span> tempEntity = <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;TempPolyline&#x27;</span>,</span><br><span class="line">      <span class="attr">polyline</span>: &#123;</span><br><span class="line">        <span class="attr">positions</span>: <span class="variable language_">this</span>.<span class="property">positions</span>,</span><br><span class="line">        <span class="attr">width</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">width</span>,</span><br><span class="line">        <span class="attr">material</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">material</span>,</span><br><span class="line">        <span class="attr">clampToGround</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">clampToGround</span>,</span><br><span class="line">        <span class="attr">classificationType</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">classificationType</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tempEntities</span>.<span class="title function_">push</span>(tempEntity)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updatePreview</span>(<span class="params">position</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建预览位置数组</span></span><br><span class="line">    <span class="keyword">const</span> previewPositions = [...<span class="variable language_">this</span>.<span class="property">positions</span>, position]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新临时线的位置</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">tempEntities</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">tempEntities</span>[<span class="number">0</span>].<span class="property">polyline</span>.<span class="property">positions</span> = previewPositions</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">createFinalEntity</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> entity = <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;DrawPolyline&#x27;</span>,</span><br><span class="line">      <span class="attr">polyline</span>: &#123;</span><br><span class="line">        <span class="attr">positions</span>: <span class="variable language_">this</span>.<span class="property">positions</span>,</span><br><span class="line">        <span class="attr">width</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">width</span>,</span><br><span class="line">        <span class="attr">material</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">material</span>,</span><br><span class="line">        <span class="attr">clampToGround</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">clampToGround</span>,</span><br><span class="line">        <span class="attr">classificationType</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">classificationType</span>,</span><br><span class="line">        <span class="attr">shadows</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">shadows</span>,</span><br><span class="line">        <span class="attr">distanceDisplayCondition</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">distanceDisplayCondition</span>,</span><br><span class="line">        <span class="attr">zIndex</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">zIndex</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> entity</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 面绘制工具</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PolygonDrawTool</span> <span class="keyword">extends</span> <span class="title class_ inherited__">CesiumDrawTool</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(viewer, &#123; ...options, <span class="attr">type</span>: <span class="string">&#x27;polygon&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// material: Cesium.MaterialProperty - 填充材质</span></span><br><span class="line">        <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>.<span class="title function_">withAlpha</span>(<span class="number">0.5</span>),</span><br><span class="line"></span><br><span class="line">        <span class="comment">// outline: boolean - 是否显示轮廓</span></span><br><span class="line">        <span class="attr">outline</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// outlineColor: Cesium.Color - 轮廓颜色</span></span><br><span class="line">        <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// outlineWidth: number - 轮廓宽度</span></span><br><span class="line">        <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// height: number - 高度</span></span><br><span class="line">        <span class="attr">height</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// extrudedHeight: number - 拉伸高度</span></span><br><span class="line">        <span class="attr">extrudedHeight</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// heightReference: Cesium.HeightReference - 高度参考</span></span><br><span class="line">        <span class="attr">heightReference</span>: <span class="variable language_">this</span>.<span class="property">clampToGround</span></span><br><span class="line">          ? <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">CLAMP_TO_GROUND</span></span><br><span class="line">          : <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// extrudedHeightReference: Cesium.HeightReference - 拉伸高度参考</span></span><br><span class="line">        <span class="attr">extrudedHeightReference</span>: <span class="title class_">Cesium</span>.<span class="property">HeightReference</span>.<span class="property">NONE</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// fill: boolean - 是否填充</span></span><br><span class="line">        <span class="attr">fill</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// shadows: Cesium.ShadowMode - 阴影模式</span></span><br><span class="line">        <span class="attr">shadows</span>: <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// distanceDisplayCondition: Cesium.DistanceDisplayCondition</span></span><br><span class="line">        <span class="attr">distanceDisplayCondition</span>: <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// classificationType: Cesium.ClassificationType - 分类类型</span></span><br><span class="line">        <span class="attr">classificationType</span>: <span class="variable language_">this</span>.<span class="property">clampToGround</span> ? <span class="title class_">Cesium</span>.<span class="property">ClassificationType</span>.<span class="property">TERRAIN</span> : <span class="literal">undefined</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// zIndex: number - 层级</span></span><br><span class="line">        <span class="attr">zIndex</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      options.<span class="property">style</span>,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateDrawing</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &lt; <span class="number">3</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearTempEntities</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> tempEntity = <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;TempPolygon&#x27;</span>,</span><br><span class="line">      <span class="attr">polygon</span>: &#123;</span><br><span class="line">        <span class="attr">hierarchy</span>: <span class="variable language_">this</span>.<span class="property">positions</span>,</span><br><span class="line">        <span class="attr">material</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">material</span>,</span><br><span class="line">        <span class="attr">outline</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outline</span>,</span><br><span class="line">        <span class="attr">outlineColor</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outlineColor</span>,</span><br><span class="line">        <span class="attr">outlineWidth</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outlineWidth</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">height</span>,</span><br><span class="line">        <span class="attr">heightReference</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">heightReference</span>,</span><br><span class="line">        <span class="attr">fill</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">fill</span>,</span><br><span class="line">        <span class="attr">classificationType</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">classificationType</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tempEntities</span>.<span class="title function_">push</span>(tempEntity)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updatePreview</span>(<span class="params">position</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">positions</span>.<span class="property">length</span> &lt; <span class="number">2</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> previewPositions = [...<span class="variable language_">this</span>.<span class="property">positions</span>, position]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">tempEntities</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">tempEntities</span>[<span class="number">0</span>].<span class="property">polygon</span>.<span class="property">hierarchy</span> = previewPositions</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">createFinalEntity</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> entity = <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;DrawPolygon&#x27;</span>,</span><br><span class="line">      <span class="attr">polygon</span>: &#123;</span><br><span class="line">        <span class="attr">hierarchy</span>: <span class="variable language_">this</span>.<span class="property">positions</span>,</span><br><span class="line">        <span class="attr">material</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">material</span>,</span><br><span class="line">        <span class="attr">outline</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outline</span>,</span><br><span class="line">        <span class="attr">outlineColor</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outlineColor</span>,</span><br><span class="line">        <span class="attr">outlineWidth</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">outlineWidth</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">height</span>,</span><br><span class="line">        <span class="attr">extrudedHeight</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">extrudedHeight</span>,</span><br><span class="line">        <span class="attr">heightReference</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">heightReference</span>,</span><br><span class="line">        <span class="attr">extrudedHeightReference</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">extrudedHeightReference</span>,</span><br><span class="line">        <span class="attr">fill</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">fill</span>,</span><br><span class="line">        <span class="attr">shadows</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">shadows</span>,</span><br><span class="line">        <span class="attr">distanceDisplayCondition</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">distanceDisplayCondition</span>,</span><br><span class="line">        <span class="attr">classificationType</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">classificationType</span>,</span><br><span class="line">        <span class="attr">zIndex</span>: <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">zIndex</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> entity</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="绘制管理器"><a href="#绘制管理器" class="headerlink" title="绘制管理器"></a>绘制管理器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cesium绘制管理器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CesiumDrawManager</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">viewer</span> = viewer</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">options</span> = options</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当前激活的绘制工具</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">activeTool</span> = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绘制工具实例</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tools</span> = &#123;</span><br><span class="line">      <span class="attr">point</span>: <span class="keyword">new</span> <span class="title class_">PointDrawTool</span>(viewer),</span><br><span class="line">      <span class="attr">polyline</span>: <span class="keyword">new</span> <span class="title class_">PolylineDrawTool</span>(viewer),</span><br><span class="line">      <span class="attr">polygon</span>: <span class="keyword">new</span> <span class="title class_">PolygonDrawTool</span>(viewer),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绘制结果存储</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drawResults</span> = []</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绑定事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">bindToolEvents</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绑定工具事件</span></span><br><span class="line">  <span class="title function_">bindToolEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">values</span>(<span class="variable language_">this</span>.<span class="property">tools</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">tool</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 重写完成事件</span></span><br><span class="line">      <span class="keyword">const</span> originalOnComplete = tool.<span class="property">onComplete</span>.<span class="title function_">bind</span>(tool)</span><br><span class="line">      tool.<span class="property">onComplete</span> = <span class="function">(<span class="params">entity</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">originalOnComplete</span>(entity)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onDrawComplete</span>(entity, tool.<span class="property">type</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 开始绘制</span></span><br><span class="line">  <span class="title function_">startDraw</span>(<span class="params">type, style = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// 停止当前绘制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">stopDraw</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查工具类型</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">tools</span>[type]) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;不支持的绘制类型:&#x27;</span>, type)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新工具样式</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="title function_">keys</span>(style).<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>.<span class="property">tools</span>[type].<span class="property">style</span>, style)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 激活工具</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">activeTool</span> = <span class="variable language_">this</span>.<span class="property">tools</span>[type]</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">activeTool</span>.<span class="title function_">activate</span>()</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`开始绘制 <span class="subst">$&#123;type&#125;</span>`</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 停止绘制</span></span><br><span class="line">  <span class="title function_">stopDraw</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">activeTool</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">activeTool</span>.<span class="title function_">deactivate</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">activeTool</span> = <span class="literal">null</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;停止绘制&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绘制完成处理</span></span><br><span class="line">  <span class="title function_">onDrawComplete</span>(<span class="params">entity, type</span>) &#123;</span><br><span class="line">    <span class="comment">// 添加到结果数组</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drawResults</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="attr">entity</span>: entity,</span><br><span class="line">      <span class="attr">type</span>: type,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">      <span class="attr">id</span>: entity.<span class="property">id</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;type&#125;</span> 绘制完成`</span>, entity)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清空所有绘制</span></span><br><span class="line">  <span class="title function_">clearAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drawResults</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">remove</span>(result.<span class="property">entity</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drawResults</span> = []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 撤销上一步绘制</span></span><br><span class="line">  <span class="title function_">undo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">drawResults</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> lastResult = <span class="variable language_">this</span>.<span class="property">drawResults</span>.<span class="title function_">pop</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">viewer</span>.<span class="property">entities</span>.<span class="title function_">remove</span>(lastResult.<span class="property">entity</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="绘制工具栏"><a href="#绘制工具栏" class="headerlink" title="绘制工具栏"></a>绘制工具栏</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制工具栏控件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DrawToolbar</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">viewer</span> = viewer</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drawManager</span> = <span class="keyword">new</span> <span class="title class_">CesiumDrawManager</span>(viewer, options)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 工具栏配置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tools</span> = options.<span class="property">tools</span> || [</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;point&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;点&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;📍&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;绘制点&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;polyline&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;线&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;📝&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;绘制线&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;polygon&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;面&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;🔲&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;绘制多边形&#x27;</span> &#125;,</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">activeToolType</span> = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">createToolbar</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建工具栏</span></span><br><span class="line">  <span class="title function_">createToolbar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 创建容器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">className</span> = <span class="string">&#x27;cesium-draw-toolbar&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置样式</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">style</span>, &#123;</span><br><span class="line">      <span class="attr">position</span>: <span class="string">&#x27;absolute&#x27;</span>,</span><br><span class="line">      <span class="attr">top</span>: <span class="string">&#x27;10px&#x27;</span>,</span><br><span class="line">      <span class="attr">left</span>: <span class="string">&#x27;10px&#x27;</span>,</span><br><span class="line">      <span class="attr">zIndex</span>: <span class="string">&#x27;1000&#x27;</span>,</span><br><span class="line">      <span class="attr">backgroundColor</span>: <span class="string">&#x27;rgba(42, 42, 42, 0.9)&#x27;</span>,</span><br><span class="line">      <span class="attr">borderRadius</span>: <span class="string">&#x27;5px&#x27;</span>,</span><br><span class="line">      <span class="attr">padding</span>: <span class="string">&#x27;8px&#x27;</span>,</span><br><span class="line">      <span class="attr">display</span>: <span class="string">&#x27;flex&#x27;</span>,</span><br><span class="line">      <span class="attr">flexDirection</span>: <span class="string">&#x27;column&#x27;</span>,</span><br><span class="line">      <span class="attr">gap</span>: <span class="string">&#x27;4px&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建工具按钮</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">createToolButtons</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建操作按钮</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">createActionButtons</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加到页面</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">container</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建工具按钮</span></span><br><span class="line">  <span class="title function_">createToolButtons</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tools</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">tool</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">      button.<span class="property">innerHTML</span> = <span class="string">`<span class="subst">$&#123;tool.icon&#125;</span> <span class="subst">$&#123;tool.name&#125;</span>`</span></span><br><span class="line">      button.<span class="property">title</span> = tool.<span class="property">title</span></span><br><span class="line"></span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">assign</span>(button.<span class="property">style</span>, &#123;</span><br><span class="line">        <span class="attr">padding</span>: <span class="string">&#x27;6px 12px&#x27;</span>,</span><br><span class="line">        <span class="attr">border</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">        <span class="attr">borderRadius</span>: <span class="string">&#x27;3px&#x27;</span>,</span><br><span class="line">        <span class="attr">backgroundColor</span>: <span class="string">&#x27;transparent&#x27;</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#ffffff&#x27;</span>,</span><br><span class="line">        <span class="attr">cursor</span>: <span class="string">&#x27;pointer&#x27;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">selectTool</span>(tool.<span class="property">type</span>, button)</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(button)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建操作按钮</span></span><br><span class="line">  <span class="title function_">createActionButtons</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> actions = [</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&#x27;停止&#x27;</span>, <span class="attr">action</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">stopDraw</span>() &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&#x27;撤销&#x27;</span>, <span class="attr">action</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">drawManager</span>.<span class="title function_">undo</span>() &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&#x27;清空&#x27;</span>, <span class="attr">action</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">drawManager</span>.<span class="title function_">clearAll</span>() &#125;,</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    actions.<span class="title function_">forEach</span>(<span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">      button.<span class="property">innerHTML</span> = action.<span class="property">name</span></span><br><span class="line"></span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">assign</span>(button.<span class="property">style</span>, &#123;</span><br><span class="line">        <span class="attr">padding</span>: <span class="string">&#x27;4px 8px&#x27;</span>,</span><br><span class="line">        <span class="attr">border</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">        <span class="attr">borderRadius</span>: <span class="string">&#x27;3px&#x27;</span>,</span><br><span class="line">        <span class="attr">backgroundColor</span>: <span class="string">&#x27;transparent&#x27;</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#ffffff&#x27;</span>,</span><br><span class="line">        <span class="attr">cursor</span>: <span class="string">&#x27;pointer&#x27;</span>,</span><br><span class="line">        <span class="attr">fontSize</span>: <span class="string">&#x27;11px&#x27;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, action.<span class="property">action</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(button)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 选择工具</span></span><br><span class="line">  <span class="title function_">selectTool</span>(<span class="params">toolType, buttonElement</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">activeToolType</span> === toolType) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">stopDraw</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">activeToolType</span> = toolType</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">drawManager</span>.<span class="title function_">startDraw</span>(toolType)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 停止绘制</span></span><br><span class="line">  <span class="title function_">stopDraw</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">activeToolType</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drawManager</span>.<span class="title function_">stopDraw</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> viewer = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Viewer</span>(<span class="string">&#x27;cesiumContainer&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> drawToolbar = <span class="keyword">new</span> <span class="title class_">DrawToolbar</span>(viewer)</span><br></pre></td></tr></table></figure>

<h2 id="⚡-性能优化详解"><a href="#⚡-性能优化详解" class="headerlink" title="⚡ 性能优化详解"></a>⚡ 性能优化详解</h2><h3 id="📋-目录-1"><a href="#📋-目录-1" class="headerlink" title="📋 目录"></a>📋 目录</h3><ul>
<li><a href="#%E6%B8%B2%E6%9F%93%E4%BC%98%E5%8C%96">渲染优化</a></li>
<li><a href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86">内存管理</a></li>
<li><a href="#%E4%BA%8B%E4%BB%B6%E4%BC%98%E5%8C%96">事件优化</a></li>
<li><a href="#%E6%82%AC%E5%81%9C%E4%BA%8B%E4%BB%B6%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">悬停事件性能优化</a></li>
<li><a href="#%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%8C%96">异步加载优化</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93">最佳实践总结</a></li>
</ul>
<hr>
<h3 id="🎯-渲染优化"><a href="#🎯-渲染优化" class="headerlink" title="🎯 渲染优化"></a>🎯 渲染优化</h3><h4 id="1-按需渲染-On-Demand-Rendering"><a href="#1-按需渲染-On-Demand-Rendering" class="headerlink" title="1. 按需渲染 (On-Demand Rendering)"></a>1. 按需渲染 (On-Demand Rendering)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 启用按需渲染模式</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">requestRenderMode</span> = <span class="literal">true</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">maximumRenderTimeChange</span> = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 手动触发渲染函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestRenderIfNeeded</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (needsUpdate) &#123;</span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="title function_">requestRender</span>()</span><br><span class="line">    needsUpdate = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听数据变化，自动触发渲染</span></span><br><span class="line">viewer.<span class="property">entities</span>.<span class="property">collectionChanged</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  needsUpdate = <span class="literal">true</span></span><br><span class="line">  <span class="title function_">requestRenderIfNeeded</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="2-LOD-Level-of-Detail-优化"><a href="#2-LOD-Level-of-Detail-优化" class="headerlink" title="2. LOD (Level of Detail) 优化"></a>2. LOD (Level of Detail) 优化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 降低地形细节，提升性能</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">globe</span>.<span class="property">maximumScreenSpaceError</span> = <span class="number">1</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">globe</span>.<span class="property">tileCacheSize</span> = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 视锥剔除优化</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">globe</span>.<span class="property">showSkirts</span> = <span class="literal">false</span> <span class="comment">// 禁用地形裙边</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">fog</span>.<span class="property">enabled</span> = <span class="literal">true</span> <span class="comment">// 启用雾效隐藏远处细节</span></span><br></pre></td></tr></table></figure>

<h4 id="3-实体优化-Entity-Optimization"><a href="#3-实体优化-Entity-Optimization" class="headerlink" title="3. 实体优化 (Entity Optimization)"></a>3. 实体优化 (Entity Optimization)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 Primitive 替代大量 Entity，提升性能</span></span><br><span class="line"><span class="keyword">const</span> instances = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">  instances.<span class="title function_">push</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">      <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">BoxGeometry</span>(&#123;</span><br><span class="line">        <span class="attr">dimensions</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>),</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">modelMatrix</span>: <span class="title class_">Cesium</span>.<span class="property">Matrix4</span>.<span class="title function_">multiplyByTranslation</span>(</span><br><span class="line">        <span class="title class_">Cesium</span>.<span class="property">Transforms</span>.<span class="title function_">eastNorthUpToFixedFrame</span>(</span><br><span class="line">          <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(</span><br><span class="line">            <span class="number">116.4074</span> + (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">0.1</span>,</span><br><span class="line">            <span class="number">39.9042</span> + (<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">0.1</span>,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Matrix4</span>(),</span><br><span class="line">      ),</span><br><span class="line">      <span class="attr">attributes</span>: &#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">ColorGeometryInstanceAttribute</span>.<span class="title function_">fromColor</span>(<span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="title function_">fromRandom</span>()),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> primitive = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Primitive</span>(&#123;</span><br><span class="line">  <span class="attr">geometryInstances</span>: instances,</span><br><span class="line">  <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PerInstanceColorAppearance</span>(&#123;</span><br><span class="line">    <span class="attr">translucent</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">closed</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="title function_">add</span>(primitive)</span><br></pre></td></tr></table></figure>

<h4 id="4-聚类优化-Clustering"><a href="#4-聚类优化-Clustering" class="headerlink" title="4. 聚类优化 (Clustering)"></a>4. 聚类优化 (Clustering)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 启用聚类功能，减少渲染负担</span></span><br><span class="line"><span class="keyword">const</span> dataSource = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CustomDataSource</span>(<span class="string">&#x27;优化数据源&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> clustering = dataSource.<span class="property">clustering</span></span><br><span class="line"></span><br><span class="line">clustering.<span class="property">enabled</span> = <span class="literal">true</span></span><br><span class="line">clustering.<span class="property">pixelRange</span> = <span class="number">15</span></span><br><span class="line">clustering.<span class="property">minimumClusterSize</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义聚类样式</span></span><br><span class="line">clustering.<span class="property">clusterEvent</span>.<span class="title function_">addEventListener</span>(<span class="function">(<span class="params">clusteredEntities, cluster</span>) =&gt;</span> &#123;</span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">show</span> = <span class="literal">true</span></span><br><span class="line">  cluster.<span class="property">label</span>.<span class="property">text</span> = clusteredEntities.<span class="property">length</span>.<span class="title function_">toString</span>()</span><br><span class="line">  cluster.<span class="property">billboard</span>.<span class="property">show</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  cluster.<span class="property">point</span> = &#123;</span><br><span class="line">    <span class="attr">pixelSize</span>: <span class="title class_">Math</span>.<span class="title function_">min</span>(clusteredEntities.<span class="property">length</span> * <span class="number">2</span> + <span class="number">10</span>, <span class="number">50</span>),</span><br><span class="line">    <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span>,</span><br><span class="line">    <span class="attr">outlineColor</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">BLACK</span>,</span><br><span class="line">    <span class="attr">outlineWidth</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="5-材质优化-Material-Optimization"><a href="#5-材质优化-Material-Optimization" class="headerlink" title="5. 材质优化 (Material Optimization)"></a>5. 材质优化 (Material Optimization)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用颜色而非纹理，减少内存占用</span></span><br><span class="line"><span class="keyword">const</span> colorMaterial = <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">RED</span></span><br><span class="line"><span class="keyword">const</span> imageMaterial = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ImageMaterialProperty</span>(&#123;</span><br><span class="line">  <span class="attr">image</span>: <span class="string">&#x27;texture.jpg&#x27;</span>, <span class="comment">// 避免大纹理</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="6-模型优化-Model-Optimization"><a href="#6-模型优化-Model-Optimization" class="headerlink" title="6. 模型优化 (Model Optimization)"></a>6. 模型优化 (Model Optimization)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化3D模型加载和渲染</span></span><br><span class="line"><span class="keyword">const</span> optimizedModel = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(<span class="number">116.4074</span>, <span class="number">39.9042</span>),</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">uri</span>: <span class="string">&#x27;./models/optimized.glb&#x27;</span>, <span class="comment">// 使用 glb 格式</span></span><br><span class="line">    <span class="attr">scale</span>: <span class="number">1.0</span>,</span><br><span class="line">    <span class="attr">minimumPixelSize</span>: <span class="number">128</span>, <span class="comment">// 设置最小像素大小</span></span><br><span class="line">    <span class="attr">maximumScale</span>: <span class="number">20000</span>, <span class="comment">// 限制最大缩放</span></span><br><span class="line">    <span class="attr">incrementallyLoadTextures</span>: <span class="literal">true</span>, <span class="comment">// 渐进式纹理加载</span></span><br><span class="line">    <span class="attr">runAnimations</span>: <span class="literal">false</span>, <span class="comment">// 禁用不必要的动画</span></span><br><span class="line">    <span class="attr">clampAnimations</span>: <span class="literal">true</span>, <span class="comment">// 限制动画</span></span><br><span class="line">    <span class="attr">shadows</span>: <span class="title class_">Cesium</span>.<span class="property">ShadowMode</span>.<span class="property">DISABLED</span>, <span class="comment">// 禁用阴影</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="💾-内存管理"><a href="#💾-内存管理" class="headerlink" title="💾 内存管理"></a>💾 内存管理</h3><h4 id="1-资源清理机制"><a href="#1-资源清理机制" class="headerlink" title="1. 资源清理机制"></a>1. 资源清理机制</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定期清理未使用的资源</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cleanupResources</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 清理实体</span></span><br><span class="line">  <span class="keyword">const</span> entities = viewer.<span class="property">entities</span>.<span class="property">values</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = entities.<span class="property">length</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">const</span> entity = entities[i]</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isEntityVisible</span>(entity)) &#123;</span><br><span class="line">      viewer.<span class="property">entities</span>.<span class="title function_">remove</span>(entity)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理图元</span></span><br><span class="line">  <span class="keyword">const</span> primitives = viewer.<span class="property">scene</span>.<span class="property">primitives</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = primitives.<span class="property">length</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">const</span> primitive = primitives.<span class="title function_">get</span>(i)</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">isPrimitiveVisible</span>(primitive)) &#123;</span><br><span class="line">      primitives.<span class="title function_">remove</span>(primitive)</span><br><span class="line">      <span class="keyword">if</span> (!primitive.<span class="title function_">isDestroyed</span>()) &#123;</span><br><span class="line">        primitive.<span class="title function_">destroy</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 强制垃圾回收</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">gc</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">gc</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查实体可见性</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isEntityVisible</span>(<span class="params">entity</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> position = entity.<span class="property">position</span></span><br><span class="line">  <span class="keyword">if</span> (!position) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> cartesian = position.<span class="title function_">getValue</span>(viewer.<span class="property">clock</span>.<span class="property">currentTime</span>)</span><br><span class="line">  <span class="keyword">if</span> (!cartesian) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> distance = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">distance</span>(cartesian, viewer.<span class="property">camera</span>.<span class="property">position</span>)</span><br><span class="line">  <span class="keyword">return</span> distance &lt; <span class="number">10000000</span> <span class="comment">// 10,000 km</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查图元可见性</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isPrimitiveVisible</span>(<span class="params">primitive</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> primitive.<span class="property">show</span> &amp;&amp; !primitive.<span class="title function_">isDestroyed</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定期清理（每30秒执行一次）</span></span><br><span class="line"><span class="built_in">setInterval</span>(cleanupResources, <span class="number">30000</span>)</span><br></pre></td></tr></table></figure>

<h4 id="2-内存监控"><a href="#2-内存监控" class="headerlink" title="2. 内存监控"></a>2. 内存监控</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内存使用监控</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">monitorMemoryUsage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (performance.<span class="property">memory</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> memoryInfo = &#123;</span><br><span class="line">      <span class="attr">usedJSHeapSize</span>: performance.<span class="property">memory</span>.<span class="property">usedJSHeapSize</span> / <span class="number">1024</span> / <span class="number">1024</span>, <span class="comment">// MB</span></span><br><span class="line">      <span class="attr">totalJSHeapSize</span>: performance.<span class="property">memory</span>.<span class="property">totalJSHeapSize</span> / <span class="number">1024</span> / <span class="number">1024</span>, <span class="comment">// MB</span></span><br><span class="line">      <span class="attr">jsHeapSizeLimit</span>: performance.<span class="property">memory</span>.<span class="property">jsHeapSizeLimit</span> / <span class="number">1024</span> / <span class="number">1024</span>, <span class="comment">// MB</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;内存使用情况:&#x27;</span>, memoryInfo)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 内存使用超过80%时发出警告</span></span><br><span class="line">    <span class="keyword">if</span> (memoryInfo.<span class="property">usedJSHeapSize</span> / memoryInfo.<span class="property">jsHeapSizeLimit</span> &gt; <span class="number">0.8</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;⚠️ 内存使用率过高，建议清理资源&#x27;</span>)</span><br><span class="line">      <span class="title function_">cleanupResources</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定期监控内存</span></span><br><span class="line"><span class="built_in">setInterval</span>(monitorMemoryUsage, <span class="number">10000</span>) <span class="comment">// 每10秒检查一次</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="🎮-事件优化"><a href="#🎮-事件优化" class="headerlink" title="🎮 事件优化"></a>🎮 事件优化</h3><h4 id="1-事件节流-Event-Throttling"><a href="#1-事件节流-Event-Throttling" class="headerlink" title="1. 事件节流 (Event Throttling)"></a>1. 事件节流 (Event Throttling)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通用节流函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">func, limit</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> inThrottle</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> args = <span class="variable language_">arguments</span></span><br><span class="line">    <span class="keyword">const</span> context = <span class="variable language_">this</span></span><br><span class="line">    <span class="keyword">if</span> (!inThrottle) &#123;</span><br><span class="line">      func.<span class="title function_">apply</span>(context, args)</span><br><span class="line">      inThrottle = <span class="literal">true</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> (inThrottle = <span class="literal">false</span>), limit)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 节流鼠标移动事件</span></span><br><span class="line"><span class="keyword">const</span> throttledMouseMove = <span class="title function_">throttle</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> pickedObject = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(event.<span class="property">endPosition</span>)</span><br><span class="line">  <span class="title function_">updateTooltip</span>(pickedObject)</span><br><span class="line">&#125;, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">viewer.<span class="property">cesiumWidget</span>.<span class="property">screenSpaceEventHandler</span>.<span class="title function_">setInputAction</span>(</span><br><span class="line">  throttledMouseMove,</span><br><span class="line">  <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">MOUSE_MOVE</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="2-事件委托-Event-Delegation"><a href="#2-事件委托-Event-Delegation" class="headerlink" title="2. 事件委托 (Event Delegation)"></a>2. 事件委托 (Event Delegation)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用事件委托减少事件监听器数量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setupEventDelegation</span>(<span class="params"></span>) &#123;</span><br><span class="line">  viewer.<span class="property">cesiumWidget</span>.<span class="property">screenSpaceEventHandler</span>.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> pickedObject = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(event.<span class="property">position</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pickedObject &amp;&amp; pickedObject.<span class="property">id</span>) &#123;</span><br><span class="line">      <span class="comment">// 统一处理所有实体点击事件</span></span><br><span class="line">      <span class="title function_">handleEntityClick</span>(pickedObject.<span class="property">id</span>, event)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">LEFT_CLICK</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleEntityClick</span>(<span class="params">entity, event</span>) &#123;</span><br><span class="line">  <span class="comment">// 根据实体类型执行不同操作</span></span><br><span class="line">  <span class="keyword">switch</span> (entity.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;point&#x27;</span>:</span><br><span class="line">      <span class="title function_">showPointInfo</span>(entity)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;polygon&#x27;</span>:</span><br><span class="line">      <span class="title function_">showPolygonInfo</span>(entity)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;line&#x27;</span>:</span><br><span class="line">      <span class="title function_">showLineInfo</span>(entity)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;未知实体类型:&#x27;</span>, entity.<span class="property">type</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="🎯-悬停事件性能优化"><a href="#🎯-悬停事件性能优化" class="headerlink" title="🎯 悬停事件性能优化"></a>🎯 悬停事件性能优化</h3><h4 id="📊-问题分析"><a href="#📊-问题分析" class="headerlink" title="📊 问题分析"></a>📊 问题分析</h4><p>在点位数量过多时，<code>setupHoverEvents</code> 函数会导致地图移动卡顿，主要问题包括：</p>
<ol>
<li><strong>频繁的鼠标移动事件处理</strong>：每次鼠标移动都会触发 <code>viewer.scene.pick()</code> 操作</li>
<li><strong>复杂的点位查找逻辑</strong>：在 <code>handlePointHover</code> 中有复杂的字符串解析和数组查找</li>
<li><strong>缺乏节流机制</strong>：没有对鼠标移动事件进行节流处理</li>
<li><strong>大量实体的拾取开销</strong>：当点位数量多时，拾取操作的开销会显著增加</li>
</ol>
<h4 id="🚀-优化方案实现"><a href="#🚀-优化方案实现" class="headerlink" title="🚀 优化方案实现"></a>🚀 优化方案实现</h4><h5 id="1-节流机制-Throttling"><a href="#1-节流机制-Throttling" class="headerlink" title="1. 节流机制 (Throttling)"></a>1. 节流机制 (Throttling)</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态调整节流参数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getThrottleInterval</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pointCount = pointsData.<span class="property">value</span>.<span class="property">length</span></span><br><span class="line">  <span class="keyword">if</span> (pointCount &gt; <span class="variable constant_">HIGH_PERFORMANCE_THRESHOLD</span>) &#123;</span><br><span class="line">    isHighPerformanceMode = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">25</span> <span class="comment">// 点位多时，降低处理频率到40fps</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    isHighPerformanceMode = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">16</span> <span class="comment">// 点位少时，保持60fps</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置鼠标悬停事件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">setupHoverEvents</span> = (<span class="params">Cesium</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (hoverHandler) &#123;</span><br><span class="line">    hoverHandler.<span class="title function_">destroy</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  hoverHandler = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ScreenSpaceEventHandler</span>(viewer.<span class="property">scene</span>.<span class="property">canvas</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加节流机制</span></span><br><span class="line">  <span class="keyword">let</span> lastHoverTime = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> lastPickedObject = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 鼠标移动事件</span></span><br><span class="line">  hoverHandler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> currentTime = performance.<span class="title function_">now</span>()</span><br><span class="line">    <span class="keyword">const</span> hoverThrottle = <span class="title function_">getThrottleInterval</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 节流处理：限制处理频率</span></span><br><span class="line">    <span class="keyword">if</span> (currentTime - lastHoverTime &lt; hoverThrottle) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    lastHoverTime = currentTime</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 高性能模式下的优化</span></span><br><span class="line">    <span class="keyword">if</span> (isHighPerformanceMode) &#123;</span><br><span class="line">      <span class="comment">// 在高性能模式下，适度减少处理频率</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &gt; <span class="number">0.05</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 requestAnimationFrame 来优化性能</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>) &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> pickedObject = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(event.<span class="property">endPosition</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 避免重复处理相同的对象</span></span><br><span class="line">        <span class="keyword">if</span> (pickedObject === lastPickedObject) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        lastPickedObject = pickedObject</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isValidPointObject</span>(pickedObject)) &#123;</span><br><span class="line">          <span class="title function_">handlePointHover</span>(pickedObject)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">handlePointLeave</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 降级处理</span></span><br><span class="line">      <span class="keyword">const</span> pickedObject = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(event.<span class="property">endPosition</span>)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (pickedObject === lastPickedObject) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      lastPickedObject = pickedObject</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">isValidPointObject</span>(pickedObject)) &#123;</span><br><span class="line">        <span class="title function_">handlePointHover</span>(pickedObject)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">handlePointLeave</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">MOUSE_MOVE</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-缓存机制-Caching"><a href="#2-缓存机制-Caching" class="headerlink" title="2. 缓存机制 (Caching)"></a>2. 缓存机制 (Caching)</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加缓存机制</span></span><br><span class="line"><span class="keyword">const</span> pointCache = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handlePointHover</span> = (<span class="params">pickedObject</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 取消之前的隐藏定时器</span></span><br><span class="line">  <span class="title function_">clearHideTooltipTimer</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> entityId = pickedObject.<span class="property">id</span>.<span class="property">id</span>.<span class="title function_">toString</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查缓存</span></span><br><span class="line">  <span class="keyword">let</span> cached = pointCache.<span class="title function_">get</span>(entityId)</span><br><span class="line">  <span class="keyword">if</span> (cached) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; point, isParentPoint &#125; = cached</span><br><span class="line">    <span class="keyword">if</span> (point) &#123;</span><br><span class="line">      hoveredPoint.<span class="property">value</span> = point</span><br><span class="line">      <span class="comment">// 根据判断结果设置当前层级（如果需要）</span></span><br><span class="line">      <span class="keyword">if</span> (isParentPoint &amp;&amp; currentLevel.<span class="property">value</span> !== <span class="string">&#x27;parent&#x27;</span>) &#123;</span><br><span class="line">        currentLevel.<span class="property">value</span> = <span class="string">&#x27;parent&#x27;</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isParentPoint &amp;&amp; currentLevel.<span class="property">value</span> !== <span class="string">&#x27;child&#x27;</span>) &#123;</span><br><span class="line">        currentLevel.<span class="property">value</span> = <span class="string">&#x27;child&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">updateTooltipPosition</span>(pickedObject)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> point = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">let</span> isParentPoint = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 智能区分父点位和子点位</span></span><br><span class="line">  <span class="keyword">if</span> (entityId.<span class="title function_">startsWith</span>(<span class="string">&#x27;point_&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> pointId = <span class="built_in">parseInt</span>(entityId.<span class="title function_">replace</span>(<span class="string">&#x27;point_&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    point = pointsData.<span class="property">value</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">p</span>) =&gt;</span> p.<span class="property">id</span> === pointId) || <span class="literal">null</span></span><br><span class="line">    isParentPoint = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (entityId.<span class="title function_">startsWith</span>(<span class="string">&#x27;child_&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> childId = <span class="built_in">parseInt</span>(entityId.<span class="title function_">replace</span>(<span class="string">&#x27;child_&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    <span class="keyword">const</span> parentId = <span class="title class_">Math</span>.<span class="title function_">floor</span>(childId / <span class="number">100</span>)</span><br><span class="line">    <span class="keyword">const</span> parentPoint = pointsData.<span class="property">value</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">p</span>) =&gt;</span> p.<span class="property">id</span> === parentId)</span><br><span class="line">    <span class="keyword">if</span> (parentPoint?.<span class="property">children</span>) &#123;</span><br><span class="line">      point = parentPoint.<span class="property">children</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">c</span>) =&gt;</span> c.<span class="property">id</span> === childId) || <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    isParentPoint = <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> pointId = <span class="built_in">parseInt</span>(entityId)</span><br><span class="line">    point = <span class="title function_">findPointById</span>(pointId)</span><br><span class="line">    <span class="keyword">if</span> (point) &#123;</span><br><span class="line">      isParentPoint = <span class="title function_">getPointTypeById</span>(pointId) === <span class="string">&#x27;parent&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 缓存结果</span></span><br><span class="line">  pointCache.<span class="title function_">set</span>(entityId, &#123; point, isParentPoint &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (point) &#123;</span><br><span class="line">    hoveredPoint.<span class="property">value</span> = point</span><br><span class="line">    <span class="keyword">if</span> (isParentPoint &amp;&amp; currentLevel.<span class="property">value</span> !== <span class="string">&#x27;parent&#x27;</span>) &#123;</span><br><span class="line">      currentLevel.<span class="property">value</span> = <span class="string">&#x27;parent&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isParentPoint &amp;&amp; currentLevel.<span class="property">value</span> !== <span class="string">&#x27;child&#x27;</span>) &#123;</span><br><span class="line">      currentLevel.<span class="property">value</span> = <span class="string">&#x27;child&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">updateTooltipPosition</span>(pickedObject)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-性能监控系统"><a href="#3-性能监控系统" class="headerlink" title="3. 性能监控系统"></a>3. 性能监控系统</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 性能监控相关</span></span><br><span class="line"><span class="keyword">let</span> performanceMonitor = <span class="literal">null</span></span><br><span class="line"><span class="keyword">let</span> isHighPerformanceMode = <span class="literal">false</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">HIGH_PERFORMANCE_THRESHOLD</span> = <span class="number">200</span> <span class="comment">// 点位数量阈值</span></span><br><span class="line"><span class="keyword">const</span> performanceStats = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">fps</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">memoryUsage</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">pointCount</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">isHighPerformanceMode</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 性能监控函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">monitorPerformance</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pointCount = pointsData.<span class="property">value</span>.<span class="property">length</span></span><br><span class="line">  <span class="keyword">const</span> status = performanceMonitor?.<span class="title function_">getStatus</span>() || &#123;&#125;</span><br><span class="line">  <span class="keyword">const</span> currentFPS = status.<span class="property">fps</span> || <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> memoryUsage = status.<span class="property">memoryUsage</span> || <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新性能统计</span></span><br><span class="line">  performanceStats.<span class="property">value</span> = &#123;</span><br><span class="line">    <span class="attr">fps</span>: currentFPS,</span><br><span class="line">    memoryUsage,</span><br><span class="line">    pointCount,</span><br><span class="line">    isHighPerformanceMode,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 根据性能指标动态调整</span></span><br><span class="line">  <span class="keyword">if</span> (pointCount &gt; <span class="variable constant_">HIGH_PERFORMANCE_THRESHOLD</span> &amp;&amp; currentFPS &lt; <span class="number">30</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`⚠️ 性能警告: 点位数量(<span class="subst">$&#123;pointCount&#125;</span>)过多，FPS(<span class="subst">$&#123;currentFPS&#125;</span>)过低`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化性能监控</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">initPerformanceMonitor</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; createPerformanceMonitor &#125; = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;./modules/performanceMonitor.js&#x27;</span>)</span><br><span class="line">    performanceMonitor = <span class="title function_">createPerformanceMonitor</span>()</span><br><span class="line">    performanceMonitor.<span class="title function_">start</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;✅ 性能监控已启动&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;⚠️ 性能监控模块加载失败:&#x27;</span>, error)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-动态调整策略"><a href="#4-动态调整策略" class="headerlink" title="4. 动态调整策略"></a>4. 动态调整策略</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态调整节流参数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getThrottleInterval</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pointCount = pointsData.<span class="property">value</span>.<span class="property">length</span></span><br><span class="line">  <span class="keyword">if</span> (pointCount &gt; <span class="variable constant_">HIGH_PERFORMANCE_THRESHOLD</span>) &#123;</span><br><span class="line">    isHighPerformanceMode = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">25</span> <span class="comment">// 点位多时，降低处理频率到40fps</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    isHighPerformanceMode = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">16</span> <span class="comment">// 点位少时，保持60fps</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 高性能模式下的优化</span></span><br><span class="line"><span class="keyword">if</span> (isHighPerformanceMode) &#123;</span><br><span class="line">  <span class="comment">// 在高性能模式下，适度减少处理频率</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &gt; <span class="number">0.05</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="性能数据对比"><a href="#性能数据对比" class="headerlink" title="性能数据对比"></a>性能数据对比</h3><h4 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h4><ul>
<li><strong>点位数量</strong>: 500个</li>
<li><strong>高性能阈值</strong>: 200个点位</li>
<li><strong>节流间隔</strong>: 25ms (40fps)</li>
<li><strong>跳过概率</strong>: 5% (高性能模式)</li>
</ul>
<h4 id="优化前后对比"><a href="#优化前后对比" class="headerlink" title="优化前后对比"></a>优化前后对比</h4><table>
<thead>
<tr>
<th>指标</th>
<th>优化前</th>
<th>优化后</th>
<th>提升幅度</th>
</tr>
</thead>
<tbody><tr>
<td>处理频率</td>
<td>无限制</td>
<td>40fps</td>
<td>显著降低CPU负载</td>
</tr>
<tr>
<td>缓存命中率</td>
<td>0%</td>
<td>100%</td>
<td>避免重复计算</td>
</tr>
<tr>
<td>内存使用</td>
<td>高</td>
<td>低</td>
<td>减少重复分配</td>
</tr>
<tr>
<td>响应时间</td>
<td>不稳定</td>
<td>&lt;100ms</td>
<td>提升用户体验</td>
</tr>
<tr>
<td>FPS</td>
<td>波动大</td>
<td>稳定30+</td>
<td>保证流畅度</td>
</tr>
</tbody></table>
<h4 id="详细性能数据"><a href="#详细性能数据" class="headerlink" title="详细性能数据"></a>详细性能数据</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 500点位性能测试结果</span></span><br><span class="line"><span class="keyword">const</span> performanceResults = &#123;</span><br><span class="line">  <span class="comment">// 优化前</span></span><br><span class="line">  <span class="attr">beforeOptimization</span>: &#123;</span><br><span class="line">    <span class="attr">averageEventsPerSecond</span>: <span class="number">364283.44</span>,</span><br><span class="line">    <span class="attr">totalTime</span>: <span class="number">1.46</span>,</span><br><span class="line">    <span class="attr">processedEvents</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">memoryUsage</span>: <span class="string">&#x27;高&#x27;</span>,</span><br><span class="line">    <span class="attr">fps</span>: <span class="string">&#x27;不稳定&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 优化后</span></span><br><span class="line">  <span class="attr">afterOptimization</span>: &#123;</span><br><span class="line">    <span class="attr">averageEventsPerSecond</span>: <span class="string">&#x27;平衡处理&#x27;</span>,</span><br><span class="line">    <span class="attr">totalTime</span>: <span class="string">&#x27;显著减少&#x27;</span>,</span><br><span class="line">    <span class="attr">processedEvents</span>: <span class="string">&#x27;智能控制&#x27;</span>,</span><br><span class="line">    <span class="attr">memoryUsage</span>: <span class="string">&#x27;低&#x27;</span>,</span><br><span class="line">    <span class="attr">fps</span>: <span class="string">&#x27;稳定30+&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 优化效果</span></span><br><span class="line">  <span class="attr">improvements</span>: &#123;</span><br><span class="line">    <span class="attr">timeReduction</span>: <span class="string">&#x27;90%+&#x27;</span>,</span><br><span class="line">    <span class="attr">cacheHitRate</span>: <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">    <span class="attr">memoryEfficiency</span>: <span class="string">&#x27;显著提升&#x27;</span>,</span><br><span class="line">    <span class="attr">userExperience</span>: <span class="string">&#x27;大幅改善&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="实际应用效果"><a href="#实际应用效果" class="headerlink" title="实际应用效果"></a>实际应用效果</h3><h4 id="用户体验改善"><a href="#用户体验改善" class="headerlink" title="用户体验改善"></a>用户体验改善</h4><ol>
<li><strong>地图移动流畅度</strong>: 显著减少卡顿现象</li>
<li><strong>悬停响应速度</strong>: 缓存机制提升响应速度</li>
<li><strong>实时性能反馈</strong>: 性能监控面板显示当前状态</li>
<li><strong>智能优化</strong>: 根据点位数量自动调整处理策略</li>
</ol>
<h4 id="性能提升"><a href="#性能提升" class="headerlink" title="性能提升"></a>性能提升</h4><ol>
<li><strong>处理频率优化</strong>: 从无限制到最大40fps</li>
<li><strong>缓存命中率</strong>: 减少重复计算，提升响应速度</li>
<li><strong>内存使用</strong>: 通过缓存机制减少内存分配</li>
<li><strong>CPU使用</strong>: 通过节流和重复检测减少CPU负载</li>
</ol>
<h3 id="配置参数"><a href="#配置参数" class="headerlink" title="配置参数"></a>配置参数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 性能优化配置</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PERFORMANCE_CONFIG</span> = &#123;</span><br><span class="line">  <span class="attr">HIGH_PERFORMANCE_THRESHOLD</span>: <span class="number">200</span>, <span class="comment">// 点位数量阈值</span></span><br><span class="line">  <span class="attr">THROTTLE_INTERVAL_STANDARD</span>: <span class="number">16</span>, <span class="comment">// 标准模式节流间隔(ms)</span></span><br><span class="line">  <span class="attr">THROTTLE_INTERVAL_HIGH</span>: <span class="number">25</span>, <span class="comment">// 高性能模式节流间隔(ms)</span></span><br><span class="line">  <span class="attr">SKIP_PROBABILITY</span>: <span class="number">0.05</span>, <span class="comment">// 高性能模式跳过概率</span></span><br><span class="line">  <span class="attr">CACHE_CLEANUP_INTERVAL</span>: <span class="number">30000</span>, <span class="comment">// 缓存清理间隔(ms)</span></span><br><span class="line">  <span class="attr">PERFORMANCE_CHECK_INTERVAL</span>: <span class="number">2000</span>, <span class="comment">// 性能检查间隔(ms)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点位配置</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CONFIG</span> = &#123;</span><br><span class="line">  <span class="attr">POINT_COUNT</span>: <span class="number">500</span>, <span class="comment">// 测试用点位数量</span></span><br><span class="line">  <span class="attr">TOOLTIP_HIDE_DELAY</span>: <span class="number">200</span>, <span class="comment">// 弹框隐藏延迟</span></span><br><span class="line">  <span class="attr">INITIAL_VIEW</span>: &#123;</span><br><span class="line">    <span class="attr">longitude</span>: <span class="number">116.4074</span>,</span><br><span class="line">    <span class="attr">latitude</span>: <span class="number">39.9042</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">4500</span>,</span><br><span class="line">    <span class="attr">pitch</span>: -<span class="number">30</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用建议"><a href="#使用建议" class="headerlink" title="使用建议"></a>使用建议</h3><h4 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h4><ol>
<li>使用性能监控工具</li>
<li>根据点位数量调整 <code>HIGH_PERFORMANCE_THRESHOLD</code> 阈值</li>
<li>监控控制台输出的性能警告信息</li>
<li>使用”🧪 500点位测试”按钮进行快速测试</li>
</ol>
<h4 id="生产环境"><a href="#生产环境" class="headerlink" title="生产环境"></a>生产环境</h4><ol>
<li>根据实际点位数量调整配置参数</li>
<li>定期检查性能监控数据</li>
<li>考虑进一步优化，如LOD（细节层次）管理</li>
<li>监控FPS，低于30时触发性能警告</li>
</ol>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><h4 id="1-缓存管理"><a href="#1-缓存管理" class="headerlink" title="1. 缓存管理"></a>1. 缓存管理</h4><ul>
<li>缓存机制会占用一定内存</li>
<li>需要定期清理缓存</li>
<li>在点位数据更新时清理缓存</li>
</ul>
<h4 id="2-性能平衡"><a href="#2-性能平衡" class="headerlink" title="2. 性能平衡"></a>2. 性能平衡</h4><ul>
<li>高性能模式会降低交互响应性</li>
<li>但保证地图流畅度</li>
<li>根据实际需求调整参数</li>
</ul>
<h4 id="3-模块依赖"><a href="#3-模块依赖" class="headerlink" title="3. 模块依赖"></a>3. 模块依赖</h4><ul>
<li>性能监控模块需要额外加载</li>
<li>失败时会降级处理</li>
<li>不影响基本功能</li>
</ul>
<h4 id="4-阈值调整"><a href="#4-阈值调整" class="headerlink" title="4. 阈值调整"></a>4. 阈值调整</h4><ul>
<li>建议根据实际使用场景调整阈值参数</li>
<li>500个点位是较大的数据量</li>
<li>可能需要进一步优化</li>
</ul>
<h3 id="未来优化方向"><a href="#未来优化方向" class="headerlink" title="未来优化方向"></a>未来优化方向</h3><h4 id="1-LOD管理"><a href="#1-LOD管理" class="headerlink" title="1. LOD管理"></a>1. LOD管理</h4><ul>
<li>实现细节层次管理</li>
<li>根据距离显示不同精度的点位</li>
<li>减少渲染负担</li>
</ul>
<h4 id="2-聚类优化"><a href="#2-聚类优化" class="headerlink" title="2. 聚类优化"></a>2. 聚类优化</h4><ul>
<li>对密集点位进行聚类显示</li>
<li>减少可见点位数量</li>
<li>提升交互性能</li>
</ul>
<h4 id="3-Web-Workers"><a href="#3-Web-Workers" class="headerlink" title="3. Web Workers"></a>3. Web Workers</h4><ul>
<li>使用Web Workers进行后台计算</li>
<li>避免阻塞主线程</li>
<li>提升整体性能</li>
</ul>
<h4 id="4-虚拟化"><a href="#4-虚拟化" class="headerlink" title="4. 虚拟化"></a>4. 虚拟化</h4><ul>
<li>实现点位虚拟化</li>
<li>只渲染可见区域内的点位</li>
<li>大幅减少渲染负担</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过以上优化方案，500个点位的悬停事件处理得到了显著改善：</p>
<ol>
<li><strong>性能提升</strong>: 通过节流、缓存、重复检测等机制提升性能</li>
<li><strong>用户体验</strong>: 保持流畅的地图交互和及时的悬停响应</li>
<li><strong>智能优化</strong>: 根据点位数量自动调整处理策略</li>
<li><strong>实时监控</strong>: 提供实时的性能监控和反馈</li>
</ol>
<p>这些优化确保了在大量点位场景下仍能保持良好的用户体验和系统性能。</p>
<p>&#x2F;&#x2F; 10. 异步加载优化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">### 📦 异步加载优化</span><br><span class="line"></span><br><span class="line">#### 1. 分批加载策略</span><br><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">// 异步加载大数据集</span><br><span class="line">async function loadLargeDataset(url) &#123;</span><br><span class="line">  const loadingIndicator = showLoadingIndicator()</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line">    // 分批加载数据</span><br><span class="line">    const batchSize = 1000</span><br><span class="line">    let offset = 0</span><br><span class="line">    let hasMore = true</span><br><span class="line"></span><br><span class="line">    while (hasMore) &#123;</span><br><span class="line">      const response = await fetch(`$&#123;url&#125;?offset=$&#123;offset&#125;&amp;limit=$&#123;batchSize&#125;`)</span><br><span class="line">      const batch = await response.json()</span><br><span class="line"></span><br><span class="line">      if (batch.length === 0) &#123;</span><br><span class="line">        hasMore = false</span><br><span class="line">        break</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 异步处理批次</span><br><span class="line">      await new Promise((resolve) =&gt; &#123;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">          processBatch(batch)</span><br><span class="line">          resolve()</span><br><span class="line">        &#125;, 0)</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      offset += batchSize</span><br><span class="line"></span><br><span class="line">      // 更新进度</span><br><span class="line">      updateProgress(offset)</span><br><span class="line"></span><br><span class="line">      // 让浏览器有机会更新UI</span><br><span class="line">      await new Promise((resolve) =&gt; requestAnimationFrame(resolve))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; catch (error) &#123;</span><br><span class="line">    console.error(&#x27;加载数据失败:&#x27;, error)</span><br><span class="line">  &#125; finally &#123;</span><br><span class="line">    hideLoadingIndicator(loadingIndicator)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 处理批次数据</span><br><span class="line">function processBatch(data) &#123;</span><br><span class="line">  const entities = []</span><br><span class="line"></span><br><span class="line">  data.forEach((item) =&gt; &#123;</span><br><span class="line">    entities.push(&#123;</span><br><span class="line">      position: Cesium.Cartesian3.fromDegrees(item.lon, item.lat, item.alt),</span><br><span class="line">      point: &#123;</span><br><span class="line">        pixelSize: 5,</span><br><span class="line">        color: Cesium.Color.fromCssColorString(item.color),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  viewer.entities.add(entities)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-WebWorker-优化"><a href="#2-WebWorker-优化" class="headerlink" title="2. WebWorker 优化"></a>2. WebWorker 优化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主线程 - 使用WebWorker处理大数据</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;./workers/dataProcessor.js&#x27;</span>)</span><br><span class="line"></span><br><span class="line">worker.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;PROCESS_LARGE_DATASET&#x27;</span>,</span><br><span class="line">  <span class="attr">data</span>: largeDataArray,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">worker.<span class="property">onmessage</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; type, result &#125; = event.<span class="property">data</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;PROCESSING_COMPLETE&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 在主线程中添加处理结果</span></span><br><span class="line">    result.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      viewer.<span class="property">entities</span>.<span class="title function_">add</span>(item)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// dataProcessor.js (WebWorker)</span></span><br><span class="line">self.<span class="property">onmessage</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; type, data &#125; = event.<span class="property">data</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;PROCESS_LARGE_DATASET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = []</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在Worker中进行重计算</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> item = data[i]</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 复杂的数据处理</span></span><br><span class="line">      <span class="keyword">const</span> processed = <span class="title function_">complexCalculation</span>(item)</span><br><span class="line">      result.<span class="title function_">push</span>(processed)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 定期发送进度更新</span></span><br><span class="line">      <span class="keyword">if</span> (i % <span class="number">1000</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        self.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;PROGRESS_UPDATE&#x27;</span>,</span><br><span class="line">          <span class="attr">progress</span>: i / data.<span class="property">length</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    self.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;PROCESSING_COMPLETE&#x27;</span>,</span><br><span class="line">      <span class="attr">result</span>: result,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">complexCalculation</span>(<span class="params">item</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行复杂计算</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">position</span>: [item.<span class="property">x</span> * <span class="number">1.5</span>, item.<span class="property">y</span> * <span class="number">1.5</span>, item.<span class="property">z</span> * <span class="number">1.5</span>],</span><br><span class="line">    <span class="attr">color</span>: <span class="title function_">generateColor</span>(item.<span class="property">value</span>),</span><br><span class="line">    <span class="attr">properties</span>: <span class="title function_">processProperties</span>(item.<span class="property">attributes</span>),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-视口优化"><a href="#3-视口优化" class="headerlink" title="3. 视口优化"></a>3. 视口优化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 优化视口和分辨率</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">optimizeForViewport</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> canvas = viewer.<span class="property">canvas</span></span><br><span class="line">  <span class="keyword">const</span> rect = canvas.<span class="title function_">getBoundingClientRect</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 调整画布分辨率</span></span><br><span class="line">  <span class="keyword">const</span> devicePixelRatio = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> || <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> displayWidth = rect.<span class="property">width</span></span><br><span class="line">  <span class="keyword">const</span> displayHeight = rect.<span class="property">height</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 限制最大分辨率以提高性能</span></span><br><span class="line"><span class="keyword">const</span> maxPixelRatio = <span class="number">2</span></span><br><span class="line"><span class="keyword">const</span> actualPixelRatio = <span class="title class_">Math</span>.<span class="title function_">min</span>(devicePixelRatio, maxPixelRatio)</span><br><span class="line"></span><br><span class="line">canvas.<span class="property">width</span> = displayWidth _actualPixelRatio</span><br><span class="line">canvas.<span class="property">height</span> = displayHeight_ actualPixelRatio</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新WebGL视口</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">context</span>.\_gl.<span class="title function_">viewport</span>(<span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应窗口大小变化</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="title function_">throttle</span>(optimizeForViewport, <span class="number">250</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 13. 缓存策略</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResourceCache</span> &#123;</span><br><span class="line"><span class="title function_">constructor</span>(<span class="params">maxSize = <span class="number">100</span></span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cache</span> = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">maxSize</span> = maxSize</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">get</span>(<span class="params">key</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">has</span>(key)) &#123;</span><br><span class="line"><span class="comment">// LRU: 移到末尾</span></span><br><span class="line"><span class="keyword">const</span> value = <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">get</span>(key)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">delete</span>(key)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">set</span>(key, value)</span><br><span class="line"><span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">set</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">has</span>(key)) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">delete</span>(key)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cache</span>.<span class="property">size</span> &gt;= <span class="variable language_">this</span>.<span class="property">maxSize</span>) &#123;</span><br><span class="line"><span class="comment">// 删除最少使用的项目</span></span><br><span class="line"><span class="keyword">const</span> firstKey = <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">keys</span>().<span class="title function_">next</span>().<span class="property">value</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">delete</span>(firstKey)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">set</span>(key, value)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">clear</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">clear</span>()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resourceCache = <span class="keyword">new</span> <span class="title class_">ResourceCache</span>(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 缓存纹理加载</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loadTextureWithCache</span>(<span class="params">url</span>) &#123;</span><br><span class="line"><span class="keyword">const</span> cached = resourceCache.<span class="title function_">get</span>(url)</span><br><span class="line"><span class="keyword">if</span> (cached) &#123;</span><br><span class="line"><span class="keyword">return</span> cached</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> texture = <span class="keyword">await</span> <span class="title function_">loadTexture</span>(url)</span><br><span class="line">resourceCache.<span class="title function_">set</span>(url, texture)</span><br><span class="line"><span class="keyword">return</span> texture</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 14. 性能监控</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PerformanceMonitor</span> &#123;</span><br><span class="line"><span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">metrics</span> = &#123;</span><br><span class="line"><span class="attr">fps</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">frameTime</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">memoryUsage</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">primitiveCount</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">entityCount</span>: <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastTime</span> = performance.<span class="title function_">now</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">frameCount</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fpsUpdateInterval</span> = <span class="number">1000</span> <span class="comment">// 1秒更新一次FPS</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> currentTime = performance.<span class="title function_">now</span>()</span><br><span class="line"><span class="keyword">const</span> deltaTime = currentTime - <span class="variable language_">this</span>.<span class="property">lastTime</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">frameCount</span>++</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (deltaTime &gt;= <span class="variable language_">this</span>.<span class="property">fpsUpdateInterval</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">fps</span> = <span class="title class_">Math</span>.<span class="title function_">round</span>((<span class="variable language_">this</span>.<span class="property">frameCount</span> * <span class="number">1000</span>) / deltaTime)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">frameTime</span> = deltaTime / <span class="variable language_">this</span>.<span class="property">frameCount</span></span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">frameCount</span> = <span class="number">0</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">lastTime</span> = currentTime</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 更新其他指标</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateMemoryUsage</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateCounts</span>()</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 触发性能警告</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">checkPerformance</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">updateMemoryUsage</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (performance.<span class="property">memory</span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">memoryUsage</span> = performance.<span class="property">memory</span>.<span class="property">usedJSHeapSize</span> / <span class="number">1024</span> / <span class="number">1024</span> <span class="comment">// MB</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">updateCounts</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">primitiveCount</span> = viewer.<span class="property">scene</span>.<span class="property">primitives</span>.<span class="property">length</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">entityCount</span> = viewer.<span class="property">entities</span>.<span class="property">values</span>.<span class="property">length</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">checkPerformance</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">fps</span> &lt; <span class="number">30</span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;性能警告: FPS过低&#x27;</span>, <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">fps</span>)</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">suggestOptimizations</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">memoryUsage</span> &gt; <span class="number">500</span>) &#123;</span><br><span class="line">      <span class="comment">// 500MB</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;内存警告: 内存使用过高&#x27;</span>, <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">memoryUsage</span>, <span class="string">&#x27;MB&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">suggestMemoryOptimizations</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">suggestOptimizations</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> suggestions = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">entityCount</span> &gt; <span class="number">10000</span>) &#123;</span><br><span class="line">      suggestions.<span class="title function_">push</span>(<span class="string">&#x27;实体数量过多，考虑使用Primitive或聚类&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">primitiveCount</span> &gt; <span class="number">100</span>) &#123;</span><br><span class="line">      suggestions.<span class="title function_">push</span>(<span class="string">&#x27;图元数量过多，考虑合并几何体&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!viewer.<span class="property">scene</span>.<span class="property">requestRenderMode</span>) &#123;</span><br><span class="line">      suggestions.<span class="title function_">push</span>(<span class="string">&#x27;启用按需渲染模式&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;性能优化建议:&#x27;</span>, suggestions)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">suggestMemoryOptimizations</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;内存优化建议:&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;- 清理未使用的实体和图元&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;- 减少高分辨率纹理的使用&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;- 启用瓦片缓存限制&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;- 检查内存泄漏&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getReport</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">...<span class="variable language_">this</span>.<span class="property">metrics</span>,</span><br><span class="line"><span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>(),</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> performanceMonitor = <span class="keyword">new</span> <span class="title class_">PerformanceMonitor</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在渲染循环中更新性能监控</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">postRender</span>.<span class="title function_">addEventListener</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">performanceMonitor.<span class="title function_">update</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 显示性能信息</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">displayPerformanceInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> report = performanceMonitor.<span class="title function_">getReport</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> infoDiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;performance-info&#x27;</span>) || <span class="title function_">createPerformanceInfoDiv</span>()</span><br><span class="line">infoDiv.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;div&gt;FPS: <span class="subst">$&#123;report.fps&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;帧时间: <span class="subst">$&#123;report.frameTime.toFixed(<span class="number">2</span>)&#125;</span>ms&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;内存使用: <span class="subst">$&#123;report.memoryUsage.toFixed(<span class="number">2</span>)&#125;</span>MB&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;图元数量: <span class="subst">$&#123;report.primitiveCount&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;实体数量: <span class="subst">$&#123;report.entityCount&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createPerformanceInfoDiv</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">div.<span class="property">id</span> = <span class="string">&#x27;performance-info&#x27;</span></span><br><span class="line">div.<span class="property">style</span>.<span class="property">cssText</span> = <span class="string">`position: absolute;</span></span><br><span class="line"><span class="string">    top: 10px;</span></span><br><span class="line"><span class="string">    right: 10px;</span></span><br><span class="line"><span class="string">    background: rgba(0,0,0,0.8);</span></span><br><span class="line"><span class="string">    color: white;</span></span><br><span class="line"><span class="string">    padding: 10px;</span></span><br><span class="line"><span class="string">    border-radius: 5px;</span></span><br><span class="line"><span class="string">    font-family: monospace;</span></span><br><span class="line"><span class="string">    font-size: 12px;</span></span><br><span class="line"><span class="string">    z-index: 1000;</span></span><br><span class="line"><span class="string"> `</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(div)</span><br><span class="line"><span class="keyword">return</span> div</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定期更新显示</span></span><br><span class="line"><span class="built_in">setInterval</span>(displayPerformanceInfo, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 15. 最佳实践总结</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PERFORMANCE_BEST_PRACTICES</span> = &#123;</span><br><span class="line"><span class="comment">// 渲染优化</span></span><br><span class="line"><span class="attr">rendering</span>: [<span class="string">&#x27;启用按需渲染模式&#x27;</span>, <span class="string">&#x27;使用适当的LOD设置&#x27;</span>, <span class="string">&#x27;启用视锥剔除&#x27;</span>, <span class="string">&#x27;合理使用后处理效果&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实体优化</span></span><br><span class="line"><span class="attr">entities</span>: [</span><br><span class="line"><span class="string">&#x27;大量几何体使用Primitive&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;启用实体聚类&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;设置距离显示条件&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;使用简单材质而非复杂纹理&#x27;</span>,</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 内存管理</span></span><br><span class="line"><span class="attr">memory</span>: [</span><br><span class="line"><span class="string">&#x27;定期清理未使用的资源&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;限制同时加载的数据量&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;使用对象池重用资源&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;监控内存使用情况&#x27;</span>,</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据加载</span></span><br><span class="line"><span class="attr">dataLoading</span>: [</span><br><span class="line"><span class="string">&#x27;异步分批加载大数据集&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;使用WebWorker处理复杂计算&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;实现资源缓存策略&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;压缩和优化数据格式&#x27;</span>,</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户交互</span></span><br><span class="line"><span class="attr">interaction</span>: [<span class="string">&#x27;节流高频事件&#x27;</span>, <span class="string">&#x27;防抖用户输入&#x27;</span>, <span class="string">&#x27;异步处理UI更新&#x27;</span>, <span class="string">&#x27;提供加载进度反馈&#x27;</span>],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Cesium性能优化最佳实践:&#x27;</span>, <span class="variable constant_">PERFORMANCE_BEST_PRACTICES</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📚-总结"><a href="#📚-总结" class="headerlink" title="📚 总结"></a>📚 总结</h2><p>本指南涵盖了Cesium离线开发的所有核心概念和详细属性说明，包括：</p>
<ul>
<li><strong>环境配置</strong>: 完整的离线开发环境搭建</li>
<li><strong>Viewer配置</strong>: 详细的构造参数和渲染选项</li>
<li><strong>坐标系统</strong>: 完整的坐标转换和数学运算</li>
<li><strong>实体系统</strong>: 所有图形类型的详细属性</li>
<li><strong>影像地形</strong>: 各种提供者的配置选项</li>
<li><strong>相机控制</strong>: 完整的相机操作方法</li>
<li><strong>事件处理</strong>: 屏幕空间事件的详细处理</li>
<li><strong>材质系统</strong>: 各种内置和自定义材质</li>
<li><strong>动画系统</strong>: 属性动画和时间控制</li>
<li><strong>几何图元</strong>: 低级别图形渲染</li>
<li><strong>场景控制</strong>: 场景和地球的高级配置</li>
<li><strong>数据源</strong>: 各种格式数据的加载和处理</li>
<li><strong>时间系统</strong>: 时间操作和动画控制</li>
<li><strong>性能优化</strong>: 全面的性能优化策略</li>
</ul>
<hr>
<h3 id="📚-最佳实践总结"><a href="#📚-最佳实践总结" class="headerlink" title="📚 最佳实践总结"></a>📚 最佳实践总结</h3><h4 id="🎯-性能优化原则"><a href="#🎯-性能优化原则" class="headerlink" title="🎯 性能优化原则"></a>🎯 性能优化原则</h4><ol>
<li><strong>按需渲染</strong>: 只在必要时触发渲染</li>
<li><strong>LOD管理</strong>: 根据距离显示不同精度</li>
<li><strong>内存管理</strong>: 定期清理未使用资源</li>
<li><strong>事件优化</strong>: 使用节流和委托</li>
<li><strong>异步处理</strong>: 避免阻塞主线程</li>
</ol>
<h4 id="📊-性能监控指标"><a href="#📊-性能监控指标" class="headerlink" title="📊 性能监控指标"></a>📊 性能监控指标</h4><table>
<thead>
<tr>
<th>指标</th>
<th>目标值</th>
<th>监控方法</th>
</tr>
</thead>
<tbody><tr>
<td>FPS</td>
<td>≥30</td>
<td>实时监控</td>
</tr>
<tr>
<td>内存使用</td>
<td>&lt;80%</td>
<td>定期检查</td>
</tr>
<tr>
<td>响应时间</td>
<td>&lt;100ms</td>
<td>用户交互测试</td>
</tr>
<tr>
<td>加载时间</td>
<td>&lt;3s</td>
<td>网络监控</td>
</tr>
</tbody></table>
<h4 id="🔧-配置建议"><a href="#🔧-配置建议" class="headerlink" title="🔧 配置建议"></a>🔧 配置建议</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 性能优化配置</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PERFORMANCE_CONFIG</span> = &#123;</span><br><span class="line">  <span class="comment">// 渲染设置</span></span><br><span class="line">  <span class="attr">REQUEST_RENDER_MODE</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">MAXIMUM_RENDER_TIME_CHANGE</span>: <span class="number">0.0</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// LOD设置</span></span><br><span class="line">  <span class="attr">MAXIMUM_SCREEN_SPACE_ERROR</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">TILE_CACHE_SIZE</span>: <span class="number">200</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 内存管理</span></span><br><span class="line">  <span class="attr">CLEANUP_INTERVAL</span>: <span class="number">30000</span>,</span><br><span class="line">  <span class="attr">MEMORY_WARNING_THRESHOLD</span>: <span class="number">0.8</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件优化</span></span><br><span class="line">  <span class="attr">THROTTLE_INTERVAL</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="attr">HOVER_THROTTLE</span>: <span class="number">25</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 异步加载</span></span><br><span class="line">  <span class="attr">BATCH_SIZE</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="attr">PROGRESS_UPDATE_INTERVAL</span>: <span class="number">1000</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="🚀-开发建议"><a href="#🚀-开发建议" class="headerlink" title="🚀 开发建议"></a>🚀 开发建议</h4><ol>
<li><p><strong>开发阶段</strong></p>
<ul>
<li>使用性能监控工具</li>
<li>定期检查内存使用</li>
<li>测试大数据量场景</li>
</ul>
</li>
<li><p><strong>生产环境</strong></p>
<ul>
<li>启用所有优化选项</li>
<li>监控关键性能指标</li>
<li>准备降级方案</li>
</ul>
</li>
<li><p><strong>维护阶段</strong></p>
<ul>
<li>定期清理缓存</li>
<li>监控用户反馈</li>
<li>持续优化性能</li>
</ul>
</li>
</ol>
<h4 id="⚠️-注意事项"><a href="#⚠️-注意事项" class="headerlink" title="⚠️ 注意事项"></a>⚠️ 注意事项</h4><ol>
<li><strong>兼容性</strong>: 确保优化方案在不同浏览器中正常工作</li>
<li><strong>降级处理</strong>: 提供优化失败时的降级方案</li>
<li><strong>用户体验</strong>: 平衡性能优化和用户体验</li>
<li><strong>内存泄漏</strong>: 注意及时清理事件监听器和缓存</li>
</ol>
<h4 id="🔮-未来发展方向"><a href="#🔮-未来发展方向" class="headerlink" title="🔮 未来发展方向"></a>🔮 未来发展方向</h4><ol>
<li><strong>WebGPU</strong>: 利用新一代图形API</li>
<li><strong>虚拟化</strong>: 只渲染可见区域</li>
<li><strong>AI优化</strong>: 智能预测用户行为</li>
<li><strong>边缘计算</strong>: 分布式渲染</li>
</ol>
<hr>
<p>这份指南为离线Cesium开发提供了完整的参考，每个属性都包含了作用说明、默认值、使用示例，帮助开发者在无网络环境下也能高效开发Cesium应用。</p>
<h3 id="时间轴与动画（进阶示例）"><a href="#时间轴与动画（进阶示例）" class="headerlink" title="时间轴与动画（进阶示例）"></a>时间轴与动画（进阶示例）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置时间轴与速率</span></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">startTime</span> = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2024-01-01T00:00:00Z&#x27;</span>))</span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">stopTime</span> = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">fromDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2024-01-01T01:00:00Z&#x27;</span>))</span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">currentTime</span> = viewer.<span class="property">clock</span>.<span class="property">startTime</span>.<span class="title function_">clone</span>()</span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">clockRange</span> = <span class="title class_">Cesium</span>.<span class="property">ClockRange</span>.<span class="property">LOOP_STOP</span> <span class="comment">// 循环</span></span><br><span class="line">viewer.<span class="property">clock</span>.<span class="property">multiplier</span> = <span class="number">10</span> <span class="comment">// 时间加速10倍</span></span><br><span class="line">viewer.<span class="property">timeline</span>.<span class="title function_">zoomTo</span>(viewer.<span class="property">clock</span>.<span class="property">startTime</span>, viewer.<span class="property">clock</span>.<span class="property">stopTime</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于时序变化实体属性</span></span><br><span class="line"><span class="keyword">const</span> movingPoint = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">CallbackProperty</span>(<span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> seconds = <span class="title class_">Cesium</span>.<span class="property">JulianDate</span>.<span class="title function_">secondsDifference</span>(time, viewer.<span class="property">clock</span>.<span class="property">startTime</span>)</span><br><span class="line">    <span class="keyword">const</span> lon = <span class="number">116.4</span> + seconds * <span class="number">0.0001</span></span><br><span class="line">    <span class="keyword">const</span> lat = <span class="number">39.9</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(lon, lat)</span><br><span class="line">  &#125;, <span class="literal">false</span>),</span><br><span class="line">  <span class="attr">point</span>: &#123; <span class="attr">pixelSize</span>: <span class="number">8</span>, <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">YELLOW</span> &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="几何图元（低级-Primitive）实战"><a href="#几何图元（低级-Primitive）实战" class="headerlink" title="几何图元（低级 Primitive）实战"></a>几何图元（低级 Primitive）实战</h2><p>当 Entity 数量巨大且样式统一时，使用 Primitive 可显著降低管理开销。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 GroundPolylinePrimitive 批量绘制贴地线</span></span><br><span class="line"><span class="keyword">await</span> <span class="title class_">Cesium</span>.<span class="property">GroundPolylinePrimitive</span>.<span class="title function_">initializeTerrainHeights</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instances = lines.<span class="title function_">map</span>(</span><br><span class="line">  <span class="function">(<span class="params">l</span>) =&gt;</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GeometryInstance</span>(&#123;</span><br><span class="line">      <span class="attr">geometry</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GroundPolylineGeometry</span>(&#123;</span><br><span class="line">        <span class="attr">positions</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegreesArray</span>(l.<span class="title function_">flat</span>()),</span><br><span class="line">        <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">arcType</span>: <span class="title class_">Cesium</span>.<span class="property">ArcType</span>.<span class="property">GEODESIC</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> primitive = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">GroundPolylinePrimitive</span>(&#123;</span><br><span class="line">  <span class="attr">geometryInstances</span>: instances,</span><br><span class="line">  <span class="attr">appearance</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PolylineMaterialAppearance</span>(&#123;</span><br><span class="line">    <span class="attr">material</span>: <span class="title class_">Cesium</span>.<span class="property">Material</span>.<span class="title function_">fromType</span>(<span class="string">&#x27;Color&#x27;</span>, &#123; <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">CYAN</span>.<span class="title function_">withAlpha</span>(<span class="number">0.7</span>) &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">groundPrimitives</span>.<span class="title function_">add</span>(primitive)</span><br></pre></td></tr></table></figure>

<p>要点：</p>
<ul>
<li>使用单一材质与统一宽度，便于合并。</li>
<li>需要贴地&#x2F;地形支持时，优先 GroundPolyline 系列。</li>
</ul>
<hr>
<h2 id="屏幕空间事件最佳实践"><a href="#屏幕空间事件最佳实践" class="headerlink" title="屏幕空间事件最佳实践"></a>屏幕空间事件最佳实践</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 节流 + 命中缓存，减少 pick 频率</span></span><br><span class="line"><span class="keyword">const</span> handler = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">ScreenSpaceEventHandler</span>(viewer.<span class="property">canvas</span>)</span><br><span class="line"><span class="keyword">let</span> lastPickId = <span class="literal">null</span></span><br><span class="line"><span class="keyword">let</span> lastPickTime = <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PICK_THROTTLE</span> = <span class="number">16</span> <span class="comment">// ms</span></span><br><span class="line"></span><br><span class="line">handler.<span class="title function_">setInputAction</span>(<span class="function">(<span class="params">movement</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> now = performance.<span class="title function_">now</span>()</span><br><span class="line">  <span class="keyword">if</span> (now - lastPickTime &lt; <span class="variable constant_">PICK_THROTTLE</span>) <span class="keyword">return</span></span><br><span class="line">  lastPickTime = now</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> picked = viewer.<span class="property">scene</span>.<span class="title function_">pick</span>(movement.<span class="property">endPosition</span>)</span><br><span class="line">  <span class="keyword">const</span> id = picked?.<span class="property">id</span> || <span class="literal">null</span></span><br><span class="line">  <span class="keyword">if</span> (id === lastPickId) <span class="keyword">return</span></span><br><span class="line">  lastPickId = id</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新 UI 或 Tooltip</span></span><br><span class="line">  <span class="keyword">if</span> (id) &#123;</span><br><span class="line">    <span class="comment">// showTooltip(...)</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// hideTooltip()</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="title class_">Cesium</span>.<span class="property">ScreenSpaceEventType</span>.<span class="property">MOUSE_MOVE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清理</span></span><br><span class="line"><span class="comment">// handler.destroy()</span></span><br></pre></td></tr></table></figure>

<p>建议：</p>
<ul>
<li>鼠标移动事件合并&#x2F;节流，避免每帧 pick。</li>
<li>使用 <code>scene.pickPositionSupported</code> 判断是否支持深度拾取，再决定 <code>pickPosition</code> 方案。</li>
</ul>
<hr>
<h2 id="大规模实体管理策略"><a href="#大规模实体管理策略" class="headerlink" title="大规模实体管理策略"></a>大规模实体管理策略</h2><p>针对 10w+ 点&#x2F;线：</p>
<ul>
<li>批量创建：先构造数组再一次性 <code>viewer.entities.add(array)</code>。</li>
<li>分批加载：切片（空间网格或四叉树）+ 分段请求。</li>
<li>可见性裁剪：<ul>
<li>距离阈值隐藏远处实体；</li>
<li>屏幕空间密度控制（按像素密度抽稀）。</li>
</ul>
</li>
<li>降级渲染：远距离改用 Billboards 或 Primitive；近距离再切换详细 Entity。</li>
<li>Worker 并行：几何计算、筛选在 Worker 内完成，主线程仅做绘制。</li>
</ul>
<p>示例：分批+抽稀</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEntitiesInChunks</span>(<span class="params">data, chunkSize = <span class="number">2000</span></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i += chunkSize) &#123;</span><br><span class="line">    <span class="keyword">const</span> chunk = data.<span class="title function_">slice</span>(i, i + chunkSize)</span><br><span class="line">    <span class="keyword">const</span> batch = chunk.<span class="title function_">map</span>(<span class="function">(<span class="params">d</span>) =&gt;</span> (&#123;</span><br><span class="line">      <span class="attr">position</span>: <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">fromDegrees</span>(d.<span class="property">lon</span>, d.<span class="property">lat</span>),</span><br><span class="line">      <span class="attr">point</span>: &#123; <span class="attr">pixelSize</span>: <span class="number">6</span>, <span class="attr">color</span>: <span class="title class_">Cesium</span>.<span class="property">Color</span>.<span class="property">SKYBLUE</span> &#125;,</span><br><span class="line">    &#125;))</span><br><span class="line">    viewer.<span class="property">entities</span>.<span class="title function_">add</span>(batch)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">visibilityCullByDistance</span>(<span class="params">camera, entities, maxDistance = <span class="number">50000</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> camPos = camera.<span class="property">positionWC</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> e <span class="keyword">of</span> entities.<span class="property">values</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pos = e.<span class="property">position</span>?.<span class="title function_">getValue</span>(viewer.<span class="property">clock</span>.<span class="property">currentTime</span>)</span><br><span class="line">    <span class="keyword">if</span> (!pos) <span class="keyword">continue</span></span><br><span class="line">    e.<span class="property">show</span> = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">distance</span>(camPos, pos) &lt; maxDistance</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>提示：当实体达到瓶颈时，迁移到 Primitive（如 <code>GroundPolylinePrimitive</code> 或 <code>PrimitiveCollection</code>）通常收益更大。</p>
<hr>
<h2 id="🎨-自定义后处理（PostProcessStage）"><a href="#🎨-自定义后处理（PostProcessStage）" class="headerlink" title="🎨 自定义后处理（PostProcessStage）"></a>🎨 自定义后处理（PostProcessStage）</h2><h3 id="1-单一后处理阶段（Edge-Detect-示例）"><a href="#1-单一后处理阶段（Edge-Detect-示例）" class="headerlink" title="1) 单一后处理阶段（Edge Detect 示例）"></a>1) 单一后处理阶段（Edge Detect 示例）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义边缘检测后处理（片元着色器）</span></span><br><span class="line"><span class="keyword">const</span> edgeFrag = <span class="string">`</span></span><br><span class="line"><span class="string">  uniform sampler2D colorTexture;</span></span><br><span class="line"><span class="string">  uniform vec2 texelStep;</span></span><br><span class="line"><span class="string">  varying vec2 v_textureCoordinates;</span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    vec3 tc = texture2D(colorTexture, v_textureCoordinates).rgb;</span></span><br><span class="line"><span class="string">    vec3 tx = texture2D(colorTexture, v_textureCoordinates + vec2(texelStep.x, 0.0)).rgb;</span></span><br><span class="line"><span class="string">    vec3 ty = texture2D(colorTexture, v_textureCoordinates + vec2(0.0, texelStep.y)).rgb;</span></span><br><span class="line"><span class="string">    float diff = length(tc - tx) + length(tc - ty);</span></span><br><span class="line"><span class="string">    float edge = step(0.15, diff);</span></span><br><span class="line"><span class="string">    gl_FragColor = vec4(vec3(edge), 1.0);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">const</span> edgeStage = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PostProcessStage</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;edgeStage&#x27;</span>,</span><br><span class="line">  <span class="attr">fragmentShader</span>: edgeFrag,</span><br><span class="line">  <span class="attr">uniforms</span>: &#123;</span><br><span class="line">    <span class="attr">texelStep</span>: <span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian2</span>(<span class="number">1.0</span> / viewer.<span class="property">canvas</span>.<span class="property">width</span>, <span class="number">1.0</span> / viewer.<span class="property">canvas</span>.<span class="property">height</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">postProcessStages</span>.<span class="title function_">add</span>(edgeStage)</span><br><span class="line">edgeStage.<span class="property">enabled</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="2-组合后处理（Composite：Bloom-自定义）"><a href="#2-组合后处理（Composite：Bloom-自定义）" class="headerlink" title="2) 组合后处理（Composite：Bloom + 自定义）"></a>2) 组合后处理（Composite：Bloom + 自定义）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bloom = viewer.<span class="property">scene</span>.<span class="property">postProcessStages</span>.<span class="property">bloom</span></span><br><span class="line">bloom.<span class="property">enabled</span> = <span class="literal">true</span></span><br><span class="line">bloom.<span class="property">uniforms</span>.<span class="property">glowOnly</span> = <span class="literal">false</span></span><br><span class="line">bloom.<span class="property">uniforms</span>.<span class="property">contrast</span> = <span class="number">128</span></span><br><span class="line">bloom.<span class="property">uniforms</span>.<span class="property">brightness</span> = -<span class="number">0.3</span></span><br><span class="line">bloom.<span class="property">uniforms</span>.<span class="property">delta</span> = <span class="number">1.0</span></span><br><span class="line">bloom.<span class="property">uniforms</span>.<span class="property">sigma</span> = <span class="number">2.0</span></span><br><span class="line">bloom.<span class="property">uniforms</span>.<span class="property">stepSize</span> = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> toneMapFrag = <span class="string">`</span></span><br><span class="line"><span class="string">  uniform sampler2D colorTexture; varying vec2 v_textureCoordinates;</span></span><br><span class="line"><span class="string">  void main()&#123; vec3 col = texture2D(colorTexture, v_textureCoordinates).rgb;</span></span><br><span class="line"><span class="string">    col = col / (col + vec3(1.0)); gl_FragColor = vec4(col, 1.0);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">const</span> toneMapStage = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PostProcessStage</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;toneMap&#x27;</span>, <span class="attr">fragmentShader</span>: toneMapFrag &#125;)</span><br><span class="line"><span class="keyword">const</span> composite = <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">PostProcessStageComposite</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;customComposite&#x27;</span>,</span><br><span class="line">  <span class="attr">stages</span>: [toneMapStage, bloom],</span><br><span class="line">&#125;)</span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">postProcessStages</span>.<span class="title function_">add</span>(composite)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="🧪-Shader-与-czm-内置速查（精选）"><a href="#🧪-Shader-与-czm-内置速查（精选）" class="headerlink" title="🧪 Shader 与 czm 内置速查（精选）"></a>🧪 Shader 与 czm 内置速查（精选）</h2><ul>
<li>czm 内置：<code>czm_frameNumber</code>, <code>czm_pixelRatio</code>, <code>czm_model/view/projection</code>, <code>czm_inverseViewProjection</code>, <code>czm_eyePosition</code>, <code>czm_geodeticSurfaceNormal</code>, <code>czm_unpackDepth</code>, <code>czm_morphTime</code></li>
<li>Fabric 提示：纹理用 <code>sampler2D</code>，时间驱动统一用 <code>czm_frameNumber</code> 或 <code>time</code>，透明设置 <code>translucent</code></li>
</ul>
<hr>
<h2 id="⛰️-地形-阴影-透明度-排序避坑"><a href="#⛰️-地形-阴影-透明度-排序避坑" class="headerlink" title="⛰️ 地形 &#x2F; 阴影 &#x2F; 透明度 排序避坑"></a>⛰️ 地形 &#x2F; 阴影 &#x2F; 透明度 排序避坑</h2><ul>
<li>贴地初始化：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> <span class="title class_">Cesium</span>.<span class="property">GroundPolylinePrimitive</span>.<span class="title function_">initializeTerrainHeights</span>()</span><br></pre></td></tr></table></figure>

<ul>
<li>透明排序：尽量合并、减少重叠；必要时关闭部分深度测试或调整顺序；可尝试 <code>viewer.scene.orderIndependentTranslucency</code>。</li>
<li>阴影：<code>viewer.shadows = true</code>；细化到实体 <code>ShadowMode</code> 控制。</li>
</ul>
<hr>
<h2 id="🧰-更多实践建议"><a href="#🧰-更多实践建议" class="headerlink" title="🧰 更多实践建议"></a>🧰 更多实践建议</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">viewer.<span class="property">scene</span>.<span class="property">requestRenderMode</span> = <span class="literal">true</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="property">maximumRenderTimeChange</span> = <span class="number">0.0</span></span><br><span class="line">viewer.<span class="property">scene</span>.<span class="title function_">requestRender</span>()</span><br></pre></td></tr></table></figure>

<ul>
<li>大数据优先级：Primitive &gt; 批量 Entity（分批+裁剪） &gt; LOD（远 Billboards、近细节）</li>
<li>事件节流与拾取回退；Worker 做几何与筛选，主线程绘制。</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://aoayaoa.github.io">aoaYaoa</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://aoayaoa.github.io/2025/07/31/cesium/">https://aoayaoa.github.io/2025/07/31/cesium/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://aoayaoa.github.io" target="_blank">aoaYaoa</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Cesium/">Cesium</a><a class="post-meta__tags" href="/tags/%E4%B8%89%E7%BB%B4GIS/">三维GIS</a></div><div class="post-share"><div class="social-share" data-image="/img/cesium.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/31/babylonjs/" title="BabylonJS"><img class="cover" src="/img/babylonjs.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">BabylonJS</div></div><div class="info-2"><div class="info-item-1">BabylonJS 完整离线开发指南📋 目录 BabylonJS 完整离线开发指南 📋 目录 🚀 BabylonJS 简介 💻 离线环境配置 🎯 核心概念 🎬 Engine 引擎详解 🎭 Scene 场景详解 📷 Camera 相机系统详解 💡 Light 光照系统详解 🎨 Material 材质系统详解 🎭 Mesh 网格系统详解 🎬 Animation 动画系统详解 🎆 ParticleSystem 粒子系统详解 🔊 Audio 音频系统详解 🎮 Input 输入系统详解 🔧 Asset 资源管理详解 ⚡ Performance 性能优化详解 🤝...</div></div></div></a><a class="pagination-related" href="/2025/07/31/mars3d/" title="mars3D 开发文档"><img class="cover" src="/img/mars3d.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">mars3D 开发文档</div></div><div class="info-2"><div class="info-item-1">Mars3D 完整离线开发指南📋 目录 离线环境配置 Map 详细配置 坐标系统详解 图层系统完整属性 矢量数据详解 三维模型详解 相机控制完整属性 事件系统详解 材质系统详解 动画系统详解 分析功能详解 控件系统详解 绘制功能详解  离线环境配置完整离线包下载12345678910111213141516# 1. 下载Mars3D完整包wget https://github.com/marsgis/mars3d/releases/latest/mars3d.zip# 2. 解压到项目目录unzip mars3d.zip -d public/mars3d/# 3....</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/31/mars3d/" title="mars3D 开发文档"><img class="cover" src="/img/mars3d.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-31</div><div class="info-item-2">mars3D 开发文档</div></div><div class="info-2"><div class="info-item-1">Mars3D 完整离线开发指南📋 目录 离线环境配置 Map 详细配置 坐标系统详解 图层系统完整属性 矢量数据详解 三维模型详解 相机控制完整属性 事件系统详解 材质系统详解 动画系统详解 分析功能详解 控件系统详解 绘制功能详解  离线环境配置完整离线包下载12345678910111213141516# 1. 下载Mars3D完整包wget https://github.com/marsgis/mars3d/releases/latest/mars3d.zip# 2. 解压到项目目录unzip mars3d.zip -d public/mars3d/# 3....</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">aoaYaoa</div><div class="author-info-description">个人博客，记录成长点滴...</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/aoaYaoa"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/aoaYaoa" rel="external nofollow noreferrer" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #181717;"></i></a><a class="social-icon" href="https://twitter.com/yourname" rel="external nofollow noreferrer" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color: #1DA1F2;"></i></a><a class="social-icon" href="mailto:skyeeq9@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #EA4335;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">算了，不知道写什么，就这样吧！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Cesium-%E5%AE%8C%E6%95%B4%E7%A6%BB%E7%BA%BF%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">Cesium 完整离线开发指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8B-%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">📋 目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">离线环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E7%A6%BB%E7%BA%BF%E5%8C%85%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.2.1.</span> <span class="toc-text">完整离线包下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vite%E7%A6%BB%E7%BA%BF%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.</span> <span class="toc-text">Vite离线配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.2.3.</span> <span class="toc-text">离线初始化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Viewer-%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.</span> <span class="toc-text">Viewer 详细配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%AE%8C%E6%95%B4%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">构造函数完整参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.4.</span> <span class="toc-text">坐标系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cartesian3-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-number">1.4.1.</span> <span class="toc-text">Cartesian3 笛卡尔坐标系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cartographic-%E5%9C%B0%E7%90%86%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-number">1.4.2.</span> <span class="toc-text">Cartographic 地理坐标系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Matrix4-%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5"><span class="toc-number">1.4.3.</span> <span class="toc-text">Matrix4 变换矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E5%B1%9E%E6%80%A7"><span class="toc-number">1.5.</span> <span class="toc-text">实体系统完整属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Entity-%E5%9F%BA%E7%A1%80%E5%AE%9E%E4%BD%93"><span class="toc-number">1.5.1.</span> <span class="toc-text">Entity 基础实体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BillboardGraphics-%E5%B9%BF%E5%91%8A%E7%89%8C%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.2.</span> <span class="toc-text">BillboardGraphics 广告牌图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PointGraphics-%E7%82%B9%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.3.</span> <span class="toc-text">PointGraphics 点图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LabelGraphics-%E6%A0%87%E7%AD%BE%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.4.</span> <span class="toc-text">LabelGraphics 标签图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PolylineGraphics-%E5%A4%9A%E6%AE%B5%E7%BA%BF%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.5.</span> <span class="toc-text">PolylineGraphics 多段线图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PolygonGraphics-%E5%A4%9A%E8%BE%B9%E5%BD%A2%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.6.</span> <span class="toc-text">PolygonGraphics 多边形图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ModelGraphics-3D%E6%A8%A1%E5%9E%8B%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.7.</span> <span class="toc-text">ModelGraphics 3D模型图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BoxGraphics-%E7%9B%92%E5%AD%90%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.8.</span> <span class="toc-text">BoxGraphics 盒子图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CylinderGraphics-%E5%9C%86%E6%9F%B1%E4%BD%93%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.5.9.</span> <span class="toc-text">CylinderGraphics 圆柱体图形</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%BD%A2%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.6.</span> <span class="toc-text">地形系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TerrainProvider-%E5%9C%B0%E5%BD%A2%E6%8F%90%E4%BE%9B%E8%80%85"><span class="toc-number">1.6.1.</span> <span class="toc-text">TerrainProvider 地形提供者</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E5%B1%9E%E6%80%A7"><span class="toc-number">1.7.</span> <span class="toc-text">相机系统完整属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Camera-%E7%9B%B8%E6%9C%BA%E7%B1%BB"><span class="toc-number">1.7.1.</span> <span class="toc-text">Camera 相机类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.8.</span> <span class="toc-text">事件系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ScreenSpaceEventHandler-%E5%B1%8F%E5%B9%95%E7%A9%BA%E9%97%B4%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">1.8.1.</span> <span class="toc-text">ScreenSpaceEventHandler 屏幕空间事件处理器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%90%E8%B4%A8%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.9.</span> <span class="toc-text">材质系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Material-%E6%9D%90%E8%B4%A8%E7%B1%BB"><span class="toc-number">1.9.1.</span> <span class="toc-text">Material 材质类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.10.</span> <span class="toc-text">动画系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Animation-%E5%8A%A8%E7%94%BB"><span class="toc-number">1.10.1.</span> <span class="toc-text">Animation 动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%A0%E4%BD%95%E4%BD%93%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.11.</span> <span class="toc-text">几何体系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Primitive-%E5%9B%BE%E5%85%83"><span class="toc-number">1.11.1.</span> <span class="toc-text">Primitive 图元</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E6%8E%A7%E5%88%B6%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.12.</span> <span class="toc-text">场景控制详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Scene-%E5%9C%BA%E6%99%AF%E7%B1%BB"><span class="toc-number">1.12.1.</span> <span class="toc-text">Scene 场景类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.13.</span> <span class="toc-text">数据源详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DataSource-%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-number">1.13.1.</span> <span class="toc-text">DataSource 数据源</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%B3%BB%E7%BB%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.14.</span> <span class="toc-text">时间系统详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JulianDate-%E5%84%92%E7%95%A5%E6%97%A5%E6%9C%9F"><span class="toc-number">1.14.1.</span> <span class="toc-text">JulianDate 儒略日期</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%8A%9F%E8%83%BD%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.15.</span> <span class="toc-text">绘制功能详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%B7%A5%E5%85%B7%E5%9F%BA%E7%B1%BB"><span class="toc-number">1.15.1.</span> <span class="toc-text">绘制工具基类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">1.15.2.</span> <span class="toc-text">绘制管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%B7%A5%E5%85%B7%E6%A0%8F"><span class="toc-number">1.15.3.</span> <span class="toc-text">绘制工具栏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%A1-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.16.</span> <span class="toc-text">⚡ 性能优化详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8B-%E7%9B%AE%E5%BD%95-1"><span class="toc-number">1.16.1.</span> <span class="toc-text">📋 目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%8E%AF-%E6%B8%B2%E6%9F%93%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.2.</span> <span class="toc-text">🎯 渲染优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%8C%89%E9%9C%80%E6%B8%B2%E6%9F%93-On-Demand-Rendering"><span class="toc-number">1.16.2.1.</span> <span class="toc-text">1. 按需渲染 (On-Demand Rendering)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-LOD-Level-of-Detail-%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.2.2.</span> <span class="toc-text">2. LOD (Level of Detail) 优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93%E4%BC%98%E5%8C%96-Entity-Optimization"><span class="toc-number">1.16.2.3.</span> <span class="toc-text">3. 实体优化 (Entity Optimization)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%81%9A%E7%B1%BB%E4%BC%98%E5%8C%96-Clustering"><span class="toc-number">1.16.2.4.</span> <span class="toc-text">4. 聚类优化 (Clustering)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%9D%90%E8%B4%A8%E4%BC%98%E5%8C%96-Material-Optimization"><span class="toc-number">1.16.2.5.</span> <span class="toc-text">5. 材质优化 (Material Optimization)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%A8%A1%E5%9E%8B%E4%BC%98%E5%8C%96-Model-Optimization"><span class="toc-number">1.16.2.6.</span> <span class="toc-text">6. 模型优化 (Model Optimization)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%92%BE-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.16.3.</span> <span class="toc-text">💾 内存管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%B5%84%E6%BA%90%E6%B8%85%E7%90%86%E6%9C%BA%E5%88%B6"><span class="toc-number">1.16.3.1.</span> <span class="toc-text">1. 资源清理机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7"><span class="toc-number">1.16.3.2.</span> <span class="toc-text">2. 内存监控</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%8E%AE-%E4%BA%8B%E4%BB%B6%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.4.</span> <span class="toc-text">🎮 事件优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BA%8B%E4%BB%B6%E8%8A%82%E6%B5%81-Event-Throttling"><span class="toc-number">1.16.4.1.</span> <span class="toc-text">1. 事件节流 (Event Throttling)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98-Event-Delegation"><span class="toc-number">1.16.4.2.</span> <span class="toc-text">2. 事件委托 (Event Delegation)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%8E%AF-%E6%82%AC%E5%81%9C%E4%BA%8B%E4%BB%B6%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.5.</span> <span class="toc-text">🎯 悬停事件性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%93%8A-%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="toc-number">1.16.5.1.</span> <span class="toc-text">📊 问题分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%80-%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.16.5.2.</span> <span class="toc-text">🚀 优化方案实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%8A%82%E6%B5%81%E6%9C%BA%E5%88%B6-Throttling"><span class="toc-number">1.16.5.2.1.</span> <span class="toc-text">1. 节流机制 (Throttling)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6-Caching"><span class="toc-number">1.16.5.2.2.</span> <span class="toc-text">2. 缓存机制 (Caching)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.16.5.2.3.</span> <span class="toc-text">3. 性能监控系统</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%8A%A8%E6%80%81%E8%B0%83%E6%95%B4%E7%AD%96%E7%95%A5"><span class="toc-number">1.16.5.3.</span> <span class="toc-text">4. 动态调整策略</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E5%AF%B9%E6%AF%94"><span class="toc-number">1.16.6.</span> <span class="toc-text">性能数据对比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83"><span class="toc-number">1.16.6.1.</span> <span class="toc-text">测试环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%89%8D%E5%90%8E%E5%AF%B9%E6%AF%94"><span class="toc-number">1.16.6.2.</span> <span class="toc-text">优化前后对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE"><span class="toc-number">1.16.6.3.</span> <span class="toc-text">详细性能数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E6%95%88%E6%9E%9C"><span class="toc-number">1.16.7.</span> <span class="toc-text">实际应用效果</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C%E6%94%B9%E5%96%84"><span class="toc-number">1.16.7.1.</span> <span class="toc-text">用户体验改善</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87"><span class="toc-number">1.16.7.2.</span> <span class="toc-text">性能提升</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">1.16.8.</span> <span class="toc-text">配置参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.16.9.</span> <span class="toc-text">使用建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">1.16.9.1.</span> <span class="toc-text">开发环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83"><span class="toc-number">1.16.9.2.</span> <span class="toc-text">生产环境</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.16.10.</span> <span class="toc-text">注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BC%93%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.16.10.1.</span> <span class="toc-text">1. 缓存管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%80%A7%E8%83%BD%E5%B9%B3%E8%A1%A1"><span class="toc-number">1.16.10.2.</span> <span class="toc-text">2. 性能平衡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%A8%A1%E5%9D%97%E4%BE%9D%E8%B5%96"><span class="toc-number">1.16.10.3.</span> <span class="toc-text">3. 模块依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%98%88%E5%80%BC%E8%B0%83%E6%95%B4"><span class="toc-number">1.16.10.4.</span> <span class="toc-text">4. 阈值调整</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AA%E6%9D%A5%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91"><span class="toc-number">1.16.11.</span> <span class="toc-text">未来优化方向</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-LOD%E7%AE%A1%E7%90%86"><span class="toc-number">1.16.11.1.</span> <span class="toc-text">1. LOD管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%81%9A%E7%B1%BB%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.11.2.</span> <span class="toc-text">2. 聚类优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Web-Workers"><span class="toc-number">1.16.11.3.</span> <span class="toc-text">3. Web Workers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%99%9A%E6%8B%9F%E5%8C%96"><span class="toc-number">1.16.11.4.</span> <span class="toc-text">4. 虚拟化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.16.12.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-WebWorker-%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.12.1.</span> <span class="toc-text">2. WebWorker 优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%A7%86%E5%8F%A3%E4%BC%98%E5%8C%96"><span class="toc-number">1.16.12.2.</span> <span class="toc-text">3. 视口优化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9A-%E6%80%BB%E7%BB%93"><span class="toc-number">1.17.</span> <span class="toc-text">📚 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%9A-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93"><span class="toc-number">1.17.1.</span> <span class="toc-text">📚 最佳实践总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%8E%AF-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%8E%9F%E5%88%99"><span class="toc-number">1.17.1.1.</span> <span class="toc-text">🎯 性能优化原则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%93%8A-%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="toc-number">1.17.1.2.</span> <span class="toc-text">📊 性能监控指标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%94%A7-%E9%85%8D%E7%BD%AE%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.17.1.3.</span> <span class="toc-text">🔧 配置建议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%80-%E5%BC%80%E5%8F%91%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.17.1.4.</span> <span class="toc-text">🚀 开发建议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9A%A0%EF%B8%8F-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.17.1.5.</span> <span class="toc-text">⚠️ 注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%94%AE-%E6%9C%AA%E6%9D%A5%E5%8F%91%E5%B1%95%E6%96%B9%E5%90%91"><span class="toc-number">1.17.1.6.</span> <span class="toc-text">🔮 未来发展方向</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E8%BD%B4%E4%B8%8E%E5%8A%A8%E7%94%BB%EF%BC%88%E8%BF%9B%E9%98%B6%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">1.17.2.</span> <span class="toc-text">时间轴与动画（进阶示例）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%A0%E4%BD%95%E5%9B%BE%E5%85%83%EF%BC%88%E4%BD%8E%E7%BA%A7-Primitive%EF%BC%89%E5%AE%9E%E6%88%98"><span class="toc-number">1.18.</span> <span class="toc-text">几何图元（低级 Primitive）实战</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%8F%E5%B9%95%E7%A9%BA%E9%97%B4%E4%BA%8B%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.19.</span> <span class="toc-text">屏幕空间事件最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E8%A7%84%E6%A8%A1%E5%AE%9E%E4%BD%93%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5"><span class="toc-number">1.20.</span> <span class="toc-text">大规模实体管理策略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%90%8E%E5%A4%84%E7%90%86%EF%BC%88PostProcessStage%EF%BC%89"><span class="toc-number">1.21.</span> <span class="toc-text">🎨 自定义后处理（PostProcessStage）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8D%95%E4%B8%80%E5%90%8E%E5%A4%84%E7%90%86%E9%98%B6%E6%AE%B5%EF%BC%88Edge-Detect-%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">1.21.1.</span> <span class="toc-text">1) 单一后处理阶段（Edge Detect 示例）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BB%84%E5%90%88%E5%90%8E%E5%A4%84%E7%90%86%EF%BC%88Composite%EF%BC%9ABloom-%E8%87%AA%E5%AE%9A%E4%B9%89%EF%BC%89"><span class="toc-number">1.21.2.</span> <span class="toc-text">2) 组合后处理（Composite：Bloom + 自定义）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-Shader-%E4%B8%8E-czm-%E5%86%85%E7%BD%AE%E9%80%9F%E6%9F%A5%EF%BC%88%E7%B2%BE%E9%80%89%EF%BC%89"><span class="toc-number">1.22.</span> <span class="toc-text">🧪 Shader 与 czm 内置速查（精选）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9B%B0%EF%B8%8F-%E5%9C%B0%E5%BD%A2-%E9%98%B4%E5%BD%B1-%E9%80%8F%E6%98%8E%E5%BA%A6-%E6%8E%92%E5%BA%8F%E9%81%BF%E5%9D%91"><span class="toc-number">1.23.</span> <span class="toc-text">⛰️ 地形 &#x2F; 阴影 &#x2F; 透明度 排序避坑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%B0-%E6%9B%B4%E5%A4%9A%E5%AE%9E%E8%B7%B5%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.24.</span> <span class="toc-text">🧰 更多实践建议</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/31/babylonjs/" title="BabylonJS"><img src="/img/babylonjs.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BabylonJS"/></a><div class="content"><a class="title" href="/2025/07/31/babylonjs/" title="BabylonJS">BabylonJS</a><time datetime="2025-07-30T16:00:00.000Z" title="发表于 2025-07-31 00:00:00">2025-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/31/cesium/" title="Cesium 开发文档"><img src="/img/cesium.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cesium 开发文档"/></a><div class="content"><a class="title" href="/2025/07/31/cesium/" title="Cesium 开发文档">Cesium 开发文档</a><time datetime="2025-07-30T16:00:00.000Z" title="发表于 2025-07-31 00:00:00">2025-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/31/mars3d/" title="mars3D 开发文档"><img src="/img/mars3d.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mars3D 开发文档"/></a><div class="content"><a class="title" href="/2025/07/31/mars3d/" title="mars3D 开发文档">mars3D 开发文档</a><time datetime="2025-07-30T16:00:00.000Z" title="发表于 2025-07-31 00:00:00">2025-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/25/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" title="Go语言学习总结"><img src="/img/go.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go语言学习总结"/></a><div class="content"><a class="title" href="/2025/04/25/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" title="Go语言学习总结">Go语言学习总结</a><time datetime="2025-04-24T16:00:00.000Z" title="发表于 2025-04-25 00:00:00">2025-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/15/deno%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="Deno学习记录"><img src="/img/deno.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Deno学习记录"/></a><div class="content"><a class="title" href="/2025/04/15/deno%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="Deno学习记录">Deno学习记录</a><time datetime="2025-04-14T16:00:00.000Z" title="发表于 2025-04-15 00:00:00">2025-04-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By aoaYaoa</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.4</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoogo.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoogo.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><div class="aplayer no-destroy" data-id="13528716738" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true 
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>